
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>PHP Composer—— 初始化源码分析-Laravel 源码详解</title>
<meta content='PHP Composer—— 初始化源码分析,Laravel 源码详解' name='keywords'>
<meta content='PHP Composer—— 初始化源码分析,Laravel 源码详解' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../static/components/css/base.css">
<link rel="stylesheet" href="../../static/components/css/reader.css">
<link rel="stylesheet" href="../../static/components/css/markdown.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../book/107/PHP%20Composer——自动加载原理.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">PHP Compose..</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../book/107/PHP%20Composer-——-注册与运行源码分析.html">
<span class="">PHP Compose..</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../book/107/index.html">Laravel 源码详解</a>
<a target="_blank" rel="nofollow" href="https://github.com/tzivanmoe/laravel-source-analysis" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  md-content-section  uk-margin-bottom">
<h2 id="前言">前言</h2>
<p><a href="http://leoyang90.cn/2017/03/11/PHP-Composer-autoload/">上一篇文章</a>中，我们讨论了 <code>PHP自动加载功能</code> 、<code>PHP命名空间</code>、<code>PSR0/PSR4标准</code>，有了这些知识，其实我们就可以按照 PSR4标准 写出可以自动加载的程序了。然而我们为什么要自己写呢？尤其是有 <code>Composer</code> 这神一样的包管理器的情况下？</p>
<h1 id="composer自动加载概论">Composer自动加载概论</h1>
<h2 id="简介">简介</h2>
<p><code>Composer</code> 是 PHP 的一个依赖管理工具。它允许你申明项目所依赖的代码库，它会在你的项目中为你安装他们。详细内容可以查看<a href="http://docs.phpcomposer.com/00-intro.html">Composer 中文网</a>。</p>
<h4 id="composer-composer-将这样为你解决问题">Composer Composer 将这样为你解决问题：</h4>
<blockquote>
<ul>
<li>你有一个项目依赖于若干个库。</li>
<li>其中一些库依赖于其他库。</li>
<li>你声明你所依赖的东西。</li>
<li>Composer 会找出哪个版本的包需要安装，并安装它们（将它们下载到你的项目中）。</li>
</ul>
</blockquote>
<p>例如，你正在创建一个项目，你需要一个库来做日志记录。你决定使用 <code>monolog</code> 。为了将它添加到你的项目中，你所需要做的就是创建一个 <code>composer.json</code> 文件，其中描述了项目的依赖关系。</p>
<pre><code class="language-php"> {
   "require": {
     "monolog/monolog": "1.2.*"
   }
 }
</code></pre>
<p>然后我们只要在项目里面直接<code>use Monolog\Logger</code>即可，神奇吧！</p>
<p>简单的说，Composer 帮助我们下载好了符合 <code>PSR0/PSR4标准</code> 的第三方库，并把文件放在相应位置；帮我们写了 <code>__autoload()</code> 函数，注册到了 <code>spl_register()</code> 函数，当我们想用第三方库的时候直接使用命名空间即可。</p>
<p>那么当我们想要写自己的命名空间的时候，该怎么办呢？很简单，我们只要按照 PSR4标准 命名我们的命名空间，放置我们的文件，然后在 composer 里面写好顶级域名与具体目录的映射，就可以享用 composer 的便利了。</p>
<p>当然如果有一个非常棒的框架，我们会惊喜地发现，在 composer 里面写顶级域名映射这事我们也不用做了，框架已经帮我们写好了顶级域名映射了，我们只需要在框架里面新建文件，在新建的文件中写好命名空间，就可以在任何地方 use 我们的命名空间了。</p>
<p>下面我们就以 Laravel 框架为例，讲一讲 composer 是如何实现 <code>PSR0/PSR4标准</code> 的自动加载功能。</p>
<h2 id="composer自动加载文件">Composer自动加载文件</h2>
<p>  首先，我们先大致了解一下Composer自动加载所用到的源文件。</p>
<blockquote>
<ol>
<li>autoload_real.php: 自动加载功能的引导类。
<ul>
<li>任务是composer加载类的初始化<code>(顶级命名空间与文件路径映射初始化)</code>和注册(spl_autoload_register())。</li>
</ul> </li>
<li>ClassLoader.php: composer加载类。
<ul>
<li>composer自动加载功能的核心类。</li>
</ul> </li>
<li>autoload_static.php: 顶级命名空间初始化类，
<ul>
<li>用于给核心类初始化顶级命名空间。</li>
</ul> </li>
<li>autoload_classmap.php: 自动加载的最简单形式，
<ul>
<li>有完整的命名空间和文件目录的映射；</li>
</ul> </li>
<li>autoload_files.php: 用于加载全局函数的文件，
<ul>
<li>存放各个全局函数所在的文件路径名；</li>
</ul> </li>
<li>autoload_namespaces.php: 符合PSR0标准的自动加载文件，
<ul>
<li>存放着顶级命名空间与文件的映射；</li>
</ul> </li>
<li>autoload_psr4.php: 符合PSR4标准的自动加载文件，
<ul>
<li>存放着顶级命名空间与文件的映射；</li>
</ul> </li>
</ol>
</blockquote>
<h1 id="laravel框架下composer的自动加载源码分析启动">laravel框架下Composer的自动加载源码分析——启动</h1>
<hr>
<p>   laravel框架的初始化是需要composer自动加载协助的，所以laravel的入口文件index.php第一句就是利用composer来实现自动加载功能。</p>
<pre><code class="language-php">&lt;?php
   require __DIR__.'/../bootstrap/autoload.php';
</code></pre>
<p>咱们接着去看 bootstrap 目录下的 <code>autoload.php</code> ：</p>
<pre><code class="language-php">&lt;?php
  define('LARAVEL_START', microtime(true));

  require __DIR__ . '/../vendor/autoload.php';
</code></pre>
<p>再去 vendor 目录下的 <code>autoload.php</code> ：</p>
<pre><code class="language-php">&lt;?php
  require_once __DIR__ . '/composer' . '/autoload_real.php';

  return ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e::getLoader();
</code></pre>
<p>为什么框架要在 <code>bootstrap/autoload.php</code> 转一下？个人理解，laravel 这样设计有利于支持或扩展<strong>任意</strong>有自动加载的第三方库。</p>
<p>好了，我们终于要看到了Composer真正要显威的地方了。<code>autoload_real.php</code>里面就是一个自动加载功能的引导类，这个类不负责具体功能逻辑，只做了两件事：初始化自动加载类、注册自动加载类。</p>
<p>到autoload_real这个文件里面去看，发现这个引导类的名字叫ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e，为什么要叫这么古怪的名字呢？因为这是防止用户自定义类名跟这个类重复冲突了，所以在类名上加了一个hash值。其实还有一个做法我们更加熟悉，那就是不直接定义类名，而是定义一个命名空间。这里为什么不定义一个命名空间呢？个人理解：命名空间一般都是为了复用，而这个类只需要运行一次即可，以后也不会用得到，用hash值更加合适。</p>
<h1 id="laravel框架下composer的自动加载源码分析autoload-real引导类">laravel框架下Composer的自动加载源码分析——autoload_real引导类</h1>
<hr>
<p>在 vendor 目录下的 <code>autoload.php</code> 文件中我们可以看出，程序主要调用了引导类的静态方法 <code>getLoader()</code> ，我们接着看看这个函数。</p>
<pre><code class="language-php">&lt;?php
	public static function getLoader()
	{
	  /***************************经典单例模式********************/
	  if (null !== self::$loader) {
	      return self::$loader;
	  }

	  /***********************获得自动加载核心类对象********************/
	  spl_autoload_register(
        array('ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e', 'loadClassLoader'), true, true
      );

	  self::$loader = $loader = new \Composer\Autoload\ClassLoader();

	  spl_autoload_unregister(
        array('ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e', 'loadClassLoader')
      );

	  /***********************初始化自动加载核心类对象********************/
	  $useStaticLoader = PHP_VERSION_ID &gt;= 50600 &amp;&amp; !defined('HHVM_VERSION');

	  if ($useStaticLoader) {
	      require_once __DIR__ . '/autoload_static.php';

	      call_user_func(
          \Composer\Autoload\ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::getInitializer($loader)
          );

	  } else {
	      $map = require __DIR__ . '/autoload_namespaces.php';
	      foreach ($map as $namespace =&gt; $path) {
	          $loader-&gt;set($namespace, $path);
	      }

	      $map = require __DIR__ . '/autoload_psr4.php';
	      foreach ($map as $namespace =&gt; $path) {
	          $loader-&gt;setPsr4($namespace, $path);
	      }

	      $classMap = require __DIR__ . '/autoload_classmap.php';
	      if ($classMap) {
	          $loader-&gt;addClassMap($classMap);
	      }
	  }

	  /***********************注册自动加载核心类对象********************/
	  $loader-&gt;register(true);

	  /***********************自动加载全局函数********************/
	  if ($useStaticLoader) {
	      $includeFiles = Composer\Autoload\ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::$files;
	  } else {
	      $includeFiles = require __DIR__ . '/autoload_files.php';
	  }

	  foreach ($includeFiles as $fileIdentifier =&gt; $file) {
	      composerRequire832ea71bfb9a4128da8660baedaac82e($fileIdentifier, $file);
	  }

	  return $loader;
	}
</code></pre>
<p>  从上面可以看出，我把自动加载引导类分为5个部分。</p>
<h2 id="第一部分单例">第一部分——单例</h2>
<p>第一部分很简单，就是个最经典的单例模式，自动加载类只能有一个。</p>
<pre><code class="language-php">&lt;?php
  if (null !== self::$loader) {
      return self::$loader;
  }
</code></pre>
<h2 id="第二部分构造classloader核心类">第二部分——构造ClassLoader核心类</h2>
<p>第二部分 new 一个自动加载的核心类对象。</p>
<pre><code class="language-php">&lt;?php
  /***********************获得自动加载核心类对象********************/
  spl_autoload_register(
    array('ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e', 'loadClassLoader'), true, true
  );

  self::$loader = $loader = new \Composer\Autoload\ClassLoader();

  spl_autoload_unregister(
    array('ComposerAutoloaderInit832ea71bfb9a4128da8660baedaac82e', 'loadClassLoader')
  );
</code></pre>
<p><code>loadClassLoader()</code>函数：</p>
<pre><code class="language-php">&lt;?php
public static function loadClassLoader($class)
{
    if ('Composer\Autoload\ClassLoader' === $class) {
        require __DIR__ . '/ClassLoader.php';
    }
}
</code></pre>
<p>从程序里面我们可以看出，composer 先向 PHP 自动加载机制注册了一个函数，这个函数 require 了 ClassLoader 文件。成功 new 出该文件中核心类 ClassLoader() 后，又销毁了该函数。</p>
<p>为什么不直接require，而要这么麻烦？原因就是怕有的用户也定义了个 <code>\Composer\Autoload\ClassLoader</code> 命名空间，导致自动加载错误文件。那为什么不跟引导类一样用个 hash 呢？因为这个类是可以复用的，框架允许用户使用这个类。</p>
<h2 id="第三部分--初始化核心类对象">第三部分 —— 初始化核心类对象</h2>
<pre><code class="language-php">&lt;?php
  /***********************初始化自动加载核心类对象********************/
  $useStaticLoader = PHP_VERSION_ID &gt;= 50600 &amp;&amp; !defined('HHVM_VERSION');
  if ($useStaticLoader) {
     require_once __DIR__ . '/autoload_static.php';

     call_user_func(
       \Composer\Autoload\ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::getInitializer($loader)
     );
  } else {
      $map = require __DIR__ . '/autoload_namespaces.php';
      foreach ($map as $namespace =&gt; $path) {
         $loader-&gt;set($namespace, $path);
      }

      $map = require __DIR__ . '/autoload_psr4.php';
      foreach ($map as $namespace =&gt; $path) {
         $loader-&gt;setPsr4($namespace, $path);
      }

      $classMap = require __DIR__ . '/autoload_classmap.php';
      if ($classMap) {
          $loader-&gt;addClassMap($classMap);
      }
    }
</code></pre>
<p>这一部分就是对自动加载类的初始化，主要是给自动加载核心类初始化顶级命名空间映射。</p>
<p>初始化的方法有两种： 1. 使用autoload_static进行静态初始化； 2. 调用核心类接口初始化。</p>
<h3 id="autoload-static静态初始化">autoload_static静态初始化</h3>
<p>静态初始化只支持 PHP5.6 以上版本并且不支持 HHVM 虚拟机。我们深入 <code>autoload_static.php</code> 这个文件发现这个文件定义了一个用于静态初始化的类，名字叫 <code>ComposerStaticInit832ea71bfb9a4128da8660baedaac82e</code>，仍然为了避免冲突加了 hash 值。这个类很简单：</p>
<pre><code class="language-php">&lt;?php
  class ComposerStaticInit832ea71bfb9a4128da8660baedaac82e{
     public static $files = array(...);
     public static $prefixLengthsPsr4 = array(...);
     public static $prefixDirsPsr4 = array(...);
     public static $prefixesPsr0 = array(...);
     public static $classMap = array (...);

    public static function getInitializer(ClassLoader $loader)
    {
      return \Closure::bind(function () use ($loader) {
          $loader-&gt;prefixLengthsPsr4
  						= ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::$prefixLengthsPsr4;

          $loader-&gt;prefixDirsPsr4
  						= ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::$prefixDirsPsr4;

          $loader-&gt;prefixesPsr0
  						= ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::$prefixesPsr0;

          $loader-&gt;classMap
  						= ComposerStaticInit832ea71bfb9a4128da8660baedaac82e::$classMap;

      }, null, ClassLoader::class);
  }
</code></pre>
<p>这个静态初始化类的核心就是 <code>getInitializer()</code> 函数，它将自己类中的顶级命名空间映射给了 ClassLoader类。值得注意的是这个函数返回的是一个匿名函数，为什么呢？原因就是 <code>ClassLoader类</code> 中的 <code>prefixLengthsPsr4</code> 、<code>prefixDirsPsr4</code>等等方法都是private的。。。普通的函数没办法给类的 <code>private</code> 成员变量赋值。利用匿名函数的绑定功能就可以将把匿名函数转为 ClassLoader类 的成员函数。</p>
<p>关于匿名函数的<a href="http://www.cnblogs.com/yjf512/p/4421289.html">绑定功能</a>。</p>
<p>接下来就是顶级命名空间初始化的关键了。</p>
<h4 id="最简单的-classmap">最简单的 classMap:</h4>
<pre><code class="language-php">&lt;?php
  public static $classMap = array (
  	'App\\Console\\Kernel'
  			=&gt; __DIR__ . '/../..' . '/app/Console/Kernel.php',

  	'App\\Exceptions\\Handler'
  			=&gt; __DIR__ . '/../..' . '/app/Exceptions/Handler.php',

  	'App\\Http\\Controllers\\Auth\\ForgotPasswordController'
  			=&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/ForgotPasswordController.php',

  	'App\\Http\\Controllers\\Auth\\LoginController'
  			=&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/LoginController.php',

  	'App\\Http\\Controllers\\Auth\\RegisterController'
  			=&gt; __DIR__ . '/../..' . '/app/Http/Controllers/Auth/RegisterController.php',
  ...)
</code></pre>
<p>简单吧，直接命名空间全名与目录的映射，没有顶级命名空间。。。简单粗暴，也导致这个数组相当的大。</p>
<h4 id="psr0-顶级命名空间映射">PSR0 顶级命名空间映射：</h4>
<pre><code class="language-php">&lt;?php
  public static $prefixesPsr0 = array (
    'P' =&gt; array (
        'Prophecy\\' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/phpspec/prophecy/src',
        ),

        'Parsedown' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/erusev/parsedown',
        ),
    ),
    'M' =&gt; array (
        'Mockery' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/mockery/mockery/library',
        ),
    ),
    'J' =&gt; array (
        'JakubOnderka\\PhpConsoleHighlighter' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/jakub-onderka/php-console-highlighter/src',
        ),
        'JakubOnderka\\PhpConsoleColor' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/jakub-onderka/php-console-color/src',
        ),
    ),
    'D' =&gt; array (
        'Doctrine\\Common\\Inflector\\' =&gt; array (
            0 =&gt; __DIR__ . '/..' . '/doctrine/inflector/lib',
        ),
    ),
  );
</code></pre>
<p>为了快速找到顶级命名空间，我们这里使用命名空间第一个字母作为前缀索引。这个映射的用法比较明显，假如我们有Parsedown/example这样的命名空间，首先通过首字母P，找到</p>
<pre><code class="language-php">&lt;?php
  'P' =&gt; array (
      'Prophecy\\' =&gt; array (
		0 =&gt; __DIR__ . '/..' . '/phpspec/prophecy/src',
      ),

      'Parsedown' =&gt; array (
		0 =&gt; __DIR__ . '/..' . '/erusev/parsedown',
      ),
  ),
</code></pre>
<p>这个数组，然后我们就会遍历这个数组来和 <code>Parsedown/example</code> 比较，发现第一个 Prophecy 不符合，第二个 Parsedown 符合，然后得到了映射目录：<strong>(映射目录可能不止一个)</strong></p>
<pre><code class="language-php">&lt;?php
	array (0 =&gt; __DIR__ . '/..' . '/erusev/parsedown',)
</code></pre>
<p>我们会接着遍历这个数组，尝试 <code>__DIR__ . '/..' . '/erusev/parsedown/Parsedown/example.php'</code> 是否存在，如果不存在接着遍历数组(这个例子数组只有一个元素)，如果数组遍历完都没有，就会加载失败。</p>
<h4 id="psr4标准顶级命名空间映射数组">PSR4标准顶级命名空间映射数组：</h4>
<pre><code class="language-php">&lt;?php
  public static $prefixLengthsPsr4 = array(
  	'p' =&gt; array (
		'phpDocumentor\\Reflection\\' =&gt; 25,
	),
  	'S' =&gt; array (
		'Symfony\\Polyfill\\Mbstring\\' =&gt; 26,
		'Symfony\\Component\\Yaml\\' =&gt; 23,
		'Symfony\\Component\\VarDumper\\' =&gt; 28,
		...
	),
  ...);

  public static $prefixDirsPsr4 = array (
  	'phpDocumentor\\Reflection\\' =&gt; array (
		0 =&gt; __DIR__ . '/..' . '/phpdocumentor/reflection-common/src',
		1 =&gt; __DIR__ . '/..' . '/phpdocumentor/type-resolver/src',
		2 =&gt; __DIR__ . '/..' . '/phpdocumentor/reflection-docblock/src',
	),
  	 'Symfony\\Polyfill\\Mbstring\\' =&gt; array (
		0 =&gt; __DIR__ . '/..' . '/symfony/polyfill-mbstring',
	),
  	'Symfony\\Component\\Yaml\\' =&gt; array (
		0 =&gt; __DIR__ . '/..' . '/symfony/yaml',
	),
  ...)
</code></pre>
<p>PSR4标准顶级命名空间映射用了两个数组，第一个和 PSR0 一样用命名空间第一个字母作为前缀索引，然后是 顶级命名空间，但是最终并不是文件路径，而是 顶级命名空间 的长度。为什么呢？因为前一篇<a href="http://leoyang90.cn/2017/03/11/PHP-Composer-autoload/">文章</a>我们说过，PSR4标准 的文件目录更加灵活，更加简洁。</p>
<p>PSR0 中顶级命名空间目录直接加到命名空间前面就可以得到路径</p>
<pre><code>Parsedown/example =&gt; __DIR__ . '/..' . '/erusev/parsedown/Parsedown/example.php
                                                           ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
</code></pre>
<p>而 PSR4标准 却是用顶级命名空间目录替换顶级命名空间，所以获得顶级命名空间的长度很重要。</p>
<pre><code>Parsedown/example =&gt; __DIR__ . '/..' . '/erusev/parsedown/example.php
                                                ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
</code></pre>
<p>具体的用法：假如我们找 <code>Symfony\\Polyfill\\Mbstring\\example</code> 这个命名空间，和 PSR0 一样通过前缀索引和字符串匹配我们得到了</p>
<pre><code class="language-php">&lt;?php
	'Symfony\\Polyfill\\Mbstring\\' =&gt; 26,
</code></pre>
<p>这条记录，键是顶级命名空间，值是命名空间的长度。拿到顶级命名空间后去 <code>$prefixDirsPsr4数组</code> 获取它的映射目录数组：<strong>(注意映射目录可能不止一条)</strong></p>
<pre><code class="language-php">&lt;?php
  'Symfony\\Polyfill\\Mbstring\\' =&gt; array (
  	        0 =&gt; __DIR__ . '/..' . '/symfony/polyfill-mbstring',
  	    )
</code></pre>
<p>然后我们就可以将命名空间 <code>Symfony\\Polyfill\\Mbstring\\example</code> 前26个字符替换成目录 <code>__DIR__ . '/..' . '/symfony/polyfill-mbstring</code> ，我们就得到了<code>__DIR__ . '/..' . '/symfony/polyfill-mbstring/example.php</code>，先验证磁盘上这个文件是否存在，如果不存在接着遍历。如果遍历后没有找到，则加载失败。</p>
<p><strong>自动加载核心类ClassLoader的静态初始化完成！！！</strong></p>
<h3 id="classloader接口初始化">ClassLoader接口初始化</h3>
<hr>
<p>如果PHP版本低于5.6或者使用 HHVM 虚拟机环境，那么就要使用核心类的接口进行初始化。</p>
<pre><code class="language-php">&lt;?php
	//PSR0标准
	$map = require __DIR__ . '/autoload_namespaces.php';
	foreach ($map as $namespace =&gt; $path) {
	   $loader-&gt;set($namespace, $path);
	}

	//PSR4标准
	$map = require __DIR__ . '/autoload_psr4.php';
	foreach ($map as $namespace =&gt; $path) {
	   $loader-&gt;setPsr4($namespace, $path);
	}

	$classMap = require __DIR__ . '/autoload_classmap.php';
	if ($classMap) {
	   $loader-&gt;addClassMap($classMap);
	}
</code></pre>
<h4 id="psr0标准"><strong>PSR0标准</strong></h4>
<p>autoload_namespaces：</p>
<pre><code class="language-php">&lt;?php
	return array(
		'Prophecy\\'
			=&gt; array($vendorDir . '/phpspec/prophecy/src'),

		'Parsedown'
			=&gt; array($vendorDir . '/erusev/parsedown'),

		'Mockery'
			=&gt; array($vendorDir . '/mockery/mockery/library'),

		'JakubOnderka\\PhpConsoleHighlighter'
			=&gt; array($vendorDir . '/jakub-onderka/php-console-highlighter/src'),

		'JakubOnderka\\PhpConsoleColor'
			=&gt; array($vendorDir . '/jakub-onderka/php-console-color/src'),

		'Doctrine\\Common\\Inflector\\'
			=&gt; array($vendorDir . '/doctrine/inflector/lib'),
	);
</code></pre>
<p>PSR0标准的初始化接口：</p>
<pre><code class="language-php">&lt;?php
	public function set($prefix, $paths)
	{
	    if (!$prefix) {
	        $this-&gt;fallbackDirsPsr0 = (array) $paths;
	    } else {
	        $this-&gt;prefixesPsr0[$prefix[0]][$prefix] = (array) $paths;
	    }
	}
</code></pre>
<p>很简单，PSR0标准取出命名空间的第一个字母作为索引，一个索引对应多个顶级命名空间，一个顶级命名空间对应多个目录路径，具体形式可以查看上面我们讲的 autoload_static 的 $prefixesPsr0 。如果没有顶级命名空间，就只存储一个路径名，以便在后面尝试加载。</p>
<h4 id="psr4标准">PSR4标准</h4>
<p>autoload_psr4</p>
<pre><code class="language-php">&lt;?php
    return array(
    'XdgBaseDir\\'
		=&gt; array($vendorDir . '/dnoegel/php-xdg-base-dir/src'),

    'Webmozart\\Assert\\'
		=&gt; array($vendorDir . '/webmozart/assert/src'),

    'TijsVerkoyen\\CssToInlineStyles\\'
		=&gt; array($vendorDir . '/tijsverkoyen/css-to-inline-styles/src'),

    'Tests\\'
		=&gt; array($baseDir . '/tests'),

    'Symfony\\Polyfill\\Mbstring\\'
		=&gt; array($vendorDir . '/symfony/polyfill-mbstring'),
    ...
    )
</code></pre>
<p>PSR4标准的初始化接口:</p>
<pre><code class="language-php">&lt;?php
	public function setPsr4($prefix, $paths)
	{
	    if (!$prefix) {
	        $this-&gt;fallbackDirsPsr4 = (array) $paths;
	    } else {
	        $length = strlen($prefix);
	        if ('\\' !== $prefix[$length - 1]) {
	            throw new \InvalidArgumentException(
                  "A non-empty PSR-4 prefix must end with a namespace separator."
                );
	        }
	        $this-&gt;prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
	        $this-&gt;prefixDirsPsr4[$prefix] = (array) $paths;
	    }
	}
</code></pre>
<p>PSR4初始化接口也很简单。如果没有顶级命名空间，就直接保存目录。如果有命名空间的话，要保证顶级命名空间最后是 <code>\</code> ，然后分别保存</p>
<pre><code>( 前缀 -&gt; 顶级命名空间，顶级命名空间 -&gt; 顶级命名空间长度 )
( 顶级命名空间 -&gt; 目录 )
</code></pre>
<p>这两个映射数组。具体形式可以查看上面我们讲的 <code>autoload_static</code> 的 prefixLengthsPsr4 、 $prefixDirsPsr4 。</p>
<h4 id="傻瓜式命名空间映射">傻瓜式命名空间映射</h4>
<p>autoload_classmap：</p>
<pre><code class="language-php">&lt;?php
public static $classMap = array (
    'App\\Console\\Kernel'
		=&gt; __DIR__ . '/../..' . '/app/Console/Kernel.php',

    'App\\Exceptions\\Handler'
		=&gt; __DIR__ . '/../..' . '/app/Exceptions/Handler.php',
    ...
)
</code></pre>
<p>addClassMap:</p>
<pre><code class="language-php">&lt;?php
	public function addClassMap(array $classMap)
	{
	    if ($this-&gt;classMap) {
	        $this-&gt;classMap = array_merge($this-&gt;classMap, $classMap);
	    } else {
	        $this-&gt;classMap = $classMap;
	    }
	}
</code></pre>
<p>这个最简单，就是整个命名空间与目录之间的映射。</p>
<h1 id="结语">结语</h1>
<p>其实我很想接着写下下去，但是这样会造成篇幅过长，所以我就把自动加载的注册和运行放到下一篇文章了。我们回顾一下，这篇文章主要讲了：</p>
<pre><code>1.框架如何启动composer自动加载;
2.composer自动加载分为5部分；
</code></pre>
<p>其实说是5部分，真正重要的就两部分——初始化与注册。初始化负责顶层命名空间的目录映射，注册负责实现顶层以下的命名空间映射规则。</p>
<p>Written with <a href="https://stackedit.io/">StackEdit</a>.</p>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/80/index.html">
<img class="uk-book-cover" src="../../static/icons/48/java_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/80/index.html">Java后端开发相关学习笔记</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/51.html">Kuangcp</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="java">java</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="linux">linux</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">172页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月24日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 23个">23</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/189/index.html">
<img class="uk-book-cover" src="../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/189/index.html">每日 30 秒 , 一段代码 ,一个场景</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/106.html">pushmetop</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">46页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 265个">265</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/53/index.html">
<img class="uk-book-cover" src="../../static/icons/48/javascript_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/53/index.html">前端开发者指南 2018</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/30.html">稀土</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="css3">css3</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="html5">html5</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="javascript">javascript</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">103页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 282个">282</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/35/index.html">
<img class="uk-book-cover" src="../../static/icons/48/django_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/35/index.html">Django 1.8 中文文档</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/15.html">wizardforcel</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="django">django</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">172页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 16个">16</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/159/index.html">
<img class="uk-book-cover" src="../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/159/index.html">im-service 简介</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/91.html">yu000hong</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">37页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/153/index.html">
<img class="uk-book-cover" src="../../static/icons/48/javascript_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/153/index.html">你不懂JS：ES6与未来</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/85.html">getify</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="javascript">javascript</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">13页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年3月24日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 98514个">98514</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../" title="返回首页"><img class="" src="../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../book/107/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../book/107/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../book/107/README.html" title="Introduction" data-book-page-rel-url="README.html" data-book-page-id="7730">Introduction</a>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="PHP Composer 自动加载" disabled data-book-page-rel-url="" data-book-page-id="7731">PHP Composer 自动加载</a>
<ul>
<li>
<a class="pjax" href="../../book/107/PHP%20Composer——自动加载原理.html" title="PHP Composer——自动加载原理" data-book-page-rel-url="PHP%20Composer——自动加载原理.html" data-book-page-id="7732">PHP Composer——自动加载原理</a>
</li>
<li>
<a class="pjax" href="../../book/107/PHP%20Composer——%20初始化源码分析.html" title="PHP Composer—— 初始化源码分析" data-book-page-rel-url="PHP%20Composer——%20初始化源码分析.html" data-book-page-id="7733">PHP Composer—— 初始化源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/PHP%20Composer-——-注册与运行源码分析.html" title="PHP Composer-——-注册与运行源码分析" data-book-page-rel-url="PHP%20Composer-——-注册与运行源码分析.html" data-book-page-id="7734">PHP Composer-——-注册与运行源码分析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Facade 门面" disabled data-book-page-rel-url="" data-book-page-id="7735">Laravel Facade 门面</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Facade——Facade%20门面源码分析.html" title="Laravel Facade——Facade 门面源码分析" data-book-page-rel-url="Laravel%20Facade——Facade%20门面源码分析.html" data-book-page-id="7736">Laravel Facade——Facade 门面源码分析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Ioc 容器" disabled data-book-page-rel-url="" data-book-page-id="7737">Laravel Ioc 容器</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Container——IoC%20服务容器.html" title="Laravel Container——IoC 服务容器" data-book-page-rel-url="Laravel%20Container——IoC%20服务容器.html" data-book-page-id="7738">Laravel Container——IoC 服务容器</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Container——IoC%20服务容器源码解析%28服务器绑定%29.html" title="Laravel Container——IoC 服务容器源码解析(服务器绑定)" data-book-page-rel-url="Laravel%20Container——IoC%20服务容器源码解析%28服务器绑定%29.html" data-book-page-id="7739">Laravel Container——IoC 服务容器源码解析(服务器绑定)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Container——IoC%20服务容器源码解析%28服务器解析%29.html" title="Laravel Container——IoC 服务容器源码解析(服务器解析)" data-book-page-rel-url="Laravel%20Container——IoC%20服务容器源码解析%28服务器解析%29.html" data-book-page-id="7740">Laravel Container——IoC 服务容器源码解析(服务器解析)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Container——服务容器的细节特性.html" title="Laravel Container——服务容器的细节特性" data-book-page-rel-url="Laravel%20Container——服务容器的细节特性.html" data-book-page-id="7741">Laravel Container——服务容器的细节特性</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Route 路由" disabled data-book-page-rel-url="" data-book-page-id="7742">Laravel Route 路由</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——路由.html" title="Laravel HTTP——路由" data-book-page-rel-url="Laravel%20HTTP——路由.html" data-book-page-id="7743">Laravel HTTP——路由</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——路由加载源码分析.html" title="Laravel HTTP——路由加载源码分析" data-book-page-rel-url="Laravel%20HTTP——路由加载源码分析.html" data-book-page-id="7744">Laravel HTTP——路由加载源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——Pipeline中间件处理源码分析.html" title="Laravel HTTP——Pipeline中间件处理源码分析" data-book-page-rel-url="Laravel%20HTTP——Pipeline中间件处理源码分析.html" data-book-page-id="7745">Laravel HTTP——Pipeline中间件处理源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——路由的正则编译.html" title="Laravel HTTP——路由的正则编译" data-book-page-rel-url="Laravel%20HTTP——路由的正则编译.html" data-book-page-id="7746">Laravel HTTP——路由的正则编译</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——路由的匹配与参数绑定.html" title="Laravel HTTP——路由的匹配与参数绑定" data-book-page-rel-url="Laravel%20HTTP——路由的匹配与参数绑定.html" data-book-page-id="7747">Laravel HTTP——路由的匹配与参数绑定</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——路由中间件源码分析.html" title="Laravel HTTP——路由中间件源码分析" data-book-page-rel-url="Laravel%20HTTP——路由中间件源码分析.html" data-book-page-id="7748">Laravel HTTP——路由中间件源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——SubstituteBindings%20参数绑定中间件的使用与源码解析.html" title="Laravel HTTP——SubstituteBindings 参数绑定中间件的使用与源码解析" data-book-page-rel-url="Laravel%20HTTP——SubstituteBindings%20参数绑定中间件的使用与源码解析.html" data-book-page-id="7749">Laravel HTTP——SubstituteBindings 参数绑定中间件的使用与源码解析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——控制器方法的参数构建与运行.html" title="Laravel HTTP——控制器方法的参数构建与运行" data-book-page-rel-url="Laravel%20HTTP——控制器方法的参数构建与运行.html" data-book-page-id="7750">Laravel HTTP——控制器方法的参数构建与运行</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——%20RESTFul%20风格路由的使用与源码分析.html" title="Laravel HTTP—— RESTFul 风格路由的使用与源码分析" data-book-page-rel-url="Laravel%20HTTP——%20RESTFul%20风格路由的使用与源码分析.html" data-book-page-id="7751">Laravel HTTP—— RESTFul 风格路由的使用与源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20HTTP——重定向的使用与源码分析.html" title="Laravel HTTP——重定向的使用与源码分析" data-book-page-rel-url="Laravel%20HTTP——重定向的使用与源码分析.html" data-book-page-id="7752">Laravel HTTP——重定向的使用与源码分析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel ENV 环境变量" disabled data-book-page-rel-url="" data-book-page-id="7753">Laravel ENV 环境变量</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20ENV——%20环境变量的加载与源码解析.html" title="Laravel ENV—— 环境变量的加载与源码解析" data-book-page-rel-url="Laravel%20ENV——%20环境变量的加载与源码解析.html" data-book-page-id="7754">Laravel ENV—— 环境变量的加载与源码解析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Config 配置文件" disabled data-book-page-rel-url="" data-book-page-id="7755">Laravel Config 配置文件</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Config——%20配置文件的加载与源码解析.html" title="Laravel Config—— 配置文件的加载与源码解析" data-book-page-rel-url="Laravel%20Config——%20配置文件的加载与源码解析.html" data-book-page-id="7756">Laravel Config—— 配置文件的加载与源码解析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Exceptions 异常处理" disabled data-book-page-rel-url="" data-book-page-id="7757">Laravel Exceptions 异常处理</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Exceptions——异常与错误处理.html" title="Laravel Exceptions——异常与错误处理.html" data-book-page-rel-url="Laravel%20Exceptions——异常与错误处理.html" data-book-page-id="7758">Laravel Exceptions——异常与错误处理.html</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Providers 服务提供者" disabled data-book-page-rel-url="" data-book-page-id="7759">Laravel Providers 服务提供者</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Providers——服务提供者的注册与启动源码解析.html" title="Laravel Providers——服务提供者的注册与启动源码解析" data-book-page-rel-url="Laravel%20Providers——服务提供者的注册与启动源码解析.html" data-book-page-id="7760">Laravel Providers——服务提供者的注册与启动源码解析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Database 数据库" disabled data-book-page-rel-url="" data-book-page-id="7761">Laravel Database 数据库</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——数据库服务的启动与连接.html" title="Laravel Database——数据库服务的启动与连接" data-book-page-rel-url="Laravel%20Database——数据库服务的启动与连接.html" data-book-page-id="7762">Laravel Database——数据库服务的启动与连接</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——数据库的%20CRUD%20操作.html" title="Laravel Database——数据库的 CRUD 操作" data-book-page-rel-url="Laravel%20Database——数据库的%20CRUD%20操作.html" data-book-page-id="7763">Laravel Database——数据库的 CRUD 操作</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——查询构造器与语法编译器源码分析%28上%29.html" title="Laravel Database——查询构造器与语法编译器源码分析(上)" data-book-page-rel-url="Laravel%20Database——查询构造器与语法编译器源码分析%28上%29.html" data-book-page-id="7764">Laravel Database——查询构造器与语法编译器源码分析(上)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——查询构造器与语法编译器源码分析%28中%29.html" title="Laravel Database——查询构造器与语法编译器源码分析(中)" data-book-page-rel-url="Laravel%20Database——查询构造器与语法编译器源码分析%28中%29.html" data-book-page-id="7765">Laravel Database——查询构造器与语法编译器源码分析(中)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——查询构造器与语法编译器源码分析%28下%29.html" title="Laravel Database——查询构造器与语法编译器源码分析(下)" data-book-page-rel-url="Laravel%20Database——查询构造器与语法编译器源码分析%28下%29.html" data-book-page-id="7766">Laravel Database——查询构造器与语法编译器源码分析(下)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——分页原理与源码分析.html" title="Laravel Database——分页原理与源码分析" data-book-page-rel-url="Laravel%20Database——分页原理与源码分析.html" data-book-page-id="7767">Laravel Database——分页原理与源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——Eloquent%20Model%20源码分析%28上%29.html" title="Laravel Database——Eloquent Model 源码分析(上)" data-book-page-rel-url="Laravel%20Database——Eloquent%20Model%20源码分析%28上%29.html" data-book-page-id="7768">Laravel Database——Eloquent Model 源码分析(上)</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——Eloquent%20Model%20源码分析（下）.html" title="Laravel Database——Eloquent Model 源码分析（下）" data-book-page-rel-url="Laravel%20Database——Eloquent%20Model%20源码分析（下）.html" data-book-page-id="7769">Laravel Database——Eloquent Model 源码分析（下）</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——Eloquent%20Model%20关联源码分析.html" title="Laravel Database——Eloquent Model 关联源码分析" data-book-page-rel-url="Laravel%20Database——Eloquent%20Model%20关联源码分析.html" data-book-page-id="7770">Laravel Database——Eloquent Model 关联源码分析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——Eloquent%20Model%20模型关系加载与查询.html" title="Laravel Database——Eloquent Model 模型关系加载与查询" data-book-page-rel-url="Laravel%20Database——Eloquent%20Model%20模型关系加载与查询.html" data-book-page-id="7771">Laravel Database——Eloquent Model 模型关系加载与查询</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Database——Eloquent%20Model%20更新关联模型.html" title="Laravel Database——Eloquent Model 更新关联模型" data-book-page-rel-url="Laravel%20Database——Eloquent%20Model%20更新关联模型.html" data-book-page-id="7772">Laravel Database——Eloquent Model 更新关联模型</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Session" disabled data-book-page-rel-url="" data-book-page-id="7773">Laravel Session</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Session——session%20的启动与运行源码分析.html" title="Laravel Session——session 的启动与运行源码分析" data-book-page-rel-url="Laravel%20Session——session%20的启动与运行源码分析.html" data-book-page-id="7774">Laravel Session——session 的启动与运行源码分析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Event 事件系统" disabled data-book-page-rel-url="" data-book-page-id="7775">Laravel Event 事件系统</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Event——事件系统的启动与运行源码分析.html" title="Laravel Event——事件系统的启动与运行源码分析" data-book-page-rel-url="Laravel%20Event——事件系统的启动与运行源码分析.html" data-book-page-id="7776">Laravel Event——事件系统的启动与运行源码分析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Queue 队列" disabled data-book-page-rel-url="" data-book-page-id="7777">Laravel Queue 队列</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Queue——消息队列任务与分发源码剖析.html" title="Laravel Queue——消息队列任务与分发源码剖析" data-book-page-rel-url="Laravel%20Queue——消息队列任务与分发源码剖析.html" data-book-page-id="7778">Laravel Queue——消息队列任务与分发源码剖析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Queue——消息队列任务处理器源码剖析.html" title="Laravel Queue——消息队列任务处理器源码剖析" data-book-page-rel-url="Laravel%20Queue——消息队列任务处理器源码剖析.html" data-book-page-id="7779">Laravel Queue——消息队列任务处理器源码剖析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel 广播系统" disabled data-book-page-rel-url="" data-book-page-id="7780">Laravel 广播系统</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Broadcast——广播系统源码剖析.html" title="Laravel Broadcast——广播系统源码剖析" data-book-page-rel-url="Laravel%20Broadcast——广播系统源码剖析.html" data-book-page-id="7781">Laravel Broadcast——广播系统源码剖析</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Laravel Passport" disabled data-book-page-rel-url="" data-book-page-id="7782">Laravel Passport</a>
<ul>
<li>
<a class="pjax" href="../../book/107/Laravel%20Passport——OAuth2%20API%20认证系统源码解析.html" title="Laravel Passport——OAuth2 API 认证系统源码解析" data-book-page-rel-url="Laravel%20Passport——OAuth2%20API%20认证系统源码解析.html" data-book-page-id="7783">Laravel Passport——OAuth2 API 认证系统源码解析</a>
</li>
<li>
<a class="pjax" href="../../book/107/Laravel%20Passport——OAuth2%20API%20认证系统源码解析（下）.html" title="Laravel Passport——OAuth2 API 认证系统源码解析(下)" data-book-page-rel-url="Laravel%20Passport——OAuth2%20API%20认证系统源码解析（下）.html" data-book-page-id="7784">Laravel Passport——OAuth2 API 认证系统源码解析(下)</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =107;var bookPageId =7733;var bookPageRelUrl ='PHP%20Composer——%20初始化源码分析.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>