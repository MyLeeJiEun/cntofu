
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>同义词-Elasticsearch权威指南(Elasticsearch Definitive Guide)</title>
<meta content='同义词,Elasticsearch权威指南,Elasticsearch Definitive Guide' name='keywords'>
<meta content='同义词,Elasticsearch权威指南,Elasticsearch Definitive Guide' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../static/components/css/base.css">
<link rel="stylesheet" href="../../static/components/css/reader.css">
<link rel="stylesheet" href="../../static/components/css/asciidoc.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../book/40/stopwords.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">停用词: 性能与精度</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../book/40/fuzzy-matching.html">
<span class="">拼写错误</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../book/40/index.html">Elasticsearch权威指南 (Elasticsearch Definitive Guide)</a>
<a target="_blank" rel="nofollow" href="https://github.com/elasticsearch-cn/elasticsearch-definitive-guide" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  asc-content-section  uk-margin-bottom">
<h2 id="synonyms">同义词</h2>
<div class="paragraph">
<p>词干提取是通过简化他们的词根形式来扩大搜索的范围，同义词 通过相关的观念和概念来扩大搜索范围。 也许没有文档匹配查询 “英国女王“ ，但是包含 “英国君主” 的文档可能会被认为是很好的匹配。</p>
</div>
<div class="paragraph">
<p>用户搜索 “美国” 并且期望找到包含 <em>美利坚合众国</em> 、 <em>美国</em> 、 <em>美洲</em> 、或者 <em>美国各州</em> 的文档。 然而，他们不希望搜索到关于 <code>国事</code> 或者 <code>政府机构</code> 的结果。</p>
</div>
<div class="paragraph">
<p>这个例子提供了宝贵的经验，它向我们阐述了，区分不同的概念对于人类是多么简单而对于纯粹的机器是多么棘手的事情。通常我们会对语言中的每一个词去尝试提供同义词以确保任何一个文档都是可发现的，以保证不管文档之间有多么微小的关联性都能够被检索出来。</p>
</div>
<div class="paragraph">
<p>这样做是不对的。就像我们更喜欢不用或少用词根而不是过分使用词根一样，同义词也应该只在必要的时候使用。 这是因为用户可以理解他们的搜索结果受限于他们的搜索词，如果搜索结果看上去几乎是随机时，他们就会变得无法理解（注：大规模使用同义词会导致查询结果趋向于让人觉得是随机的）。</p>
</div>
<div class="paragraph">
<p>同义词可以用来合并几乎相同含义的词，如 <code>跳</code> 、 <code>跳越</code> 或者 <code>单脚跳行</code> ，和 <code>小册子</code> 、 <code>传单</code> 或者 <code>资料手册</code> 。 或者，它们可以用来让一个词变得更通用。例如， <code>鸟</code> 可以作为 <code>猫头鹰</code> 或 <code>鸽子</code> 的通用代名词，还有， <code>成人</code> 可以被用于 <code>男人</code> 或者 <code>女人</code> 。</p>
</div>
<div class="paragraph">
<p>同义词似乎是一个简单的概念，但是正确的使用它们却是非常困难的。在这一章，我们会介绍使用同义词的技巧和讨论它的局限性和陷阱。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody>
<tr>
<td class="icon">
<div class="title">
Tip
</div> </td>
<td class="content">
<div class="paragraph">
<p>同义词扩大了一个匹配文件的范围。正如 <a href="#stemming">词干提取</a> 或者 <a href="#partial-matching">部分匹配</a> ，同义词的字段不应该被单独使用，而应该与一个针对主字段的查询操作一起使用，这个主字段应该包含纯净格式的原始文本。 在使用同义词时，参阅 <a href="#most-fields">多数字段</a> 的解释来维护相关性。</p>
</div> </td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="using-synonyms">使用同义词</h3>
<div class="paragraph">
<p>同义词可以取代现有的语汇单元或 通过使用 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/analysis-synonym-tokenfilter.html"> <code>同义词</code> 语汇单元过滤器</a>，添加到语汇单元流中：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">PUT /my_index
{
  "settings": {
    "analysis": {
      "filter": {
        "my_synonym_filter": {
          "type": "synonym", <b class="conum">(1)</b>
          "synonyms": [ <b class="conum">(2)</b>
            "british,english",
            "queen,monarch"
          ]
        }
      },
      "analyzer": {
        "my_synonyms": {
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "my_synonym_filter" <b class="conum">(3)</b>
          ]
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li> <p>首先，我们定义了一个 <code>同义词</code> 类型的语汇单元过滤器。</p> </li>
<li> <p>我们在 <a href="#synonym-formats">同义词格式</a> 中讨论同义词格式。</p> </li>
<li> <p>然后我们创建了一个使用 <code>my_synonym_filter</code> 的自定义分析器。</p> </li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tbody>
<tr>
<td class="icon">
<div class="title">
Tip
</div> </td>
<td class="content">
<div class="paragraph">
<p>同义词可以使用 <code>synonym</code> 参数来内嵌指定，或者必须 存在于集群每一个节点上的同义词文件中。 同义词文件路径由 <code>synonyms_path</code> 参数指定，应绝对或相对于 Elasticsearch <code>config</code> 目录。参照 <a href="#updating-stopwords">更新停用词（Updating Stopwords）</a> 的技巧，可以用来刷新的同义词列表。</p>
</div> </td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph">
<p>通过 <code>analyze</code> API 来测试我们的分析器，显示如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">GET /my_index/_analyze?analyzer=my_synonyms
Elizabeth is the English queen</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Pos 1: (elizabeth)
Pos 2: (is)
Pos 3: (the)
Pos 4: (british,english) <b class="conum">(1)</b>
Pos 5: (queen,monarch) <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li> <p>所有同义词与原始词项占有同一个位置。</p> </li>
</ol>
</div>
<div class="paragraph">
<p>这样的一个文件将匹配任何以下的查询： <code>English queen</code> 、<code>British queen</code> 、 <code>English monarch</code> 或 <code>British monarch</code> 。 即使是一个短语查询也将会工作，因为每个词项的位置已被保存。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody>
<tr>
<td class="icon">
<div class="title">
Tip
</div> </td>
<td class="content">
<div class="paragraph">
<p>在索引和搜索中使用相同的同义词语汇单元过滤器是多余的。 如果在索引的时候，我们用 <code>english</code> 和 <code>british</code> 这两个术语代替 <code>English</code> ， 然后在搜索的时候，我们只需要搜索这些词项中的一个。或者，如果在索引的时候我们不使用同义词，然后在搜索的时候，我们将需要把对 <code>English</code> 的查询转换为 <code>english</code> 或者 <code>british</code> 的查询。</p>
</div>
<div class="paragraph">
<p>是否在搜索或索引的时候做同义词扩展可能是一个困难的选择。我们将探索更多的选择 <a href="#synonyms-expand-or-contract">扩展或收缩</a>。</p>
</div> </td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="synonym-formats">同义词格式</h3>
<div class="paragraph">
<p>同义词最简单的表达形式是 逗号分隔：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"jump,leap,hop"</pre>
</div>
</div>
<div class="paragraph">
<p>如果遇到这些词项中的任何一项，则将其替换为所有列出的同义词。例如：</p>
</div>
<div class="listingblock pagebreak-before">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">原始词项:   取代:
────────────────────────────────
jump            → (jump,leap,hop)
leap            → (jump,leap,hop)
hop             → (jump,leap,hop)</code></pre>
</div>
</div>
<div class="paragraph">
<p>或者, 使用 <code>⇒</code> 语法，可以指定一个词项列表（在左边），和一个或多个替换（右边）的列表：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"u s a,united states,united states of america =&gt; usa"
"g b,gb,great britain =&gt; britain,england,scotland,wales"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">原始词项:   取代:
────────────────────────────────
u s a           → (usa)
united states   → (usa)
great britain   → (britain,england,scotland,wales)</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果多个规则指定同一个同义词，它们将被合并在一起，且顺序无关，否则使用最长匹配。以下面的规则为例：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"united states            =&gt; usa",
"united states of america =&gt; usa"</pre>
</div>
</div>
<div class="paragraph">
<p>如果这些规则相互冲突，Elasticsearch 会将 <code>United States of America</code> 转换为词项 <code>(usa),(of),(america)</code> 。否则，会使用最长的序列，即最终得到词项 <code>(usa)</code> 。</p>
</div>
</div>
<div class="sect2">
<h3 id="synonyms-expand-or-contract">扩展或收缩</h3>
<div class="paragraph">
<p>在 <a href="#synonym-formats">同义词格式</a> 中，我们看到了可以通过 <em>简单扩展</em> 、 <em>简单收缩</em> 、或_类型扩展_ 来指明同义词规则。 本章节我们将在这三者间做个权衡比较。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody>
<tr>
<td class="icon">
<div class="title">
Tip
</div> </td>
<td class="content"> 本节仅处理单词同义词。多词同义词又增添了一层复杂性，在 <a href="#multi-word-synonyms">多词同义词和短语查询</a> 中，我们将会讨论。 </td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="synonyms-expansion">简单扩展</h4>
<div class="paragraph">
<p>通过 <em>简单扩展</em> ，我们可以把同义词列表中的任意一个词扩展成同义词列表 <em>所有</em> 的词：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"jump,hop,leap"</pre>
</div>
</div>
<div class="paragraph">
<p>扩展可以应用在索引阶段或查询阶段。两者都有优点 (⬆)︎ 和缺点 (⬇)︎。到底要在哪个阶段使用，则取决于性能与灵活性：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">索引</th>
<th class="tableblock halign-left valign-top">查询</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">索引的大小</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬇︎ 大索引。因为所有的同义词都会被索引，所以索引的大小相对会变大一些。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬆︎ 正常大小。</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">关联</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬇︎ 所有同义词都有相同的 IDF（至于什么是 IDF ，参见 <a href="#relevance-intro">什么是相关性?</a>），这意味着通用的词和较常用的词都拥有着相同的权重。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬆︎ 每个同义词 IDF 都和原来一样。</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">性能</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬆︎ 查询只需要找到查询字符串中指定单个词项。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬇︎ 对一个词项的查询重写来查找所有的同义词，从而降低性能。</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">灵活性</p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬇︎ 同义词规则不能改变现有的文件。对于有影响的新规则，现有的文件都要重建（注：重新索引一次文档）。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⬆︎ 同义词规则可以更新不需要索引文件。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="synonyms-contraction">简单收缩</h4>
<div class="paragraph">
<p><em>简单收缩</em> ，把 左边的多个同义词映射到了右边的单个词：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"leap,hop =&gt; jump"</pre>
</div>
</div>
<div class="paragraph">
<p>它必须同时应用于索引和查询阶段，以确保查询词项映射到索引中存在的同一个值。</p>
</div>
<div class="paragraph">
<p>相对于简单扩展方法，这种方法也有一些优点和一些缺点：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">
索引的大小
</dt>
<dd>
<p>⬆︎ 索引大小是正常的，因为只有单一词项被索引。</p>
</dd>
<dt class="hdlist1">
关联
</dt>
<dd>
<p>⬇︎ 所有词项的 IDF 是一样的，所以你不能区分比较常用的词、不常用的单词。</p>
</dd>
<dt class="hdlist1">
性能
</dt>
<dd>
<p>⬆︎ 查询只需要在索引中找到单词的出现。</p>
</dd>
<dt class="hdlist1">
灵活性
</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>⬆︎ 新同义词可以添加到规则的左侧并在查询阶段使用。例如，我们想添加 <code>bound</code> 到先前指定的同义词规则中。那么下面的规则将作用于包含 <code>bound</code> 的查询或包含 <code>bound</code> 的文档索引：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"leap,hop,bound =&gt; jump"</pre>
</div>
</div>
<div class="paragraph">
<p>似乎对旧有的文档不起作用是么？其实我们可以把上面这个同义词规则改写下，以便对旧有文档同样起作用：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"leap,hop,bound =&gt; jump,bound"</pre>
</div>
</div>
<div class="paragraph">
<p>当你重建索引文件，你可以恢复到上面的规则（注： <code>leap,hop,bound ⇒ jump</code> ）来获得查询单个词项的性能优势（注：因为上面那个规则相比这个而言，查询阶段就只要查询一个词了）。</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="synonyms-genres">类型扩展</h4>
<div class="paragraph">
<p>类型扩展是完全不同于简单收缩 或扩张， 并不是平等看待所有的同义词，而是扩大了词的意义，使被拓展的词更为通用。以这些规则为例：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"cat    =&gt; cat,pet",
"kitten =&gt; kitten,cat,pet",
"dog    =&gt; dog,pet"
"puppy  =&gt; puppy,dog,pet"</pre>
</div>
</div>
<div class="paragraph">
<p>通过在索引阶段使用类型扩展：</p>
</div>
<div class="ulist">
<ul>
<li> <p>一个关于 <code>kitten</code> 的查询会发现关于 kittens 的文档。</p> </li>
<li> <p>查询一个 <code>cat</code> 会找到关于 kittens 和 cats 的文档。</p> </li>
<li> <p>一个 <code>pet</code> 的查询将发现有关的 kittens、cats、puppies、dogs 或者 pets 的文档。</p> </li>
</ul>
</div>
<div class="paragraph">
<p>或者在查询阶段使用类型扩展， <code>kitten</code> 的查询结果就会被拓展成涉及到 kittens、cats、dogs。</p>
</div>
<div class="paragraph">
<p>您也可以有两全其美的办法，通过在索引阶段应用类型扩展同义词规则，以确保类型在索引中存在。然后，在查询阶段， 你可以选择不采用同义词（使 <code>kitten</code> 查询只返回 kittens 的文件）或采用同义词， <code>kitten</code> 的查询操作就会返回包括 kittens、cats、pets（也包括 dogs 和 puppies）的相关结果。</p>
</div>
<div class="paragraph">
<p>前面的示例规则，对 <code>kitten</code> 的 IDF 将是正确的，而 <code>cat</code> 和 <code>pet</code> 的 IDF 将会被 Elasticsearch 降权。然而, 这是对你有利的，当一个针对 <code>kitten</code> 的查询被拓展成了针对 <code>kitten OR cat OR pet</code> 的查询， 那么 <code>kitten</code> 相关的文档就应该排在最上方，其次是 <code>cat</code> 的文件， <code>pet</code> 的文件将被排在最底部。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="synonyms-analysis-chain">同义词和分析链</h3>
<div class="paragraph">
<p>在 <a href="#synonym-formats">同义词格式</a> 一章中，我们使用 <code>u s a</code> 来举例阐述一些同义词相关的知识。那么为什么 我们使用的不是 <code>U.S.A.</code> 呢？原因是， 这个 <code>同义词</code> 的语汇单元过滤器只能接收到在它前面的语汇单元过滤器或者分词器的输出结果（这里看不到原始文本）。</p>
</div>
<div class="paragraph">
<p>假设我们有一个分析器，它由 <code>standard</code> 分词器、 <code>lowercase</code> 的语汇单元过滤器、 <code>synonym</code> 的语汇单元过滤器组成。文本 <code>U.S.A.</code> 的分析过程，看起来像这样的：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">original string（原始文本）                       → "U.S.A."
standard           tokenizer（分词器）            → (U),(S),(A)
lowercase          token filter（语汇单元过滤器）  → (u),(s),(a)
synonym            token filter（语汇单元过滤器）  → (usa)</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果我们有指定的同义词 <code>U.S.A.</code> ，它永远不会匹配任何东西。因为， <code>my_synonym_filter</code> 看到词项的时候，句号已经被移除了，并且字母已经被小写了。</p>
</div>
<div class="paragraph">
<p>这其实是一个非常需要注意的地方。如果我们想同时使用同义词特性与词根提取特性，那么 <code>jumps</code> 、 <code>jumped</code> 、 <code>jump</code> 、 <code>leaps</code> 、 <code>leaped</code> 和 <code>leap</code> 这些词是否都会被索引成一个 <code>jump</code> ？ 我们 可以把同义词过滤器放置在词根提取之前，然后把所有同义词以及词形变化都列举出来：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"jumps,jumped,leap,leaps,leaped =&gt; jump"</pre>
</div>
</div>
<div class="paragraph">
<p>但更简洁的方式将同义词过滤器放置在词根过滤器之后，然后把词根形式的同义词列举出来：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"leap =&gt; jump"</pre>
</div>
</div>
<div class="sect3">
<h4 id="_大小写敏感的同义词">大小写敏感的同义词</h4>
<div class="paragraph">
<p>通常，我们把同义词过滤器放置在 <code>lowercase</code> 语汇单元过滤器之后，因此，所有的同义词 都是小写。 但有时会导致奇怪的合并。例如， <code>CAT</code> 扫描和一只 <code>cat</code> 有很大的不同，或者 <code>PET</code> （正电子发射断层扫描）和 <code>pet</code> 。 就此而言，姓 <code>Little</code> 也是不同于形容词 <code>little</code> 的 (尽管当一个句子以它开头时，首字母会被大写)。</p>
</div>
<div class="paragraph">
<p>如果根据使用情况来区分词义，则需要将同义词过滤器放置在 <code>lowercase</code> 筛选器之前。当然，这意味着同义词规则需要列出所有想匹配的变化（例如， <code>Little、LITTLE、little</code> ）。</p>
</div>
<div class="paragraph">
<p>相反,可以有两个同义词过滤器：一个匹配大小写敏感的同义词，一个匹配大小写不敏感的同义词。例如，大小写敏感的同义词规则可以是这个样子：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"CAT,CAT scan           =&gt; cat_scan"
"PET,PET scan           =&gt; pet_scan"
"Johnny Little,J Little =&gt; johnny_little"
"Johnny Small,J Small   =&gt; johnny_small"</pre>
</div>
</div>
<div class="paragraph">
<p>大小不敏感的同义词规则可以是这个样子：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"cat                    =&gt; cat,pet"
"dog                    =&gt; dog,pet"
"cat scan,cat_scan scan =&gt; cat_scan"
"pet scan,pet_scan scan =&gt; pet_scan"
"little,small"</pre>
</div>
</div>
<div class="paragraph">
<p>大小写敏感的同义词规则不仅会处理 <code>CAT scan</code> ，而且有时候也可能会匹配到 <code>CAT scan</code> 中的 <code>CAT</code> （注：从而导致 <code>CAT scan</code> 被转化成了同义词 <code>cat_scan scan</code> ）。出于这个原因，在大小写敏感的同义词列表中会有一个针对较坏替换情况的特异规则 <code>cat_scan scan</code> 。</p>
</div>
<div class="paragraph">
<p>提示： 可以看到它们可以多么轻易地变得复杂。同平时一样， <code>analyze</code> API 是帮手，用它来检查分析器是否正确配置。参阅 <a href="#analyze-api">测试分析器</a>。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="multi-word-synonyms">多词同义词和短语查询</h3>
<div class="paragraph">
<p>至此，同义词看上去还挺简单的。然而不幸的是，复杂的部分才刚刚开始。 为了能使 <a href="#phrase-matching">短语查询</a> 正常工作， Elasticsearch 需要知道每个词在初始文本中的位置。多词同义词会严重破坏词的位置信息，尤其当新增的同义词标记长度各不相同的时候。</p>
</div>
<div class="paragraph">
<p>我们创建一个同义词语汇单元过滤器，然后使用下面这样的同义词规则：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"usa,united states,u s a,united states of america"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">PUT /my_index
{
  "settings": {
    "analysis": {
      "filter": {
        "my_synonym_filter": {
          "type": "synonym",
          "synonyms": [
            "usa,united states,u s a,united states of america"
          ]
        }
      },
      "analyzer": {
        "my_synonyms": {
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "my_synonym_filter"
          ]
        }
      }
    }
  }
}

GET /my_index/_analyze?analyzer=my_synonyms&amp;text=
The United States is wealthy</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>解析器</code> 会输出下面这样的结果：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Pos 1:  (the)
Pos 2:  (usa,united,u,united)
Pos 3:  (states,s,states)
Pos 4:  (is,a,of)
Pos 5:  (wealthy,america)</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果你用上面这个同义词语汇单元过滤器索引一个文档，然后执行一个短语查询，那你就会得到惊人的结果，下面这些短语都不会匹配成功：</p>
</div>
<div class="ulist">
<ul>
<li> <p>The usa is wealthy</p> </li>
<li> <p>The united states of america is wealthy</p> </li>
<li> <p>The U.S.A. is wealthy</p> </li>
</ul>
</div>
<div class="paragraph">
<p>但是这些短语会：</p>
</div>
<div class="ulist">
<ul>
<li> <p>United states is wealthy</p> </li>
<li> <p>Usa states of wealthy</p> </li>
<li> <p>The U.S. of wealthy</p> </li>
<li> <p>U.S. is america</p> </li>
</ul>
</div>
<div class="paragraph">
<p>如果你是在查询阶段使同义词，那你就会看到更加诡异的匹配结果。看下这个 <code>validate-query</code> 查询：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">GET /my_index/_validate/query?explain
{
  "query": {
    "match_phrase": {
      "text": {
        "query": "usa is wealthy",
        "analyzer": "my_synonyms"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>查询关键字会被同义词语汇单元过滤器处理成类似这样的信息：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"(usa united u united) (is states s states) (wealthy a of) america"</pre>
</div>
</div>
<div class="paragraph">
<p>这会匹配包含有 <code>u is of america</code> 的文档，但是匹配不出任何含有 <code>america</code> 的文档。</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody>
<tr>
<td class="icon">
<div class="title">
Tip
</div> </td>
<td class="content">
<div class="paragraph">
<p>多词同义对高亮匹配结果也会造成影响。一个针对 <code>USA</code> 的查询，返回的结果可能却高亮了： The <em>United States is wealthy</em> 。</p>
</div> </td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_使用简单收缩进行短语查询">使用简单收缩进行短语查询</h4>
<div class="paragraph">
<p>避免这种混乱的方法是使用 <a href="#synonyms-contraction">简单收缩</a>， 用单个词项表示所有的同义词， 然后在查询阶段，就只需要针对这单个词进行查询了：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">PUT /my_index
{
  "settings": {
    "analysis": {
      "filter": {
        "my_synonym_filter": {
          "type": "synonym",
          "synonyms": [
            "united states,u s a,united states of america=&gt;usa"
          ]
        }
      },
      "analyzer": {
        "my_synonyms": {
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "my_synonym_filter"
          ]
        }
      }
    }
  }
}

GET /my_index/_analyze?analyzer=my_synonyms
The United States is wealthy</code></pre>
</div>
</div>
<div class="paragraph">
<p>上面那个查询信息就会被处理成类似下面这样：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Pos 1:  (the)
Pos 2:  (usa)
Pos 3:  (is)
Pos 5:  (wealthy)</code></pre>
</div>
</div>
<div class="paragraph">
<p>现在我们再次执行我们之前做过的那个 <code>validate-query</code> 查询，就会输出一个简单又合理的结果：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"usa is wealthy"</pre>
</div>
</div>
<div class="paragraph">
<p>这个方法的缺点是，因为把 <code>united states of america</code> 转换成了同义词 <code>usa</code>, 你就不能使用 <code>united states of america</code> 去搜索出 <code>united</code> 或者 <code>states</code> 。 你需要使用一个额外的字段并用另一个解析器链来达到这个目的。</p>
</div>
</div>
<div class="sect3">
<h4 id="_同义词与_query_string_查询">同义词与 query_string 查询</h4>
<div class="paragraph">
<p>本书很少谈论到 <code>query_string</code> 查询，因为真心不推荐你用它。 在 <a href="#query-string-query">复杂查询</a> 一节中有提到，由于 <code>query_string</code> 查询支持一个精简的 <em>查询语法</em> ，因此，可能这会导致它搜出一些出人意料的结果或者甚至是含有语法错误的结果。</p>
</div>
<div class="paragraph">
<p>这种查询方式存在不少问题，而其中之一便与多词同义有关。为了支持它的查询语法，你必须用指定的、该语法所能识别的操作符号来标示，比如 <code>AND</code> 、 <code>OR</code> 、 <code>+</code> 、 <code>-</code> 、 <code>field:</code> 等等。 (更多相关内容参阅 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/query-dsl-query-string-query.html#query-string-syntax"><code>query_string</code> 语法</a> 。)</p>
</div>
<div class="paragraph">
<p>而在这种语法的解析过程中，解析动作会把查询文本在空格符处作切分，然后分别把每个切分出来的词传递给相关性解析器。 这也即意味着你的同义词解析器永远都不可能收到类似 <code>United States</code> 这样的多个单词组成的同义词。由于不会把 <code>United States</code> 作为一个原子性的文本，所以同义词解析器的输入信息永远都是两个被切分开的词 <code>United</code> 和 <code>States</code> 。</p>
</div>
<div class="paragraph">
<p>所幸， <code>match</code> 查询相比而言就可靠得多了，因为它不支持上述语法，所以多个字组成的同义词不会被切分开，而是会完整地交给解析器处理。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="symbol-synonyms">符号同义词</h3>
<div class="paragraph">
<p>最后一节内容我们来阐述下怎么对符号进行同义词处理，这和我们前面讲的同义词处理不太一样。 <em>符号同义词</em> 是用别名来表示这个符号，以防止它在分词过程中被误认为是不重要的标点符号而被移除。</p>
</div>
<div class="paragraph">
<p>虽然绝大多数情况下，符号对于全文搜索而言都无关紧要，但是字符组合而成的表情，或许又会是很有意义的东西，甚至有时候会改变整个句子的含义，对比一下这两句话：</p>
</div>
<div class="ulist pagebreak-before">
<ul>
<li> <p>我很高兴能在星期天工作。</p> </li>
<li> <p>我很高兴能在星期天工作 :( （注：难过的表情）</p> </li>
</ul>
</div>
<div class="paragraph">
<p><code>标准</code> （注：standard）分词器或许会简单地消除掉第二个句子里的字符表情，致使两个原本意思相去甚远的句子变得相同。</p>
</div>
<div class="paragraph">
<p>我们可以先使用 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/analysis-mapping-charfilter.html"><code>映射</code></a>字符过滤器，在文本被递交给分词器处理之前， 把字符表情替换成符号同义词 <code>emoticon_happy</code> 或者 <code>emoticon_sad</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">PUT /my_index
{
  "settings": {
    "analysis": {
      "char_filter": {
        "emoticons": {
          "type": "mapping",
          "mappings": [ <b class="conum">(1)</b>
            ":)=&gt;emoticon_happy",
            ":(=&gt;emoticon_sad"
          ]
        }
      },
      "analyzer": {
        "my_emoticons": {
          "char_filter": "emoticons",
          "tokenizer":   "standard",
          "filter":    [ "lowercase" ]
          ]
        }
      }
    }
  }
}

GET /my_index/_analyze?analyzer=my_emoticons
I am :) not :( <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li> <p><code>映射</code> 过滤器把字符从 <code>⇒</code> 左边的格式转变成右边的样子。</p> </li>
<li> <p>输出： <code>i</code> 、 <code>am</code> 、 <code>emoticon_happy</code> 、 <code>not</code> 、 <code>emoticon_sad</code> 。</p> </li>
</ol>
</div>
<div class="paragraph">
<p>很少有人会搜 <code>emoticon_happy</code> 这个词，但是确保类似字符表情的这类重要符号被存储到索引中是非常好的做法，在进行情感分析的时候会很有用。当然，我们也可以用真实的词汇来处理符号同义词，比如： <code>happy</code> 或者 <code>sad</code> 。</p>
</div>
<div class="paragraph">
<p>提示： <code>映射</code> 字符过滤器是个非常有用的过滤器，它可以用来对一些已有的字词进行替换操作， 你如果想要采用更灵活的正则表达式去替换字词的话，那你可以使用 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.6/analysis-pattern-replace-charfilter.html"> <code>pattern_replace</code> </a>字符过滤器。</p>
</div>
</div>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/3/index.html">
<img class="uk-book-cover" src="../../static/icons/48/go_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/3/index.html">深入解析Go</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/3.html">tiancaiamao</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="go">go</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">41页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月1日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1018个">1018</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/200/index.html">
<img class="uk-book-cover" src="../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/200/index.html">软件开发基础知识宝典</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/112.html">frank-lam</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">20页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2021年10月24日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/126/index.html">
<img class="uk-book-cover" src="../../static/icons/48/html5_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/126/index.html">前端晚自修</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/67.html">if2er</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="html5">html5</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">22页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月8日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1个">1</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/70/index.html">
<img class="uk-book-cover" src="../../static/icons/48/cplusplus_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/70/index.html">C++ 资源大全中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/19.html">伯乐在线</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="cplusplus">cplusplus</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">1页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月6日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1422个">1422</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/166/index.html">
<img class="uk-book-cover" src="../../static/icons/48/python_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/166/index.html">What the f*ck Python中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/95.html">leisurelicht</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">70页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 7300个">7300</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/58/index.html">
<img class="uk-book-cover" src="../../static/icons/48/java_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/58/index.html">guava学习记录项目</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/34.html">tiantiangao</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="java">java</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">24页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月5日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 70个">70</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../" title="返回首页"><img class="" src="../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../book/40/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../book/40/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../book/40/foreword_id.html" title="序言" data-book-page-rel-url="foreword_id.html" data-book-page-id="9242">序言</a>
</li>
<li>
<a class="pjax" href="../../book/40/preface.html" title="前言" data-book-page-rel-url="preface.html" data-book-page-id="9243">前言</a>
<ul>
<li>
<a class="pjax" href="../../book/40/_who_should_read_this_book.html" title="谁应该读这本书" data-book-page-rel-url="_who_should_read_this_book.html" data-book-page-id="9244">谁应该读这本书</a>
</li>
<li>
<a class="pjax" href="../../book/40/_why_we_wrote_this_book.html" title="为什么我们要写这本书" data-book-page-rel-url="_why_we_wrote_this_book.html" data-book-page-id="9245">为什么我们要写这本书</a>
</li>
<li>
<a class="pjax" href="../../book/40/_elasticsearch_version.html" title="Elasticsearch 版本" data-book-page-rel-url="_elasticsearch_version.html" data-book-page-id="9246">Elasticsearch 版本</a>
</li>
<li>
<a class="pjax" href="../../book/40/_how_to_read_this_book.html" title="如何读这本书" data-book-page-rel-url="_how_to_read_this_book.html" data-book-page-id="9247">如何读这本书</a>
</li>
<li>
<a class="pjax" href="../../book/40/_navigating_this_book.html" title="本书导航" data-book-page-rel-url="_navigating_this_book.html" data-book-page-id="9248">本书导航</a>
</li>
<li>
<a class="pjax" href="../../book/40/_online_resources.html" title="在线资源" data-book-page-rel-url="_online_resources.html" data-book-page-id="9249">在线资源</a>
</li>
<li>
<a class="pjax" href="../../book/40/_conventions_used_in_this_book.html" title="本书协议约定" data-book-page-rel-url="_conventions_used_in_this_book.html" data-book-page-id="9250">本书协议约定</a>
</li>
<li>
<a class="pjax" href="../../book/40/_using_code_examples.html" title="使用代码示例" data-book-page-rel-url="_using_code_examples.html" data-book-page-id="9251">使用代码示例</a>
</li>
<li>
<a class="pjax" href="../../book/40/_acknowledgments.html" title="鸣谢" data-book-page-rel-url="_acknowledgments.html" data-book-page-id="9252">鸣谢</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/getting-started.html" title="基础入门" data-book-page-rel-url="getting-started.html" data-book-page-id="9253">基础入门</a>
<ul>
<li>
<a class="pjax" href="../../book/40/intro.html" title="你知道的, 为了搜索&#8230;&#8203;" data-book-page-rel-url="intro.html" data-book-page-id="9254">你知道的, 为了搜索&#8230;&#8203;</a>
</li>
<li>
<a class="pjax" href="../../book/40/distributed-cluster.html" title="集群内的原理" data-book-page-rel-url="distributed-cluster.html" data-book-page-id="9255">集群内的原理</a>
</li>
<li>
<a class="pjax" href="../../book/40/data-in-data-out.html" title="数据输入和输出" data-book-page-rel-url="data-in-data-out.html" data-book-page-id="9256">数据输入和输出</a>
</li>
<li>
<a class="pjax" href="../../book/40/distributed-docs.html" title="分布式文档存储" data-book-page-rel-url="distributed-docs.html" data-book-page-id="9257">分布式文档存储</a>
</li>
<li>
<a class="pjax" href="../../book/40/search.html" title="搜索——最基本的工具" data-book-page-rel-url="search.html" data-book-page-id="9258">搜索——最基本的工具</a>
</li>
<li>
<a class="pjax" href="../../book/40/mapping-analysis.html" title="映射和分析" data-book-page-rel-url="mapping-analysis.html" data-book-page-id="9259">映射和分析</a>
</li>
<li>
<a class="pjax" href="../../book/40/full-body-search.html" title="请求体查询" data-book-page-rel-url="full-body-search.html" data-book-page-id="9260">请求体查询</a>
</li>
<li>
<a class="pjax" href="../../book/40/sorting.html" title="排序与相关性" data-book-page-rel-url="sorting.html" data-book-page-id="9261">排序与相关性</a>
</li>
<li>
<a class="pjax" href="../../book/40/distributed-search.html" title="执行分布式检索" data-book-page-rel-url="distributed-search.html" data-book-page-id="9262">执行分布式检索</a>
</li>
<li>
<a class="pjax" href="../../book/40/index-management.html" title="索引管理" data-book-page-rel-url="index-management.html" data-book-page-id="9263">索引管理</a>
</li>
<li>
<a class="pjax" href="../../book/40/inside-a-shard.html" title="分片内部原理" data-book-page-rel-url="inside-a-shard.html" data-book-page-id="9264">分片内部原理</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/search-in-depth.html" title="深入搜索" data-book-page-rel-url="search-in-depth.html" data-book-page-id="9265">深入搜索</a>
<ul>
<li>
<a class="pjax" href="../../book/40/structured-search.html" title="结构化搜索" data-book-page-rel-url="structured-search.html" data-book-page-id="9266">结构化搜索</a>
</li>
<li>
<a class="pjax" href="../../book/40/full-text-search.html" title="全文搜索" data-book-page-rel-url="full-text-search.html" data-book-page-id="9267">全文搜索</a>
</li>
<li>
<a class="pjax" href="../../book/40/multi-field-search.html" title="多字段搜索" data-book-page-rel-url="multi-field-search.html" data-book-page-id="9268">多字段搜索</a>
</li>
<li>
<a class="pjax" href="../../book/40/proximity-matching.html" title="近似匹配" data-book-page-rel-url="proximity-matching.html" data-book-page-id="9269">近似匹配</a>
</li>
<li>
<a class="pjax" href="../../book/40/partial-matching.html" title="部分匹配" data-book-page-rel-url="partial-matching.html" data-book-page-id="9270">部分匹配</a>
</li>
<li>
<a class="pjax" href="../../book/40/controlling-relevance.html" title="控制相关度" data-book-page-rel-url="controlling-relevance.html" data-book-page-id="9271">控制相关度</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/languages.html" title="处理人类语言" data-book-page-rel-url="languages.html" data-book-page-id="9272">处理人类语言</a>
<ul>
<li>
<a class="pjax" href="../../book/40/language-intro.html" title="开始处理各种语言" data-book-page-rel-url="language-intro.html" data-book-page-id="9273">开始处理各种语言</a>
</li>
<li>
<a class="pjax" href="../../book/40/identifying-words.html" title="词汇识别" data-book-page-rel-url="identifying-words.html" data-book-page-id="9274">词汇识别</a>
</li>
<li>
<a class="pjax" href="../../book/40/token-normalization.html" title="归一化词元" data-book-page-rel-url="token-normalization.html" data-book-page-id="9275">归一化词元</a>
</li>
<li>
<a class="pjax" href="../../book/40/stemming.html" title="将单词还原为词根" data-book-page-rel-url="stemming.html" data-book-page-id="9276">将单词还原为词根</a>
</li>
<li>
<a class="pjax" href="../../book/40/stopwords.html" title="停用词: 性能与精度" data-book-page-rel-url="stopwords.html" data-book-page-id="9277">停用词: 性能与精度</a>
</li>
<li>
<a class="pjax" href="../../book/40/synonyms.html" title="同义词" data-book-page-rel-url="synonyms.html" data-book-page-id="9278">同义词</a>
</li>
<li>
<a class="pjax" href="../../book/40/fuzzy-matching.html" title="拼写错误" data-book-page-rel-url="fuzzy-matching.html" data-book-page-id="9279">拼写错误</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/aggregations.html" title="聚合" data-book-page-rel-url="aggregations.html" data-book-page-id="9280">聚合</a>
<ul>
<li>
<a class="pjax" href="../../book/40/aggs-high-level.html" title="高阶概念" data-book-page-rel-url="aggs-high-level.html" data-book-page-id="9281">高阶概念</a>
</li>
<li>
<a class="pjax" href="../../book/40/_aggregation_test_drive.html" title="尝试聚合" data-book-page-rel-url="_aggregation_test_drive.html" data-book-page-id="9282">尝试聚合</a>
</li>
<li>
<a class="pjax" href="../../book/40/_building_bar_charts.html" title="条形图" data-book-page-rel-url="_building_bar_charts.html" data-book-page-id="9283">条形图</a>
</li>
<li>
<a class="pjax" href="../../book/40/_looking_at_time.html" title="按时间统计" data-book-page-rel-url="_looking_at_time.html" data-book-page-id="9284">按时间统计</a>
</li>
<li>
<a class="pjax" href="../../book/40/_scoping_aggregations.html" title="范围限定的聚合" data-book-page-rel-url="_scoping_aggregations.html" data-book-page-id="9285">范围限定的聚合</a>
</li>
<li>
<a class="pjax" href="../../book/40/_filtering_queries_and_aggregations.html" title="过滤和聚合" data-book-page-rel-url="_filtering_queries_and_aggregations.html" data-book-page-id="9286">过滤和聚合</a>
</li>
<li>
<a class="pjax" href="../../book/40/_sorting_multivalue_buckets.html" title="多桶排序" data-book-page-rel-url="_sorting_multivalue_buckets.html" data-book-page-id="9287">多桶排序</a>
</li>
<li>
<a class="pjax" href="../../book/40/_approximate_aggregations.html" title="近似聚合" data-book-page-rel-url="_approximate_aggregations.html" data-book-page-id="9288">近似聚合</a>
</li>
<li>
<a class="pjax" href="../../book/40/significant-terms.html" title="通过聚合发现异常指标" data-book-page-rel-url="significant-terms.html" data-book-page-id="9289">通过聚合发现异常指标</a>
</li>
<li>
<a class="pjax" href="../../book/40/docvalues-and-fielddata.html" title="Doc Values and Fielddata" data-book-page-rel-url="docvalues-and-fielddata.html" data-book-page-id="9290">Doc Values and Fielddata</a>
</li>
<li>
<a class="pjax" href="../../book/40/_closing_thoughts.html" title="总结" data-book-page-rel-url="_closing_thoughts.html" data-book-page-id="9291">总结</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/geoloc.html" title="地理位置" data-book-page-rel-url="geoloc.html" data-book-page-id="9292">地理位置</a>
<ul>
<li>
<a class="pjax" href="../../book/40/geopoints.html" title="地理坐标点" data-book-page-rel-url="geopoints.html" data-book-page-id="9293">地理坐标点</a>
</li>
<li>
<a class="pjax" href="../../book/40/geohashes.html" title="Geohashes" data-book-page-rel-url="geohashes.html" data-book-page-id="9294">Geohashes</a>
</li>
<li>
<a class="pjax" href="../../book/40/geo-aggs.html" title="地理位置聚合" data-book-page-rel-url="geo-aggs.html" data-book-page-id="9295">地理位置聚合</a>
</li>
<li>
<a class="pjax" href="../../book/40/geo-shapes.html" title="地理形状" data-book-page-rel-url="geo-shapes.html" data-book-page-id="9296">地理形状</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/modeling-your-data.html" title="数据建模" data-book-page-rel-url="modeling-your-data.html" data-book-page-id="9297">数据建模</a>
<ul>
<li>
<a class="pjax" href="../../book/40/relations.html" title="关联关系处理" data-book-page-rel-url="relations.html" data-book-page-id="9298">关联关系处理</a>
</li>
<li>
<a class="pjax" href="../../book/40/nested-objects.html" title="嵌套对象" data-book-page-rel-url="nested-objects.html" data-book-page-id="9299">嵌套对象</a>
</li>
<li>
<a class="pjax" href="../../book/40/parent-child.html" title="父-子关系文档" data-book-page-rel-url="parent-child.html" data-book-page-id="9300">父-子关系文档</a>
</li>
<li>
<a class="pjax" href="../../book/40/scale.html" title="扩容设计" data-book-page-rel-url="scale.html" data-book-page-id="9301">扩容设计</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/40/administration.html" title="管理、监控和部署" data-book-page-rel-url="administration.html" data-book-page-id="9302">管理、监控和部署</a>
<ul>
<li>
<a class="pjax" href="../../book/40/cluster-admin.html" title="监控" data-book-page-rel-url="cluster-admin.html" data-book-page-id="9303">监控</a>
</li>
<li>
<a class="pjax" href="../../book/40/deploy.html" title="部署" data-book-page-rel-url="deploy.html" data-book-page-id="9304">部署</a>
</li>
<li>
<a class="pjax" href="../../book/40/post_deploy.html" title="部署后" data-book-page-rel-url="post_deploy.html" data-book-page-id="9305">部署后</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =40;var bookPageId =9278;var bookPageRelUrl ='synonyms.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>