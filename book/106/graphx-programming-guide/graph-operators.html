
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>图操作符-Spark 编程指南简体中文版</title>
<meta content='图操作符,Spark 编程指南简体中文版' name='keywords'>
<meta content='图操作符,Spark 编程指南简体中文版' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../../static/components/css/base.css">
<link rel="stylesheet" href="../../../static/components/css/reader.css">
<link rel="stylesheet" href="../../../static/components/css/markdown.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../../book/106/graphx-programming-guide/property-graph.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">属性图</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../../book/106/graphx-programming-guide/pregel-api.html">
<span class="">Pregel API</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../../book/106/index.html">Spark 编程指南简体中文版</a>
<a target="_blank" rel="nofollow" href="https://github.com/aiyanbo/spark-programming-guide-zh-cn" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  md-content-section  uk-margin-bottom">
<h1 id="图操作符">图操作符</h1>
<p>正如RDDs有基本的操作map, filter和reduceByKey一样，属性图也有基本的集合操作，这些操作采用用户自定义的函数并产生包含转换特征和结构的新图。定义在<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph">Graph</a>中的 核心操作是经过优化的实现。表示为核心操作的组合的便捷操作定义在<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.GraphOps">GraphOps</a>中。然而， 因为有Scala的隐式转换，定义在<code>GraphOps</code>中的操作可以作为<code>Graph</code>的成员自动使用。例如，我们可以通过下面的方式计算每个顶点(定义在GraphOps中)的入度。</p>
<pre><code class="language-scala">val graph: Graph[(String, String), String]
// Use the implicit GraphOps.inDegrees operator
val inDegrees: VertexRDD[Int] = graph.inDegrees
</code></pre>
<p>区分核心图操作和<code>GraphOps</code>的原因是为了在将来支持不同的图表示。每个图表示都必须提供核心操作的实现并重用很多定义在<code>GraphOps</code>中的有用操作。</p>
<h2 id="操作一览">操作一览</h2>
<p>一下是定义在<code>Graph</code>和<code>GraphOps</code>中（为了简单起见，表现为图的成员）的功能的快速浏览。注意，某些函数签名已经简化（如默认参数和类型的限制已删除），一些更高级的功能已经被 删除，所以请参阅API文档了解官方的操作列表。</p>
<pre><code class="language-scala">/** Summary of the functionality in the property graph */
class Graph[VD, ED] {
  // Information about the Graph ===================================================================
  val numEdges: Long
  val numVertices: Long
  val inDegrees: VertexRDD[Int]
  val outDegrees: VertexRDD[Int]
  val degrees: VertexRDD[Int]
  // Views of the graph as collections =============================================================
  val vertices: VertexRDD[VD]
  val edges: EdgeRDD[ED]
  val triplets: RDD[EdgeTriplet[VD, ED]]
  // Functions for caching graphs ==================================================================
  def persist(newLevel: StorageLevel = StorageLevel.MEMORY_ONLY): Graph[VD, ED]
  def cache(): Graph[VD, ED]
  def unpersistVertices(blocking: Boolean = true): Graph[VD, ED]
  // Change the partitioning heuristic  ============================================================
  def partitionBy(partitionStrategy: PartitionStrategy): Graph[VD, ED]
  // Transform vertex and edge attributes ==========================================================
  def mapVertices[VD2](map: (VertexID, VD) =&gt; VD2): Graph[VD2, ED]
  def mapEdges[ED2](map: Edge[ED] =&gt; ED2): Graph[VD, ED2]
  def mapEdges[ED2](map: (PartitionID, Iterator[Edge[ED]]) =&gt; Iterator[ED2]): Graph[VD, ED2]
  def mapTriplets[ED2](map: EdgeTriplet[VD, ED] =&gt; ED2): Graph[VD, ED2]
  def mapTriplets[ED2](map: (PartitionID, Iterator[EdgeTriplet[VD, ED]]) =&gt; Iterator[ED2])
    : Graph[VD, ED2]
  // Modify the graph structure ====================================================================
  def reverse: Graph[VD, ED]
  def subgraph(
      epred: EdgeTriplet[VD,ED] =&gt; Boolean = (x =&gt; true),
      vpred: (VertexID, VD) =&gt; Boolean = ((v, d) =&gt; true))
    : Graph[VD, ED]
  def mask[VD2, ED2](other: Graph[VD2, ED2]): Graph[VD, ED]
  def groupEdges(merge: (ED, ED) =&gt; ED): Graph[VD, ED]
  // Join RDDs with the graph ======================================================================
  def joinVertices[U](table: RDD[(VertexID, U)])(mapFunc: (VertexID, VD, U) =&gt; VD): Graph[VD, ED]
  def outerJoinVertices[U, VD2](other: RDD[(VertexID, U)])
      (mapFunc: (VertexID, VD, Option[U]) =&gt; VD2)
    : Graph[VD2, ED]
  // Aggregate information about adjacent triplets =================================================
  def collectNeighborIds(edgeDirection: EdgeDirection): VertexRDD[Array[VertexID]]
  def collectNeighbors(edgeDirection: EdgeDirection): VertexRDD[Array[(VertexID, VD)]]
  def aggregateMessages[Msg: ClassTag](
      sendMsg: EdgeContext[VD, ED, Msg] =&gt; Unit,
      mergeMsg: (Msg, Msg) =&gt; Msg,
      tripletFields: TripletFields = TripletFields.All)
    : VertexRDD[A]
  // Iterative graph-parallel computation ==========================================================
  def pregel[A](initialMsg: A, maxIterations: Int, activeDirection: EdgeDirection)(
      vprog: (VertexID, VD, A) =&gt; VD,
      sendMsg: EdgeTriplet[VD, ED] =&gt; Iterator[(VertexID,A)],
      mergeMsg: (A, A) =&gt; A)
    : Graph[VD, ED]
  // Basic graph algorithms ========================================================================
  def pageRank(tol: Double, resetProb: Double = 0.15): Graph[Double, Double]
  def connectedComponents(): Graph[VertexID, ED]
  def triangleCount(): Graph[Int, ED]
  def stronglyConnectedComponents(numIter: Int): Graph[VertexID, ED]
}
</code></pre>
<h2 id="属性操作">属性操作</h2>
<p>如RDD的<code>map</code>操作一样，属性图包含下面的操作：</p>
<pre><code class="language-scala">class Graph[VD, ED] {
  def mapVertices[VD2](map: (VertexId, VD) =&gt; VD2): Graph[VD2, ED]
  def mapEdges[ED2](map: Edge[ED] =&gt; ED2): Graph[VD, ED2]
  def mapTriplets[ED2](map: EdgeTriplet[VD, ED] =&gt; ED2): Graph[VD, ED2]
}
</code></pre>
<p>每个操作都产生一个新的图，这个新的图包含通过用户自定义的map操作修改后的顶点或边的属性。</p>
<p>注意，每种情况下图结构都不受影响。这些操作的一个重要特征是它允许所得图形重用原有图形的结构索引(indices)。下面的两行代码在逻辑上是等价的，但是第一个不保存结构索引，所以 不会从GraphX系统优化中受益。</p>
<pre><code class="language-scala">val newVertices = graph.vertices.map { case (id, attr) =&gt; (id, mapUdf(id, attr)) }
val newGraph = Graph(newVertices, graph.edges)
</code></pre>
<p>另一种方法是用<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@mapVertices[VD2]((VertexId,VD)⇒VD2)(ClassTag[VD2]):Graph[VD2,ED]">mapVertices</a>保存索引。</p>
<pre><code class="language-scala">val newGraph = graph.mapVertices((id, attr) =&gt; mapUdf(id, attr))
</code></pre>
<p>这些操作经常用来初始化的图形，用作特定计算或者用来处理项目不需要的属性。例如，给定一个图，这个图的顶点特征包含出度，我们为PageRank初始化它。</p>
<pre><code class="language-scala">// Given a graph where the vertex property is the out degree
val inputGraph: Graph[Int, String] =
  graph.outerJoinVertices(graph.outDegrees)((vid, _, degOpt) =&gt; degOpt.getOrElse(0))
// Construct a graph where each edge contains the weight
// and each vertex is the initial PageRank
val outputGraph: Graph[Double, Double] =
  inputGraph.mapTriplets(triplet =&gt; 1.0 / triplet.srcAttr).mapVertices((id, _) =&gt; 1.0)
</code></pre>
<h2 id="结构性操作">结构性操作</h2>
<p>当前的GraphX仅仅支持一组简单的常用结构性操作。下面是基本的结构性操作列表。</p>
<pre><code class="language-scala">class Graph[VD, ED] {
  def reverse: Graph[VD, ED]
  def subgraph(epred: EdgeTriplet[VD,ED] =&gt; Boolean,
               vpred: (VertexId, VD) =&gt; Boolean): Graph[VD, ED]
  def mask[VD2, ED2](other: Graph[VD2, ED2]): Graph[VD, ED]
  def groupEdges(merge: (ED, ED) =&gt; ED): Graph[VD,ED]
}
</code></pre>
<p><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@reverse:Graph[VD,ED]">reverse</a>操作返回一个新的图，这个图的边的方向都是反转的。例如，这个操作可以用来计算反转的PageRank。因为反转操作没有修改顶点或者边的属性或者改变边的数量，所以我们可以 在不移动或者复制数据的情况下有效地实现它。</p>
<p><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@subgraph((EdgeTriplet[VD,ED])⇒Boolean,(VertexId,VD)⇒Boolean):Graph[VD,ED]">subgraph</a>操作 利用顶点和边的谓词（predicates），返回的图仅仅包含满足顶点谓词的顶点、满足边谓词的边以及满足顶点谓词的连接顶点（connect vertices）。<code>subgraph</code>操作可以用于很多场景，如获取 感兴趣的顶点和边组成的图或者获取清除断开链接后的图。下面的例子删除了断开的链接。</p>
<pre><code class="language-scala">// Create an RDD for the vertices
val users: RDD[(VertexId, (String, String))] =
  sc.parallelize(Array((3L, ("rxin", "student")), (7L, ("jgonzal", "postdoc")),
                       (5L, ("franklin", "prof")), (2L, ("istoica", "prof")),
                       (4L, ("peter", "student"))))
// Create an RDD for edges
val relationships: RDD[Edge[String]] =
  sc.parallelize(Array(Edge(3L, 7L, "collab"),    Edge(5L, 3L, "advisor"),
                       Edge(2L, 5L, "colleague"), Edge(5L, 7L, "pi"),
                       Edge(4L, 0L, "student"),   Edge(5L, 0L, "colleague")))
// Define a default user in case there are relationship with missing user
val defaultUser = ("John Doe", "Missing")
// Build the initial Graph
val graph = Graph(users, relationships, defaultUser)
// Notice that there is a user 0 (for which we have no information) connected to users
// 4 (peter) and 5 (franklin).
graph.triplets.map(
    triplet =&gt; triplet.srcAttr._1 + " is the " + triplet.attr + " of " + triplet.dstAttr._1
  ).collect.foreach(println(_))
// Remove missing vertices as well as the edges to connected to them
val validGraph = graph.subgraph(vpred = (id, attr) =&gt; attr._2 != "Missing")
// The valid subgraph will disconnect users 4 and 5 by removing user 0
validGraph.vertices.collect.foreach(println(_))
validGraph.triplets.map(
    triplet =&gt; triplet.srcAttr._1 + " is the " + triplet.attr + " of " + triplet.dstAttr._1
  ).collect.foreach(println(_))
</code></pre>
<p>注意，上面的例子中，仅仅提供了顶点谓词。如果没有提供顶点或者边的谓词，<code>subgraph</code>操作默认为true。</p>
<p><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@mask[VD2,ED2](Graph[VD2,ED2])(ClassTag[VD2],ClassTag[ED2]):Graph[VD,ED]">mask</a>操作 构造一个子图，这个子图包含输入图中包含的顶点和边。这个操作可以和<code>subgraph</code>操作相结合，基于另外一个相关图的特征去约束一个图。例如，我们可能利用缺失顶点的图运行连通体（？连通组件connected components），然后返回有效的子图。</p>
<pre><code class="language-scala">/ Run Connected Components
val ccGraph = graph.connectedComponents() // No longer contains missing field
// Remove missing vertices as well as the edges to connected to them
val validGraph = graph.subgraph(vpred = (id, attr) =&gt; attr._2 != "Missing")
// Restrict the answer to the valid subgraph
val validCCGraph = ccGraph.mask(validGraph)
</code></pre>
<p><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@groupEdges((ED,ED)⇒ED):Graph[VD,ED]">groupEdges</a>操作合并多重图 中的并行边(如顶点对之间重复的边)。在大量的应用程序中，并行的边可以合并（它们的权重合并）为一条边从而降低图的大小。</p>
<h2 id="连接操作">连接操作</h2>
<p>在许多情况下，有必要将外部数据加入到图中。例如，我们可能有额外的用户属性需要合并到已有的图中或者我们可能想从一个图中取出顶点特征加入到另外一个图中。这些任务可以用join操作完成。 下面列出的是主要的join操作。</p>
<pre><code class="language-scala">class Graph[VD, ED] {
  def joinVertices[U](table: RDD[(VertexId, U)])(map: (VertexId, VD, U) =&gt; VD)
    : Graph[VD, ED]
  def outerJoinVertices[U, VD2](table: RDD[(VertexId, U)])(map: (VertexId, VD, Option[U]) =&gt; VD2)
    : Graph[VD2, ED]
}
</code></pre>
<p><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.GraphOps@joinVertices[U](RDD[(VertexId,U)])((VertexId,VD,U)⇒VD)(ClassTag[U]):Graph[VD,ED]">joinVertices</a> 操作将输入RDD和顶点相结合，返回一个新的带有顶点特征的图。这些特征是通过在连接顶点的结果上使用用户定义的<code>map</code>函数获得的。在RDD中没有匹配值的顶点保留其原始值。</p>
<p>注意，对于给定的顶点，如果RDD中有超过1个的匹配值，则仅仅使用其中的一个。建议用下面的方法保证输入RDD的唯一性。下面的方法也会预索引返回的值用以加快后续的join操作。</p>
<pre><code class="language-scala">val nonUniqueCosts: RDD[(VertexID, Double)]
val uniqueCosts: VertexRDD[Double] =
  graph.vertices.aggregateUsingIndex(nonUnique, (a,b) =&gt; a + b)
val joinedGraph = graph.joinVertices(uniqueCosts)(
  (id, oldCost, extraCost) =&gt; oldCost + extraCost)
</code></pre>
<p>除了将用户自定义的map函数用到所有顶点和改变顶点属性类型以外，更一般的<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@outerJoinVertices[U,VD2](RDD[(VertexId,U)])((VertexId,VD,Option[U])⇒VD2)(ClassTag[U],ClassTag[VD2]):Graph[VD2,ED]">outerJoinVertices</a>与<code>joinVertices</code>类似。 因为并不是所有顶点在RDD中拥有匹配的值，map函数需要一个option类型。</p>
<pre><code class="language-scala">val outDegrees: VertexRDD[Int] = graph.outDegrees
val degreeGraph = graph.outerJoinVertices(outDegrees) { (id, oldAttr, outDegOpt) =&gt;
  outDegOpt match {
    case Some(outDeg) =&gt; outDeg
    case None =&gt; 0 // No outDegree means zero outDegree
  }
}
</code></pre>
<p>你可能已经注意到了，在上面的例子中用到了curry函数的多参数列表。虽然我们可以将f(a)(b)写成f(a,b)，但是f(a,b)意味着b的类型推断将不会依赖于a。因此，用户需要为定义 的函数提供类型标注。</p>
<pre><code class="language-scala">val joinedGraph = graph.joinVertices(uniqueCosts,
  (id: VertexID, oldCost: Double, extraCost: Double) =&gt; oldCost + extraCost)
</code></pre>
<h2 id="相邻聚合neighborhood-aggregation">相邻聚合（Neighborhood Aggregation）</h2>
<p>图分析任务的一个关键步骤是汇总每个顶点附近的信息。例如我们可能想知道每个用户的追随者的数量或者每个用户的追随者的平均年龄。许多迭代图算法（如PageRank，最短路径和连通体） 多次聚合相邻顶点的属性。</p>
<p>为了提高性能，主要的聚合操作从<code>graph.mapReduceTriplets</code>改为了新的<code>graph.AggregateMessages</code>。虽然API的改变相对较小，但是我们仍然提供了过渡的指南。</p>
<h3 id="聚合消息aggregatemessages">聚合消息(aggregateMessages)</h3>
<p>GraphX中的核心聚合操作是<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@aggregateMessages[A]((EdgeContext[VD,ED,A])⇒Unit,(A,A)⇒A,TripletFields)(ClassTag[A]):VertexRDD[A]">aggregateMessages</a>。 这个操作将用户定义的<code>sendMsg</code>函数应用到图的每个边三元组(edge triplet)，然后应用<code>mergeMsg</code>函数在其目的顶点聚合这些消息。</p>
<pre><code class="language-scala">class Graph[VD, ED] {
  def aggregateMessages[Msg: ClassTag](
      sendMsg: EdgeContext[VD, ED, Msg] =&gt; Unit,
      mergeMsg: (Msg, Msg) =&gt; Msg,
      tripletFields: TripletFields = TripletFields.All)
    : VertexRDD[Msg]
}
</code></pre>
<p>用户自定义的<code>sendMsg</code>函数是一个<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.EdgeContext">EdgeContext</a>类型。它暴露源和目的属性以及边缘属性 以及发送消息给源和目的属性的函数(<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.EdgeContext@sendToSrc(msg:A):Unit">sendToSrc</a>和<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.EdgeContext@sendToDst(msg:A):Unit">sendToDst</a>)。 可将<code>sendMsg</code>函数看做map-reduce过程中的map函数。用户自定义的<code>mergeMsg</code>函数指定两个消息到相同的顶点并保存为一个消息。可以将<code>mergeMsg</code>函数看做map-reduce过程中的reduce函数。 <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@aggregateMessages[A]((EdgeContext[VD,ED,A])⇒Unit,(A,A)⇒A,TripletFields)(ClassTag[A]):VertexRDD[A]">aggregateMessages</a> 操作返回一个包含聚合消息(目的地为每个顶点)的<code>VertexRDD[Msg]</code>。没有接收到消息的顶点不包含在返回的<code>VertexRDD</code>中。</p>
<p>另外，<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@aggregateMessages[A]((EdgeContext[VD,ED,A])⇒Unit,(A,A)⇒A,TripletFields)(ClassTag[A]):VertexRDD[A]">aggregateMessages</a> 有一个可选的<code>tripletFields</code>参数，它指出在<code>EdgeContext</code>中，哪些数据被访问（如源顶点特征而不是目的顶点特征）。<code>tripletsFields</code>可能的选项定义在<a href="http://spark.apache.org/docs/latest/api/java/org/apache/spark/graphx/TripletFields.html">TripletFields</a>中。 <code>tripletFields</code>参数用来通知GraphX仅仅只需要<code>EdgeContext</code>的一部分允许GraphX选择一个优化的连接策略。例如，如果我们想计算每个用户的追随者的平均年龄，我们仅仅只需要源字段。 所以我们用<code>TripletFields.Src</code>表示我们仅仅只需要源字段。</p>
<p>在下面的例子中，我们用<code>aggregateMessages</code>操作计算每个用户更年长的追随者的年龄。</p>
<pre><code class="language-scala">// Import random graph generation library
import org.apache.spark.graphx.util.GraphGenerators
// Create a graph with "age" as the vertex property.  Here we use a random graph for simplicity.
val graph: Graph[Double, Int] =
  GraphGenerators.logNormalGraph(sc, numVertices = 100).mapVertices( (id, _) =&gt; id.toDouble )
// Compute the number of older followers and their total age
val olderFollowers: VertexRDD[(Int, Double)] = graph.aggregateMessages[(Int, Double)](
  triplet =&gt; { // Map Function
    if (triplet.srcAttr &gt; triplet.dstAttr) {
      // Send message to destination vertex containing counter and age
      triplet.sendToDst(1, triplet.srcAttr)
    }
  },
  // Add counter and age
  (a, b) =&gt; (a._1 + b._1, a._2 + b._2) // Reduce Function
)
// Divide total age by number of older followers to get average age of older followers
val avgAgeOfOlderFollowers: VertexRDD[Double] =
  olderFollowers.mapValues( (id, value) =&gt; value match { case (count, totalAge) =&gt; totalAge / count } )
// Display the results
avgAgeOfOlderFollowers.collect.foreach(println(_))
</code></pre>
<p>当消息（以及消息的总数）是常量大小(列表和连接替换为浮点数和添加)时，<code>aggregateMessages</code>操作的效果最好。</p>
<h3 id="map-reduce三元组过渡指南">Map Reduce三元组过渡指南</h3>
<p>在之前版本的GraphX中，利用[mapReduceTriplets]操作完成相邻聚合。</p>
<pre><code class="language-scala">class Graph[VD, ED] {
  def mapReduceTriplets[Msg](
      map: EdgeTriplet[VD, ED] =&gt; Iterator[(VertexId, Msg)],
      reduce: (Msg, Msg) =&gt; Msg)
    : VertexRDD[Msg]
}
</code></pre>
<p><code>mapReduceTriplets</code>操作在每个三元组上应用用户定义的map函数，然后保存用用户定义的reduce函数聚合的消息。然而，我们发现用户返回的迭代器是昂贵的，它抑制了我们添加额外优化(例如本地顶点的重新编号)的能力。 <a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.Graph@aggregateMessages[A]((EdgeContext[VD,ED,A])⇒Unit,(A,A)⇒A,TripletFields)(ClassTag[A]):VertexRDD[A]">aggregateMessages</a> 暴露三元组字段和函数显示的发送消息到源和目的顶点。并且，我们删除了字节码检测转而需要用户指明三元组的哪些字段实际需要。</p>
<p>下面的代码用到了<code>mapReduceTriplets</code></p>
<pre><code class="language-scala">val graph: Graph[Int, Float] = ...
def msgFun(triplet: Triplet[Int, Float]): Iterator[(Int, String)] = {
  Iterator((triplet.dstId, "Hi"))
}
def reduceFun(a: Int, b: Int): Int = a + b
val result = graph.mapReduceTriplets[String](msgFun, reduceFun)
</code></pre>
<p>下面的代码用到了<code>aggregateMessages</code></p>
<pre><code class="language-scala">val graph: Graph[Int, Float] = ...
def msgFun(triplet: EdgeContext[Int, Float, String]) {
  triplet.sendToDst("Hi")
}
def reduceFun(a: Int, b: Int): Int = a + b
val result = graph.aggregateMessages[String](msgFun, reduceFun)
</code></pre>
<h3 id="计算度信息">计算度信息</h3>
<p>最一般的聚合任务就是计算顶点的度，即每个顶点相邻边的数量。在有向图中，经常需要知道顶点的入度、出度以及总共的度。<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.GraphOps">GraphOps</a> 类包含一个操作集合用来计算每个顶点的度。例如，下面的例子计算最大的入度、出度和总度。</p>
<pre><code class="language-scala">// Define a reduce operation to compute the highest degree vertex
def max(a: (VertexId, Int), b: (VertexId, Int)): (VertexId, Int) = {
  if (a._2 &gt; b._2) a else b
}
// Compute the max degrees
val maxInDegree: (VertexId, Int)  = graph.inDegrees.reduce(max)
val maxOutDegree: (VertexId, Int) = graph.outDegrees.reduce(max)
val maxDegrees: (VertexId, Int)   = graph.degrees.reduce(max)
</code></pre>
<h3 id="collecting-neighbors">Collecting Neighbors</h3>
<p>在某些情况下，通过收集每个顶点相邻的顶点及它们的属性来表达计算可能更容易。这可以通过<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.GraphOps@collectNeighborIds(EdgeDirection):VertexRDD[Array[VertexId]]">collectNeighborIds</a> 和<a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.graphx.GraphOps@collectNeighbors(EdgeDirection):VertexRDD[Array[(VertexId,VD)]]">collectNeighbors</a>操作来简单的完成</p>
<pre><code class="language-scala">class GraphOps[VD, ED] {
  def collectNeighborIds(edgeDirection: EdgeDirection): VertexRDD[Array[VertexId]]
  def collectNeighbors(edgeDirection: EdgeDirection): VertexRDD[ Array[(VertexId, VD)] ]
}
</code></pre>
<p>这些操作是非常昂贵的，因为它们需要重复的信息和大量的通信。如果可能，尽量用<code>aggregateMessages</code>操作直接表达相同的计算。</p>
<h3 id="缓存和不缓存">缓存和不缓存</h3>
<p>在Spark中，RDDs默认是不缓存的。为了避免重复计算，当需要多次利用它们时，我们必须显示地缓存它们。GraphX中的图也有相同的方式。当利用到图多次时，确保首先访问<code>Graph.cache()</code>方法。</p>
<p>在迭代计算中，为了获得最佳的性能，不缓存可能是必须的。默认情况下，缓存的RDDs和图会一直保留在内存中直到因为内存压力迫使它们以LRU的顺序删除。对于迭代计算，先前的迭代的中间结果将填充到缓存 中。虽然它们最终会被删除，但是保存在内存中的不需要的数据将会减慢垃圾回收。只有中间结果不需要，不缓存它们是更高效的。这涉及到在每次迭代中物化一个图或者RDD而不缓存所有其它的数据集。 在将来的迭代中仅用物化的数据集。然而，因为图是由多个RDD组成的，正确的不持久化它们是困难的。对于迭代计算，我们建议使用Pregel API，它可以正确的不持久化中间结果。</p>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/120/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/spark_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/120/index.html">Openstack用户指南（简体中文版）</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/62.html">tzivanmoe</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="spark">spark</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">47页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月1日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/122/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/spark_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/122/index.html">Databricks Spark 知识库简体中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/62.html">tzivanmoe</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="spark">spark</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">15页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月1日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1个">1</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/141/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/141/index.html">各种程序开发相关的Awesome开源项目清单</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/74.html">sindresorhus</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">25页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年3月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 102911个">102911</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/42/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/docker_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/42/index.html">Docker-從入門到實踐</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/22.html">jasonblog</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="docker">docker</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">82页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月30日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1个">1</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/157/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/machine-learning_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/157/index.html">吴恩达cs229</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/89.html">jiacheng-pan</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="machine-learning">machine-learning</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">15页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月12日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/60/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/react_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/60/index.html">React 入门教程</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/36.html">hulufei</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="react">react</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">23页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月5日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 328个">328</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../../" title="返回首页"><img class="" src="../../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../../book/106/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../../book/106/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../../book/106/README.html" title="Introduction" data-book-page-rel-url="README.html" data-book-page-id="7668">Introduction</a>
</li>
<li>
<a class="pjax" href="../../../book/106/quick-start/README.html" title="快速上手" data-book-page-rel-url="quick-start/README.html" data-book-page-id="7669">快速上手</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/quick-start/using-spark-shell.html" title="Spark Shell" data-book-page-rel-url="quick-start/using-spark-shell.html" data-book-page-id="7670">Spark Shell</a>
</li>
<li>
<a class="pjax" href="../../../book/106/quick-start/standalone-applications.html" title="独立应用程序" data-book-page-rel-url="quick-start/standalone-applications.html" data-book-page-id="7671">独立应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/106/quick-start/where-to-go-from-here.html" title="开始翻滚吧!" data-book-page-rel-url="quick-start/where-to-go-from-here.html" data-book-page-id="7672">开始翻滚吧!</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/README.html" title="编程指南" data-book-page-rel-url="programming-guide/README.html" data-book-page-id="7673">编程指南</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/programming-guide/linking-with-spark.html" title="引入 Spark" data-book-page-rel-url="programming-guide/linking-with-spark.html" data-book-page-id="7674">引入 Spark</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/initializing-spark.html" title="初始化 Spark" data-book-page-rel-url="programming-guide/initializing-spark.html" data-book-page-id="7675">初始化 Spark</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/README.html" title="Spark RDDs" data-book-page-rel-url="programming-guide/rdds/README.html" data-book-page-id="7676">Spark RDDs</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/parallelized-collections.html" title="并行集合" data-book-page-rel-url="programming-guide/rdds/parallelized-collections.html" data-book-page-id="7677">并行集合</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/external-datasets.html" title="外部数据集" data-book-page-rel-url="programming-guide/rdds/external-datasets.html" data-book-page-id="7678">外部数据集</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/rdd-operations.html" title="RDD 操作" data-book-page-rel-url="programming-guide/rdds/rdd-operations.html" data-book-page-id="7679">RDD 操作</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/passing-functions-to-spark.html" title="传递函数到 Spark" data-book-page-rel-url="programming-guide/rdds/passing-functions-to-spark.html" data-book-page-id="7680">传递函数到 Spark</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/working-with-key-value-pairs.html" title="使用键值对" data-book-page-rel-url="programming-guide/rdds/working-with-key-value-pairs.html" data-book-page-id="7681">使用键值对</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/transformations.html" title="Transformations" data-book-page-rel-url="programming-guide/rdds/transformations.html" data-book-page-id="7682">Transformations</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/actions.html" title="Actions" data-book-page-rel-url="programming-guide/rdds/actions.html" data-book-page-id="7683">Actions</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/rdd-persistences.html" title="RDD持久化" data-book-page-rel-url="programming-guide/rdds/rdd-persistences.html" data-book-page-id="7684">RDD持久化</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/shared-variables.html" title="共享变量" data-book-page-rel-url="programming-guide/shared-variables.html" data-book-page-id="7685">共享变量</a>
</li>
<li>
<a class="pjax" href="../../../book/106/programming-guide/from-here.html" title="从这里开始" data-book-page-rel-url="programming-guide/from-here.html" data-book-page-id="7686">从这里开始</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/README.html" title="Spark Streaming" data-book-page-rel-url="spark-streaming/README.html" data-book-page-id="7687">Spark Streaming</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/a-quick-example.html" title="一个快速的例子" data-book-page-rel-url="spark-streaming/a-quick-example.html" data-book-page-id="7688">一个快速的例子</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/README.html" title="基本概念" data-book-page-rel-url="spark-streaming/basic-concepts/README.html" data-book-page-id="7689">基本概念</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/linking.html" title="关联" data-book-page-rel-url="spark-streaming/basic-concepts/linking.html" data-book-page-id="7690">关联</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/initializing-StreamingContext.html" title="初始化StreamingContext" data-book-page-rel-url="spark-streaming/basic-concepts/initializing-StreamingContext.html" data-book-page-id="7691">初始化StreamingContext</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/discretized-streams.html" title="离散流" data-book-page-rel-url="spark-streaming/basic-concepts/discretized-streams.html" data-book-page-id="7692">离散流</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/input-DStreams.html" title="输入DStreams" data-book-page-rel-url="spark-streaming/basic-concepts/input-DStreams.html" data-book-page-id="7693">输入DStreams</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/transformations-on-DStreams.html" title="DStream中的转换" data-book-page-rel-url="spark-streaming/basic-concepts/transformations-on-DStreams.html" data-book-page-id="7694">DStream中的转换</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/output-operations-on-DStreams.html" title="DStream的输出操作" data-book-page-rel-url="spark-streaming/basic-concepts/output-operations-on-DStreams.html" data-book-page-id="7695">DStream的输出操作</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/caching-persistence.html" title="缓存或持久化" data-book-page-rel-url="spark-streaming/basic-concepts/caching-persistence.html" data-book-page-id="7696">缓存或持久化</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/checkpointing.html" title="Checkpointing" data-book-page-rel-url="spark-streaming/basic-concepts/checkpointing.html" data-book-page-id="7697">Checkpointing</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/deploying-applications.html" title="部署应用程序" data-book-page-rel-url="spark-streaming/basic-concepts/deploying-applications.html" data-book-page-id="7698">部署应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/basic-concepts/monitoring-applications.html" title="监控应用程序" data-book-page-rel-url="spark-streaming/basic-concepts/monitoring-applications.html" data-book-page-id="7699">监控应用程序</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/performance-tuning/README.html" title="性能调优" data-book-page-rel-url="spark-streaming/performance-tuning/README.html" data-book-page-id="7700">性能调优</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/performance-tuning/reducing-processing-time.html" title="减少批数据的执行时间" data-book-page-rel-url="spark-streaming/performance-tuning/reducing-processing-time.html" data-book-page-id="7701">减少批数据的执行时间</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/performance-tuning/setting-right-batch-size.html" title="设置正确的批容量" data-book-page-rel-url="spark-streaming/performance-tuning/setting-right-batch-size.html" data-book-page-id="7702">设置正确的批容量</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/performance-tuning/memory-tuning.html" title="内存调优" data-book-page-rel-url="spark-streaming/performance-tuning/memory-tuning.html" data-book-page-id="7703">内存调优</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-streaming/fault-tolerance-semantics/README.html" title="容错语义" data-book-page-rel-url="spark-streaming/fault-tolerance-semantics/README.html" data-book-page-id="7704">容错语义</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/README.html" title="Spark SQL" data-book-page-rel-url="spark-sql/README.html" data-book-page-id="7705">Spark SQL</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/spark-sql/getting-started.html" title="开始" data-book-page-rel-url="spark-sql/getting-started.html" data-book-page-id="7706">开始</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/data-sources/README.html" title="数据源" data-book-page-rel-url="spark-sql/data-sources/README.html" data-book-page-id="7707">数据源</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/spark-sql/data-sources/rdds.html" title="RDDs" data-book-page-rel-url="spark-sql/data-sources/rdds.html" data-book-page-id="7708">RDDs</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/data-sources/parquet-files.html" title="parquet文件" data-book-page-rel-url="spark-sql/data-sources/parquet-files.html" data-book-page-id="7709">parquet文件</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/data-sources/jSON-datasets.html" title="JSON数据集" data-book-page-rel-url="spark-sql/data-sources/jSON-datasets.html" data-book-page-id="7710">JSON数据集</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/data-sources/hive-tables.html" title="Hive表" data-book-page-rel-url="spark-sql/data-sources/hive-tables.html" data-book-page-id="7711">Hive表</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/performance-tuning.html" title="性能调优" data-book-page-rel-url="spark-sql/performance-tuning.html" data-book-page-id="7712">性能调优</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/other-sql-interfaces.html" title="其它SQL接口" data-book-page-rel-url="spark-sql/other-sql-interfaces.html" data-book-page-id="7713">其它SQL接口</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/writing-language-integrated-relational-queries.html" title="编写语言集成(Language-Integrated)的相关查询" data-book-page-rel-url="spark-sql/writing-language-integrated-relational-queries.html" data-book-page-id="7714">编写语言集成(Language-Integrated)的相关查询</a>
</li>
<li>
<a class="pjax" href="../../../book/106/spark-sql/spark-sql-dataType-reference.html" title="Spark SQL数据类型" data-book-page-rel-url="spark-sql/spark-sql-dataType-reference.html" data-book-page-id="7715">Spark SQL数据类型</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/README.html" title="GraphX编程指南" data-book-page-rel-url="graphx-programming-guide/README.html" data-book-page-id="7716">GraphX编程指南</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/getting-started.html" title="开始" data-book-page-rel-url="graphx-programming-guide/getting-started.html" data-book-page-id="7717">开始</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/property-graph.html" title="属性图" data-book-page-rel-url="graphx-programming-guide/property-graph.html" data-book-page-id="7718">属性图</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/graph-operators.html" title="图操作符" data-book-page-rel-url="graphx-programming-guide/graph-operators.html" data-book-page-id="7719">图操作符</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/pregel-api.html" title="Pregel API" data-book-page-rel-url="graphx-programming-guide/pregel-api.html" data-book-page-id="7720">Pregel API</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/graph-builders.html" title="图构造者" data-book-page-rel-url="graphx-programming-guide/graph-builders.html" data-book-page-id="7721">图构造者</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/vertex-and-edge-rdds.html" title="顶点和边RDDs" data-book-page-rel-url="graphx-programming-guide/vertex-and-edge-rdds.html" data-book-page-id="7722">顶点和边RDDs</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/graph-algorithms.html" title="图算法" data-book-page-rel-url="graphx-programming-guide/graph-algorithms.html" data-book-page-id="7723">图算法</a>
</li>
<li>
<a class="pjax" href="../../../book/106/graphx-programming-guide/examples.html" title="例子" data-book-page-rel-url="graphx-programming-guide/examples.html" data-book-page-id="7724">例子</a>
</li>
<li>
<a class="pjax" href="../../../book/106/deploying/submitting-applications.html" title="提交应用程序" data-book-page-rel-url="deploying/submitting-applications.html" data-book-page-id="7725">提交应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/106/deploying/spark-standalone-mode.html" title="独立运行Spark" data-book-page-rel-url="deploying/spark-standalone-mode.html" data-book-page-id="7726">独立运行Spark</a>
</li>
<li>
<a class="pjax" href="../../../book/106/deploying/running-spark-on-yarn.html" title="在yarn上运行Spark" data-book-page-rel-url="deploying/running-spark-on-yarn.html" data-book-page-id="7727">在yarn上运行Spark</a>
</li>
<li>
<a class="pjax" href="../../../book/106/more/spark-configuration.html" title="Spark配置" data-book-page-rel-url="more/spark-configuration.html" data-book-page-id="7728">Spark配置</a>
<ul>
<li>
<a class="pjax" href="../../../book/106/programming-guide/rdds/rdd_persistence.html" title="RDD 持久化" data-book-page-rel-url="programming-guide/rdds/rdd_persistence.html" data-book-page-id="7729">RDD 持久化</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =106;var bookPageId =7719;var bookPageRelUrl ='graphx-programming-guide/graph-operators.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>