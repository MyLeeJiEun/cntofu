
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明-Office 365 开发入门指南</title>
<meta content='掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明,Office 365 开发入门指南' name='keywords'>
<meta content='掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明,Office 365 开发入门指南' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../../static/components/css/base.css">
<link rel="stylesheet" href="../../../static/components/css/reader.css">
<link rel="stylesheet" href="../../../static/components/css/markdown.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../../book/131/docs/chinaoffice365applicationregisteration.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">注册中国版Micros..</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../../book/131/docs/desktopapplication.html">
<span class="">Microsoft G..</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../../book/131/index.html">Office 365 开发入门指南</a>
<a target="_blank" rel="nofollow" href="https://github.com/chenxizhang/office365dev" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  md-content-section  uk-margin-bottom">
<h1 id="掀起azure-ad的盖头来深入理解microsoft-graph应用程序和服务权限声明">掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明</h1>
<blockquote>
<p>作者：陈希章 发表于 2017年7月12日</p>
</blockquote>
<h2 id="引子">引子</h2>
<p>这是一篇计划外的文章。我们都知道要进行Microsoft Graph的开发的话，需要进行应用程序注册。这个在此前我已经有专门的文章写过了。但这里存在一个小的问题：国内版的Office 365在申请好之后，并没有像国际版那样，有一个对应的可以注册和管理应用程序的Azure的界面。说起来有点绕，国际版的Office 365管理员可以直接登陆到portal.azure.com进行应用程序注册和管理，但国内版却不行。这个问题目前来说还是一个know issue。不过，在帮助一些客户解决这个问题的过程中，我们也有一些变通的做法，例如我下面的这篇文章就是摘自于世纪互联技术支持的标准做法。</p>
<p><a href="http://www.cnblogs.com/chenxizhang/p/6010139.html">国内版Office 365和Azure AAD绑定的问题及解决方案</a></p>
<p>上述方案中建议客户要另外在购买一个Azure AD的订阅，然后可以跟Office 365那个Tenant绑定起来。这个从一定程度上解决了问题，但不是那么完美。本文给大家分享的是我们另外研究出来的一些经验做法。</p>
<h2 id="理解office-365与azure-ad的关系">理解Office 365与Azure AD的关系</h2>
<p>从逻辑上说，Azure是微软的智能云平台，在这个平台上，不光是运行了全球不计其数的客户的应用程序，也承载着包括Office 365在内的规模庞大的一些SaaS平台。而Office 365的用户管理和应用管理，本质上就是用Azure AD来实现的。当然，国外的版本，Azure AD还可以做到更多，包括组织配置文件、设备管理、按条件的访问控制等等。限于篇幅，本文不对这些高级功能进行展开，我们仅仅针对用户管理和应用管理，尤其是应用管理这块来一探究竟。</p>
<blockquote>
<p>本文的例子，因为主要是要演示如何解决国内版的问题，所以截图全部采用国内版Office 365或者Azure 请注意，登陆国内版本的Azure，有两种方式，一种是传统门户(manage.windowsazure.cn)，一种是新门户（portal.azure.cn)。新门户毫无疑问带来了一些新的功能，例如支持使用最新的Resource Management的方式创建和管理资源。但是，要进行Azure AD的操作的话，目前还只能在传统门户中进行</p>
</blockquote>
<p><a href="https://img.cntofu.com/book/office365dev/docs/images/azureadportal.png" data-uk-lightbox><img src="https://img.cntofu.com/book/office365dev/docs/images/azureadportal.png" alt=""></a></p>
<p>这就是我们喜闻乐见的Azure AD管理界面，用户管理不用多说了，这里可以增加和删除用户，修改用户的一些基本信息。我们重点关注的是应用管理的这个部分。</p>
<p><a href="https://img.cntofu.com/book/office365dev/docs/images/azureadapplicationportal.png" data-uk-lightbox><img src="https://img.cntofu.com/book/office365dev/docs/images/azureadapplicationportal.png" alt=""></a></p>
<p>稍微简单地回顾一下相关的概念，注册应用程序（application）有两种不同类型（本机或者Web），除了提供一些基本信息（对于Web应用程序而言，关键一点在于提供ReplyUrl）之外，最重要的就是定义该应用程序需要访问的资源，以及申请的权限了。资源，在Azure AD内部的技术范畴来说，是较为ServicePrinciple的一个对象，而所谓的权限，又分为两种，一种是delegated permission，一种是application permission。前者也称为oauth权限，这是需要用户授权，并且模拟用户的身份去进行操作，适合于一些有用户交互的应用程序，而后者（也称为role权限）则适合于一些在后台运行的服务或者自动运行的脚本。</p>
<p><a href="https://img.cntofu.com/book/office365dev/docs/images/azureadapppermission.png" data-uk-lightbox><img src="https://img.cntofu.com/book/office365dev/docs/images/azureadapppermission.png" alt=""></a></p>
<p>必须承认，就算是有图形化界面，要完全理解上面这些东西也多少需要一定的时间。与此同时，如果我们连图形化界面都没有的话，怎么来创建应用程序并且为其申请相关资源的权限呢，这有点挑战，但是谢天谢地，我们还是找到了一些方法。</p>
<h2 id="通过powershell来创建应用程序并且定义服务和权限声明">通过PowerShell来创建应用程序并且定义服务和权限声明</h2>
<p>我旗帜鲜明地喜欢PowerShell，尤其是用来管理Azure AD以及Office 365的时候，它总是能让我们事半功倍。为了演示下面的功能，我需要提醒你准备如下的软件环境。</p>
<p>请在Windows 10的机器上面，安装如下的几个组件</p>
<ol>
<li>下载安装官方提供的Microsoft Online Service Sign-in Assistant for IT Professionals https://go.microsoft.com/fwlink/p/?LinkId=286152</li>
<li>下载安装官方提供的Azure Active Directory Connection http://connect.microsoft.com/site1164/Downloads/DownloadDetails.aspx?DownloadID=59185</li>
<li>请在本地用管理员身份打开PowerShell，并运行命令 Install-Module -Name AzureAD</li>
</ol>
<blockquote>
<p>当然，你还得需要有一个Office 365 的管理员账号信息</p>
</blockquote>
<p>为了验证你是否安装成功如上的组件，请重新打开一个PowerShell窗口，运行下面的命令</p>
<pre><code>$credential = Get-Credential
# 此时会弹出一个登陆框，请输入Office 365管理员和密码信息，如果没有错误请继续

Connect-AzureAD -Credential $credential -AzureEnvironmentName AzureChinaCloud
# 如果没有错误请继续
Get-AzureADApplication

</code></pre>
<h2 id="查询所有的服务定义信息">查询所有的服务定义信息</h2>
<p>我们需要通过脚本获取到当前这个Azure AD中已经定义好的服务信息</p>
<pre><code>Get-AzureADServicePrincipal
</code></pre>
<p>正常情况下将返回下面的结果</p>
<table>
<thead>
<tr>
<th>ObjectId</th>
<th>AppId</th>
<th>DisplayName</th>
</tr>
</thead>
<tbody>
<tr>
<td>06d6e7e4-dcb4-4783-a617-78d89bb584f3</td>
<td>0000000f-0000-0000-c000-000000000000</td>
<td>Microsoft.Azure.GraphExplorer</td>
</tr>
<tr>
<td>0a80ca08-a6b5-42d9-91a3-1a93c6c25b05</td>
<td>43e38210-29b3-411d-b9f7-4a75b5fd2786</td>
<td>工作流</td>
</tr>
<tr>
<td>0f6b73aa-9a6d-4c25-b518-5aef795042d6</td>
<td>00000002-0000-0ff1-ce00-000000000000</td>
<td>Office 365 Exchange Online</td>
</tr>
<tr>
<td>13fc1a89-6a58-406a-9cb2-42e92c458fd3</td>
<td>aa9ecb1e-fd53-4aaa-a8fe-7a54de2c1334</td>
<td>Office 365 Configure</td>
</tr>
<tr>
<td>1a17c404-11db-442b-93ae-e0751e1563b7</td>
<td>00000007-0000-0ff1-ce00-000000000000</td>
<td>Microsoft.ExchangeOnlineProtection</td>
</tr>
<tr>
<td>224fdbf8-fbe8-4d54-b98e-f8b9ad15cac8</td>
<td>00000005-0000-0000-c000-000000000000</td>
<td>Microsoft.Azure.Workflow</td>
</tr>
<tr>
<td>26df55ee-6a90-4a17-879c-1a982094512c</td>
<td>00000009-0000-0000-c000-000000000000</td>
<td>Power BI Service</td>
</tr>
<tr>
<td>2ab85e47-1ba1-4948-9a95-f16eef6215aa</td>
<td>00000003-0000-0ff1-ce00-000000000000</td>
<td>Office 365 SharePoint Online</td>
</tr>
<tr>
<td>30236da4-3a49-4615-bb09-d665e5938602</td>
<td>181dc382-d034-45ad-b7d7-4f440986737b</td>
<td>sample</td>
</tr>
<tr>
<td>30ee19e0-47bd-4a3d-8e2b-3752f02d4ffc</td>
<td>2d4d3d8e-2be3-4bef-9f87-7875a61c29de</td>
<td>OneNote</td>
</tr>
<tr>
<td>3319d71d-8dfc-42ff-8fa0-0aa64f553350</td>
<td>00000003-0000-0000-c000-000000000000</td>
<td>Microsoft Graph</td>
</tr>
<tr>
<td>348ecf66-4f9c-4ec5-8db4-c86171859ea5</td>
<td>c5393580-f805-4401-95e8-94b7a6ef2fc2</td>
<td>Office 365 Management APIs</td>
</tr>
<tr>
<td>465b5392-ee37-4d69-be91-dad28b5fb77a</td>
<td>00000004-0000-0ff1-ce00-000000000000</td>
<td>Office 365 Lync Online</td>
</tr>
<tr>
<td>465eec3f-9bcd-4c27-b071-780b86f01083</td>
<td>0000000c-0000-0000-c000-000000000000</td>
<td>Microsoft.Azure.ActiveDirectoryUX</td>
</tr>
<tr>
<td>4ba6a93c-053e-4575-83aa-419fcc7cadb5</td>
<td>c84c5f13-394f-4807-9a35-317cffa11143</td>
<td>工作流</td>
</tr>
<tr>
<td>4fa14876-02c2-4089-a450-2b8b45d17ae0</td>
<td>00000002-0000-0000-c000-000000000000</td>
<td>Windows Azure Active Directory</td>
</tr>
<tr>
<td>524c2aaa-6ca4-4db5-9876-b758bbd4d6c7</td>
<td>8d3a7d3c-c034-4f19-a2ef-8412952a9671</td>
<td>MicrosoftOffice</td>
</tr>
<tr>
<td>6226889d-694d-4ee0-8717-0997c544b94e</td>
<td>ab27a73e-a3ba-4e43-8360-8bcc717114d8</td>
<td>Microsoft.OfficeModernCalendar</td>
</tr>
<tr>
<td>63246e22-5673-4665-9744-e33f18aceaf3</td>
<td>aa2cd2a1-5a04-4e64-b76a-0a0f21e9d1d9</td>
<td>webappsample123</td>
</tr>
<tr>
<td>67749e7c-7d67-4338-abdd-82f13ff22010</td>
<td>00000006-0000-0ff1-ce00-000000000000</td>
<td>Microsoft.Office365Portal</td>
</tr>
<tr>
<td>6de0d20c-2b7f-4aed-803c-f3157018b59b</td>
<td>00000013-0000-0000-c000-000000000000</td>
<td>Windows Azure Management Portal</td>
</tr>
<tr>
<td>72f64ca3-d200-423b-92da-4f3dd6621ef9</td>
<td>1142d051-c271-4044-b1ac-522c8029e3b7</td>
<td>websampletest</td>
</tr>
<tr>
<td>76c56681-2887-4cd4-a375-971669f0d471</td>
<td>8fca0a66-c008-4564-a876-ab3ae0fd5cff</td>
<td>Microsoft.SMIT</td>
</tr>
<tr>
<td>778437c2-766d-4853-8738-2f397efeae06</td>
<td>0f698dd4-f011-4d23-a33e-b36416dcb1e6</td>
<td>OfficeClientService</td>
</tr>
<tr>
<td>793601bf-1a81-400d-bb7d-68db352702c5</td>
<td>ae675dd6-076c-4036-9d0b-f5a4e9c10c71</td>
<td>nativeapplication</td>
</tr>
<tr>
<td>79a7fbfe-a0d5-4416-8c8f-6a523d45cd4c</td>
<td>803ee9ca-3f7f-4824-bd6e-0b99d720c35c</td>
<td>Azure Media Service</td>
</tr>
<tr>
<td>7f07985a-6657-41cb-b5f6-14c3554b027d</td>
<td>326128ad-f5f4-474c-bb19-c5e9b7780ba0</td>
<td>微软 Office 365 移动办公套件</td>
</tr>
<tr>
<td>866d1fbf-bf6d-4e30-a8ad-570317df9642</td>
<td>797f4846-ba00-4fd7-ba43-dac1f8f63013</td>
<td>Windows Azure Service Management API</td>
</tr>
<tr>
<td>8ac0becf-4180-43fd-883f-18bda7f45827</td>
<td>0f6edad5-48f2-4585-a609-d252b1c52770</td>
<td>AIGraphClient</td>
</tr>
<tr>
<td>8f5f81a0-7690-4bad-b097-bb22a9940041</td>
<td>168f7c69-e70d-4a14-ae22-c069b5d296bc</td>
<td>webapp</td>
</tr>
<tr>
<td>93a3c4d5-6451-4648-8195-b00eafe51b0e</td>
<td>f05ff7c9-f75a-4acd-a3b5-f4b6a870245d</td>
<td>SharePoint Android</td>
</tr>
<tr>
<td>94decd41-c70a-4255-b73a-0d52ead4dde9</td>
<td>2ab3d641-6164-4930-8f58-68d56787ab47</td>
<td>testapplication</td>
</tr>
<tr>
<td>9c4b5e57-6ec2-4218-be29-70d197664262</td>
<td>595d87a1-277b-4c0a-aa7f-44f8a068eafc</td>
<td>Microsoft.SupportTicketSubmission</td>
</tr>
<tr>
<td>a4c307c2-d229-4cea-a51c-c498b146fc3f</td>
<td>601d4e27-7bb3-4dee-8199-90d47d527e1c</td>
<td>Microsoft.Office365.ChangeManagement</td>
</tr>
<tr>
<td>a534ad32-c4a0-491e-810f-7499a8b9016a</td>
<td>c44b4083-3bb0-49c1-b47d-974e53cbdf3c</td>
<td>Ibiza Portal</td>
</tr>
<tr>
<td>a913c56c-7a86-479e-894e-9649f99f7841</td>
<td>8fad9a3d-ce06-4d85-8f9a-873164f0cafc</td>
<td>native</td>
</tr>
<tr>
<td>c259baa5-c050-420d-a4a9-3130dbeed2f9</td>
<td>6f82282e-0070-4e78-bc23-e6320c5fa7de</td>
<td>Microsoft.DiscoveryService</td>
</tr>
<tr>
<td>ce72c49b-a6df-45c6-9055-76d7eb684a9d</td>
<td>3f56a5d5-7882-4290-9fd8-3908d734b3fe</td>
<td>deamon</td>
</tr>
<tr>
<td>dc4e9fbc-9e1d-4900-9ea1-dfc9b8d414c5</td>
<td>0000000b-0000-0000-c000-000000000000</td>
<td>Microsoft.SellerDashboard</td>
</tr>
<tr>
<td>e1d2b488-d085-4af5-bd97-d2436f72fd7d</td>
<td>e3583ad2-c781-4224-9b91-ad15a8179ba0</td>
<td>Microsoft.ExtensibleRealUserMonitoring</td>
</tr>
<tr>
<td>ebf95d4c-7ccf-4ecf-ac48-793d2782f98d</td>
<td>67e3df25-268a-4324-a550-0de1c7f97287</td>
<td>Microsoft.OfficeWebAppsService</td>
</tr>
<tr>
<td>f0df0bc2-1c0a-446b-9eb6-7a4cf9749079</td>
<td>61a7b0d6-2bc9-48b6-8653-ef6b496815cb</td>
<td>GraphExplorer</td>
</tr>
</tbody>
</table>
<p>虽然列了这么多，但其实我们一般最关注就是下面这个服务 ObjectId | AppId | DisplayName -------- | ----- | ----------- 3319d71d-8dfc-42ff-8fa0-0aa64f553350 | 00000003-0000-0000-c000-000000000000 | Microsoft Graph</p>
<h2 id="查询服务的权限信息">查询服务的权限信息</h2>
<p>有了服务的基本信息，我们就可以查询它的详细信息，尤其是我们关注的权限定义这部分信息了</p>
<pre><code>$graph = Get-AzureADServicePrincipal -ObjectId 3319d71d-8dfc-42ff-8fa0-0aa64f553350
# 这个命令将Microsoft Graph这个服务定义保存为一个变量

$graph | fl * 
# 这个命令将显示详细信息

</code></pre>
<p><a href="https://img.cntofu.com/book/office365dev/docs/images/azureappgraphdetails.png" data-uk-lightbox><img src="https://img.cntofu.com/book/office365dev/docs/images/azureappgraphdetails.png" alt=""></a></p>
<p>下面我将演示一下如何将它的两类权限分别列举出来</p>
<pre><code>$graph.Oauth2Permissions 
# 这个会列举出来所有的用户模拟权限

</code></pre>
<table>
<thead>
<tr>
<th>Id</th>
<th>IsEnabled</th>
<th>Type</th>
<th>UserConsentDescription</th>
<th>UserConsentDisplayName</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>58e15261-dfce-4dbd-b1a9-6a513ccf39cd</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create, and delete contacts you have permissions to access, including your own and shared contacts.</td>
<td>Read and write to your and shared contacts</td>
<td>Contacts.ReadWrite.Shared</td>
</tr>
<tr>
<td>c8ee694a-ac5f-44eb-9487-f4fea3a6538d</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read contacts you have permissions to access, including your own and shared contacts.</td>
<td>Read your and shared contacts</td>
<td>Contacts.Read.Shared</td>
</tr>
<tr>
<td>9e044dd2-b119-478e-8b0c-3143ff864625</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create and delete events in all calendars in your organization you have permissions to access. This includes delegate and shared calendars.</td>
<td>Read and write to your and shared calendars</td>
<td>Calendars.ReadWrite.Shared</td>
</tr>
<tr>
<td>f1731364-f498-453c-a95f-c57fdbeff4f1</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read events in all calendars that you can access, including delegate and shared calendars.</td>
<td>Read calendars?you can access</td>
<td>Calendars.Read.Shared</td>
</tr>
<tr>
<td>2bf44396-38c4-4826-813f-75074b46a125</td>
<td>True</td>
<td>User</td>
<td>Allows the app to send mail as you or on-behalf of someone else.</td>
<td>Send mail on behalf of others or yourself</td>
<td>Mail.Send.Shared</td>
</tr>
<tr>
<td>0772b0b8-18f9-4412-a1dc-cdbb000727fa</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create, and delete mail you have permission to access, including your own and shared mail. Does not allow the app to send mail on your behalf.</td>
<td>Read and write mail?you can access</td>
<td>Mail.ReadWrite.Shared</td>
</tr>
<tr>
<td>07382180-f05b-4f94-8e51-02736bd78f14</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read mail you can access, including shared mail.</td>
<td>Read mail you can access</td>
<td>Mail.Read.Shared</td>
</tr>
<tr>
<td>e1fe6dd8-ba31-4d61-89e7-88639da4683d</td>
<td>True</td>
<td>User</td>
<td>Allows you to sign in to the app with your organizational account and let the app read your profile. It also allows the app to read basic company information.</td>
<td>Sign you in and read your profile</td>
<td>User.Read</td>
</tr>
<tr>
<td>b4e74841-8e56-480b-be8b-910348b18b4c</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read your profile, and discover your group membership, reports and manager. It also allows the app to update your profile information on your behalf.</td>
<td>Read and update your profile</td>
<td>User.ReadWrite</td>
</tr>
<tr>
<td>b340eb25-3456-403f-be2f-af7a0d370277</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read a basic set of profile properties of other users in your organization on your behalf. Includes display name, first and last name, email address and photo.</td>
<td>Read all users' basic profiles</td>
<td>User.ReadBasic.All</td>
</tr>
<tr>
<td>a154be20-db9c-4678-8ab7-66f6cc099a59</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to read the full set of profile properties, reports, and managers of other users in your organization, on your behalf.</td>
<td>Read all users' full profiles</td>
<td>User.Read.All</td>
</tr>
<tr>
<td>204e0828-b5ca-4ad8-b9f3-f32a958e7cc4</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to read and write the full set of profile properties, reports, and managers of other users in your organization, on your behalf.</td>
<td>Read and write all users' full profiles</td>
<td>User.ReadWrite.All</td>
</tr>
<tr>
<td>5f8c59db-677d-491f-a6b8-5f174b11ec1d</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to list groups, and to read their properties and all group memberships on your behalf. Also allows the app to read calendar, conversations, files, and other group content for all groups you can access.</td>
<td>Read all groups</td>
<td>Group.Read.All</td>
</tr>
<tr>
<td>4e46008b-f24c-477d-8fff-7bb4ec7aafe0</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to create groups and read all group properties and memberships on your behalf. Additionally allows the app to manage your groups and to update group content for groups you are a member of.</td>
<td>Read and write all groups</td>
<td>Group.ReadWrite.All</td>
</tr>
<tr>
<td>06da0dbc-49e2-44d2-8312-53f166ab848a</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to read data in your organization's directory.</td>
<td>Read directory data</td>
<td>Directory.Read.All</td>
</tr>
<tr>
<td>c5366453-9fb0-48a5-a156-24f0c49a4b84</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to read and write data in your organization's directory, such as other users, groups. It does not allow the app to delete users or groups, or reset user passwords.</td>
<td>Read and write directory data</td>
<td>Directory.ReadWrite.All</td>
</tr>
<tr>
<td>0e263e50-5827-48a4-b97c-d940288653c7</td>
<td>True</td>
<td>Admin</td>
<td>Allows the app to have the same access to information in your work or school directory as you do.</td>
<td>Access the directory as you</td>
<td>Directory.AccessAsUser.All</td>
</tr>
<tr>
<td>570282fd-fa5c-430d-a7fd-fc8dc98a9dca</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read email in your mailbox.</td>
<td>Read your mail</td>
<td>Mail.Read</td>
</tr>
<tr>
<td>024d486e-b451-40bb-833d-3e66d98c5c73</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create and delete email in your mailbox. Does not include permission to send mail.</td>
<td>Read and write access to your mail</td>
<td>Mail.ReadWrite</td>
</tr>
<tr>
<td>e383f46e-2787-4529-855e-0e479a3ffac0</td>
<td>True</td>
<td>User</td>
<td>Allows the app to send mail as you.</td>
<td>Send mail as you</td>
<td>Mail.Send</td>
</tr>
<tr>
<td>465a38f9-76ea-45b9-9f34-9e8b0d4b0b42</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read events in your calendars.</td>
<td>Read your calendars</td>
<td>Calendars.Read</td>
</tr>
<tr>
<td>1ec239c2-d7c9-4623-a91a-a9775856bb36</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create and delete events in your calendars.</td>
<td>Have full access to your calendars</td>
<td>Calendars.ReadWrite</td>
</tr>
<tr>
<td>ff74d97f-43af-4b68-9f2a-b77ee6968c5d</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read contacts in your contact folders.</td>
<td>Read your contacts</td>
<td>Contacts.Read</td>
</tr>
<tr>
<td>d56682ec-c09e-4743-aaf4-1a3aac4caa21</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, update, create and delete contacts in your contact folders.</td>
<td>Have full access of your contacts</td>
<td>Contacts.ReadWrite</td>
</tr>
<tr>
<td>10465720-29dd-4523-a11a-6a75c743c9d9</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read your files and files shared with you.</td>
<td>Read your files and files shared with you</td>
<td>Files.Read</td>
</tr>
<tr>
<td>5c28f0bf-8a70-41f1-8ab2-9032436ddb65</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, create, update, and delete your files and files shared with you.</td>
<td>Have full access to your files and files shared with you</td>
<td>Files.ReadWrite</td>
</tr>
<tr>
<td>8019c312-3263-48e6-825e-2b833497195b</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read, create, update and delete files in the application's folder.</td>
<td>Have full access to the application's folder</td>
<td>Files.ReadWrite.AppFolder</td>
</tr>
<tr>
<td>17dde5bd-8c17-420f-a486-969730c1b827</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read and write files that you select. After you select a file, the app has access to the file for several hours.</td>
<td>Read and write selected files</td>
<td>Files.ReadWrite.Selected</td>
</tr>
<tr>
<td>5447fe39-cb82-4c1a-b977-520e67e724eb</td>
<td>True</td>
<td>User</td>
<td>Allows the app to read files that you select. After you select a file, the app has access to the file for several hours.</td>
<td>Read selected files</td>
<td>Files.Read.Selected</td>
</tr>
<tr>
<td>205e70e5-aba6-4c52-a976-6d2d46c48043</td>
<td>True</td>
<td>User</td>
<td>Allow the application to read documents and list items in all site collections on your behalf</td>
<td>Read items in all site collections</td>
<td>Sites.Read.All</td>
</tr>
</tbody>
</table>
<pre><code>$graph.AppRoles
# 这个会列举出来所有的应用权限
</code></pre>
<table>
<thead>
<tr>
<th>Description</th>
<th>DisplayName</th>
<th>Id</th>
<th>IsEnabled</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Allows the app to read mail in all mailboxes without a signed-in user.</td>
<td>Read mail in all mailboxes</td>
<td>810c84a8-4a9e-49e6-bf7d-12d183f40d01</td>
<td>True</td>
<td>Mail.Read</td>
</tr>
<tr>
<td>Allows the app to create, read, update, and delete mail in all mailboxes without a signed-in user. Does not include permission to send mail.</td>
<td>Read and write mail in all mailboxes</td>
<td>e2a3a72e-5f79-4c64-b1b1-878b674786c9</td>
<td>True</td>
<td>Mail.ReadWrite</td>
</tr>
<tr>
<td>Allows the app to send mail as any user without a signed-in user.</td>
<td>Send mail as any user</td>
<td>b633e1c5-b582-4048-a93e-9f11b44c7e96</td>
<td>True</td>
<td>Mail.Send</td>
</tr>
<tr>
<td>Allows the app to read events of all calendars without a signed-in user.</td>
<td>Read calendars in all mailboxes</td>
<td>798ee544-9d2d-430c-a058-570e29e34338</td>
<td>True</td>
<td>Calendars.Read</td>
</tr>
<tr>
<td>Allows the app to create, read, update, and delete events of all calendars without a signed-in user.</td>
<td>Read and write calendars in all mailboxes</td>
<td>ef54d2bf-783f-4e0f-bca1-3210c0444d99</td>
<td>True</td>
<td>Calendars.ReadWrite</td>
</tr>
<tr>
<td>Allows the app to read all contacts in all mailboxes without a signed-in user.</td>
<td>Read contacts in all mailboxes</td>
<td>089fe4d0-434a-44c5-8827-41ba8a0b17f5</td>
<td>True</td>
<td>Contacts.Read</td>
</tr>
<tr>
<td>Allows the app to create, read, update, and delete all contacts in all mailboxes without a signed-in user.</td>
<td>Read and write contacts in all mailboxes</td>
<td>6918b873-d17a-4dc1-b314-35f528134491</td>
<td>True</td>
<td>Contacts.ReadWrite</td>
</tr>
<tr>
<td>Allows the app to read group properties and memberships, and read the calendar and conversations for all groups, without a signed-in user.</td>
<td>Read all groups</td>
<td>5b567255-7703-4780-807c-7be8301ae99b</td>
<td>True</td>
<td>Group.Read.All</td>
</tr>
<tr>
<td>Allows the app to create groups, read all group properties and memberships, update group properties and memberships, and delete groups. Also allows the app to read and write group calendar and conversations. All of these operations can be performed by the app without a signed-in user.</td>
<td>Read and write all groups</td>
<td>62a82d76-70ea-41e2-9197-370581804d09</td>
<td>True</td>
<td>Group.ReadWrite.All</td>
</tr>
<tr>
<td>Allows the app to read data in your organization's directory, such as users, groups and apps, without a signed-in user.</td>
<td>Read directory data</td>
<td>7ab1d382-f21e-4acd-a863-ba3e13f7da61</td>
<td>True</td>
<td>Directory.Read.All</td>
</tr>
<tr>
<td>Allows the app to read and write data in your organization's directory, such as users, and groups, without a signed-in user. Does not allow user or group deletion.</td>
<td>Read and write directory data</td>
<td>19dbc75e-c2e2-444c-a770-ec69d8559fc7</td>
<td>True</td>
<td>Directory.ReadWrite.All</td>
</tr>
<tr>
<td>Allows the app to read and write all device properties without a signed in user. Does not allow device creation, device deletion or update of device alternative security identifiers.</td>
<td>Read and write devices</td>
<td>1138cb37-bd11-4084-a2b7-9f71582aeddb</td>
<td>True</td>
<td>Device.ReadWrite.All</td>
</tr>
<tr>
<td>Allows the app to read user profiles without a signed in user.</td>
<td>Read all users' full profiles</td>
<td>df021288-bdef-4463-88db-98f22de89214</td>
<td>True</td>
<td>User.Read.All</td>
</tr>
<tr>
<td>Allows the app to read and update user profiles without a signed in user.</td>
<td>Read and write all users' full profiles</td>
<td>741f803b-c850-494e-b5df-cde7c675a1ca</td>
<td>True</td>
<td>User.ReadWrite.All</td>
</tr>
</tbody>
</table>
<h2 id="创建应用程序">创建应用程序</h2>
<p>创建应用程序的PowerShell命令是New-AzureADApplication,它的详细用法请参考这里 <a href="https://docs.microsoft.com/en-us/powershell/module/azuread/new-azureadapplication?view=azureadps-2.0">https://docs.microsoft.com/en-us/powershell/module/azuread/new-azureadapplication?view=azureadps-2.0</a></p>
<pre><code>$app= New-AzureADApplication -DisplayName "yourapplicationname"  -ReplyUrls "https://websample.com/replyurl" -Homepage "https://websample.com" -IdentifierUris "https://websample.com"

# 这是用来创建Web应用程序的

$app= New-AzureADApplication -DisplayName "yourapplicationname"  -PublicClient $true

# 这是用来创建本地应用程序的，设置PublicClient属性为true即可

$app

#请保存app的具体信息，尤其是AppId

</code></pre>
<h2 id="创建密钥">创建密钥</h2>
<p>如果上面创建的是Web 应用程序，还需要为应用程序创建密钥。这里会用到的PowerShell命令是New-AzureADApplicationPasswordCredential，它的详细用法请参考这里 <a href="https://docs.microsoft.com/en-us/powershell/module/azuread/new-azureadapplicationpasswordcredential?view=azureadps-2.0">https://docs.microsoft.com/en-us/powershell/module/azuread/new-azureadapplicationpasswordcredential?view=azureadps-2.0</a></p>
<pre><code>New-AzureADApplicationPasswordCredential -ObjectId $app.ObjectId

# 正常情况下，将返回一个为期一年的密钥信息

CustomKeyIdentifier :
EndDate             : 7/12/2018 10:25:28 AM
KeyId               :
StartDate           : 7/12/2017 10:25:28 AM
Value               : /TD0rbE5gwm/a6TGqUhqVY46LA16rir6Zwm7pK69prI=


# 请保存这个Value信息
</code></pre>
<h2 id="绑定服务和设定权限">绑定服务和设定权限</h2>
<p>我们已经创建了应用程序，也为他申请了一个密钥，下面就是最后也是最关键的环节————为应用程序绑定服务并且设定权限了。下面这个代码段是为上面创建好的应用程序，并且为其申请了四个delegated permission。（具体这四个权限对应的是什么，请参考上面的表格）</p>
<pre><code>$graphrequest = New-Object -TypeName "Microsoft.Open.AzureAD.Model.RequiredResourceAccess"

$graphrequest.ResourceAccess = New-Object -TypeName "System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]"

$ids =@("024d486e-b451-40bb-833d-3e66d98c5c73","e383f46e-2787-4529-855e-0e479a3ffac0","e1fe6dd8-ba31-4d61-89e7-88639da4683d","b340eb25-3456-403f-be2f-af7a0d370277")

foreach($id in $ids){
    $obj = New-Object -TypeName "Microsoft.Open.AzureAD.Model.ResourceAccess" -ArgumentList $id,"Scope"
    # 如果是AppRole权限，则第二个参数为Role

    $graphrequest.ResourceAccess.Add($obj)
}

$graphrequest.ResourceAppId = "00000003-0000-0000-c000-000000000000"

Set-AzureADApplication -ObjectId $app.ObjectId -RequiredResourceAccess ($graphrequest)
# 这句命令的RequiredResourceAccess 参数中可以有多个对象

</code></pre>
<h2 id="结语">结语</h2>
<p>这篇文章的篇幅较长，我尽可能详细地展示了很多Azure AD中注册应用程序，绑定服务和设定权限的细节，尤其是对于国内的Office 365客户以及合作伙伴来说应该有较高的实用价值。 当我们没有图形化界面可以使用的时候，你就会由衷地感慨，脚本（例如PowerShell）确实是很强大的，而且通过脚本的探索过程，你可以更加清晰地理解其背后的逻辑。</p>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/98/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/visualstudio_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/98/index.html">Microsoft Visual Studio Code 中文手册</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/60.html">likebeta</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="visualstudio">visualstudio</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">66页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月29日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/23/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/cplusplus_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/23/index.html">数据结构思维</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/15.html">wizardforcel</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="cplusplus">cplusplus</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">20页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 286个">286</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/110/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/react_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/110/index.html">React 学习之道</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/62.html">tzivanmoe</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="react">react</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">11页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月1日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 0个">0</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/164/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/go_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/164/index.html">Go 开发者路线图</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/93.html">Alikhll</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="go">go</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 4583个">4583</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/112/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/django_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/112/index.html">从Python到Django入门教程</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/62.html">tzivanmoe</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="django">django</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">41页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月1日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 2个">2</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../book/146/index.html">
<img class="uk-book-cover" src="../../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../book/146/index.html">http2讲解</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../user/78.html">bagder</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">15页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年3月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1463个">1463</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../../" title="返回首页"><img class="" src="../../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../../book/131/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../../book/131/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../../book/131/README.html" title="系列文章简介" data-book-page-rel-url="README.html" data-book-page-id="9986">系列文章简介</a>
<ul>
<li>
<a class="pjax" href="../../../book/131/docs/office365dev-overview-1.html" title="上篇" data-book-page-rel-url="docs/office365dev-overview-1.html" data-book-page-id="10548">上篇</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/office365dev-overview-2.html" title="下篇" data-book-page-rel-url="docs/office365dev-overview-2.html" data-book-page-id="10549">下篇</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/office365devenv.html" title="Office 365开发环境搭建" data-book-page-rel-url="docs/office365devenv.html" data-book-page-id="10550">Office 365开发环境搭建</a>
<ul>
<li>
<a class="pjax" href="../../../book/131/docs/microsoftgraphoverview.html" title="Microsoft Graph 概述" data-book-page-rel-url="docs/microsoftgraphoverview.html" data-book-page-id="10551">Microsoft Graph 概述</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/graphexplorer.html" title="通过GraphExplorer体验Microsoft Graph" data-book-page-rel-url="docs/graphexplorer.html" data-book-page-id="10552">通过GraphExplorer体验Microsoft Graph</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/graph-tools.html" title="通过其他第三方工具体验Microsoft Graph" data-book-page-rel-url="docs/graph-tools.html" data-book-page-id="10553">通过其他第三方工具体验Microsoft Graph</a>
<ul>
<li>
<a class="pjax" href="../../../book/131/docs/applicationregisteration.html" title="注册Azure AD 应用程序" data-book-page-rel-url="docs/applicationregisteration.html" data-book-page-id="10554">注册Azure AD 应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/applicationregisteration2.0.html" title="注册Azure AD 2.0 应用程序" data-book-page-rel-url="docs/applicationregisteration2.0.html" data-book-page-id="10555">注册Azure AD 2.0 应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/chinaoffice365applicationregisteration.html" title="注册中国版Microsoft Graph应用程序" data-book-page-rel-url="docs/chinaoffice365applicationregisteration.html" data-book-page-id="10556">注册中国版Microsoft Graph应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/understandapplication.html" title="掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明" data-book-page-rel-url="docs/understandapplication.html" data-book-page-id="10557">掀起Azure AD的盖头来——深入理解Microsoft Graph应用程序和服务权限声明</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/desktopapplication.html" title="Microsoft Graph 桌面应用程序" data-book-page-rel-url="docs/desktopapplication.html" data-book-page-id="10558">Microsoft Graph 桌面应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powershell-application.html" title="PowerShell脚本访问Microsoft Graph" data-book-page-rel-url="docs/powershell-application.html" data-book-page-id="10559">PowerShell脚本访问Microsoft Graph</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powershell-module.html" title="支持国内版Office 365的PowerShell模块现已发布" data-book-page-rel-url="docs/powershell-module.html" data-book-page-id="10560">支持国内版Office 365的PowerShell模块现已发布</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/webapplication.html" title="Microsoft Graph  Web应用程序极致开发体验" data-book-page-rel-url="docs/webapplication.html" data-book-page-id="10561">Microsoft Graph Web应用程序极致开发体验</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/gettenantid.html" title="如何通过PowerShell获取Office 365 TenantID" data-book-page-rel-url="docs/gettenantid.html" data-book-page-id="10562">如何通过PowerShell获取Office 365 TenantID</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/deamonapplication.html" title="Microsoft Graph  服务应用程序" data-book-page-rel-url="docs/deamonapplication.html" data-book-page-id="10563">Microsoft Graph 服务应用程序</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/crossplatform.html" title="在ASP.NET Core MVC 应用程序中集成 Microsoft Graph" data-book-page-rel-url="docs/crossplatform.html" data-book-page-id="10564">在ASP.NET Core MVC 应用程序中集成 Microsoft Graph</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/graphextensions.html" title="扩展Microsoft Graph数据结构 -开放扩展" data-book-page-rel-url="docs/graphextensions.html" data-book-page-id="10565">扩展Microsoft Graph数据结构 -开放扩展</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/graphschemaextensions.html" title="扩展Microsoft Graph数据结构 -架构扩展" data-book-page-rel-url="docs/graphschemaextensions.html" data-book-page-id="10566">扩展Microsoft Graph数据结构 -架构扩展</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/excelgraph.html" title="Excel as a Service —— Excel 开发居然可以这么玩" data-book-page-rel-url="docs/excelgraph.html" data-book-page-id="10567">Excel as a Service —— Excel 开发居然可以这么玩</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/timeline.html" title="基于Microsoft Graph打造自己的Timeline应用" data-book-page-rel-url="docs/timeline.html" data-book-page-id="10568">基于Microsoft Graph打造自己的Timeline应用</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/tokenplease.html" title="通过tokenPlease()函数获取accessToken" data-book-page-rel-url="docs/tokenplease.html" data-book-page-id="10569">通过tokenPlease()函数获取accessToken</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/id_token.html" title="解码id_token" data-book-page-rel-url="docs/id_token.html" data-book-page-id="10570">解码id_token</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/oauth.html" title="详解 OAuth的场景" data-book-page-rel-url="docs/oauth.html" data-book-page-id="10571">详解 OAuth的场景</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddins.html" title="Office Add-in 架构和入门" data-book-page-rel-url="docs/officeaddins.html" data-book-page-id="10572">Office Add-in 架构和入门</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddindev.html" title="在Visual Studio 中开发Office Add-in" data-book-page-rel-url="docs/officeaddindev.html" data-book-page-id="10573">在Visual Studio 中开发Office Add-in</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/vscodetoofficeaddin.html" title="在Visual Studio Code中开发Office Add-in" data-book-page-rel-url="docs/vscodetoofficeaddin.html" data-book-page-id="10574">在Visual Studio Code中开发Office Add-in</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddindesignguide.html" title="Office Add-in 设计规范与最佳实践" data-book-page-rel-url="docs/officeaddindesignguide.html" data-book-page-id="10575">Office Add-in 设计规范与最佳实践</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/exceladdinsample.html" title="实战Excel Add-in的三种玩法(VBA,VSTO,Web Add-in)" data-book-page-rel-url="docs/exceladdinsample.html" data-book-page-id="10576">实战Excel Add-in的三种玩法(VBA,VSTO,Web Add-in)</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/exceladdinpractics.html" title="Office Web Add-in的技术原理和开发常见问题剖析" data-book-page-rel-url="docs/exceladdinpractics.html" data-book-page-id="10577">Office Web Add-in的技术原理和开发常见问题剖析</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddinmanifest.html" title="详解Office Add-in 清单文件" data-book-page-rel-url="docs/officeaddinmanifest.html" data-book-page-id="10578">详解Office Add-in 清单文件</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddinpublish.html" title="在企业和应用市场发布Office Add-in" data-book-page-rel-url="docs/officeaddinpublish.html" data-book-page-id="10579">在企业和应用市场发布Office Add-in</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeaddinsso.html" title="在Office Add-in中实现单点登陆（SSO）" data-book-page-rel-url="docs/officeaddinsso.html" data-book-page-id="10580">在Office Add-in中实现单点登陆（SSO）</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/sharepoint.html" title="再谈 SharePoint 大局观" data-book-page-rel-url="docs/sharepoint.html" data-book-page-id="10581">再谈 SharePoint 大局观</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/sharepointaddin.html" title="SharePoint Add-in 开发" data-book-page-rel-url="docs/sharepointaddin.html" data-book-page-id="10582">SharePoint Add-in 开发</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/sharepointpnp.html" title="SharePoint Patterns and Practices 简介" data-book-page-rel-url="docs/sharepointpnp.html" data-book-page-id="10583">SharePoint Patterns and Practices 简介</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/sharepointframework.html" title="SharePoint Framework 简介" data-book-page-rel-url="docs/sharepointframework.html" data-book-page-id="10584">SharePoint Framework 简介</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/office365connector.html" title="Office 365 Connectors 的使用与自定义开发" data-book-page-rel-url="docs/office365connector.html" data-book-page-id="10585">Office 365 Connectors 的使用与自定义开发</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officebusinessapp.html" title="基于Office 365的随需应变业务应用平台" data-book-page-rel-url="docs/officebusinessapp.html" data-book-page-id="10586">基于Office 365的随需应变业务应用平台</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powerapps.html" title="PowerApps 入门篇" data-book-page-rel-url="docs/powerapps.html" data-book-page-id="10587">PowerApps 入门篇</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powerappsadv.html" title="PowerApps 进阶篇" data-book-page-rel-url="docs/powerappsadv.html" data-book-page-id="10588">PowerApps 进阶篇</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/microsoftflow.html" title="Microsoft Flow 概览" data-book-page-rel-url="docs/microsoftflow.html" data-book-page-id="10589">Microsoft Flow 概览</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/commondatamodel.html" title="Common Data Service 初探" data-book-page-rel-url="docs/commondatamodel.html" data-book-page-id="10590">Common Data Service 初探</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powerappsconnector.html" title="为PowerApps和Flow开发自定义连接器" data-book-page-rel-url="docs/powerappsconnector.html" data-book-page-id="10591">为PowerApps和Flow开发自定义连接器</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/powerbi.html" title="观未见，行不止 —— Power BI 两周年技术和方案交流圆桌会议纪实" data-book-page-rel-url="docs/powerbi.html" data-book-page-id="10592">观未见，行不止 —— Power BI 两周年技术和方案交流圆桌会议纪实</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/officeandai.html" title="人工智能背景下的Office 365现状和发展趋势" data-book-page-rel-url="docs/officeandai.html" data-book-page-id="10593">人工智能背景下的Office 365现状和发展趋势</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/botframeworkquickstart.html" title="Office 365 机器人（Bot）开发入门" data-book-page-rel-url="docs/botframeworkquickstart.html" data-book-page-id="10594">Office 365 机器人（Bot）开发入门</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/botframeworkguide.html" title="Office 365 机器人（Bot）开发入门指南" data-book-page-rel-url="docs/botframeworkguide.html" data-book-page-id="10595">Office 365 机器人（Bot）开发入门指南</a>
</li>
<li>
<a class="pjax" href="../../../book/131/docs/office365opensource.html" title="拥抱开源，Office 365开发迎来新的时代" data-book-page-rel-url="docs/office365opensource.html" data-book-page-id="10596">拥抱开源，Office 365开发迎来新的时代</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =131;var bookPageId =10557;var bookPageRelUrl ='docs/understandapplication.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>