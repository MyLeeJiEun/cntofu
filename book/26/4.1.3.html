
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>4.1.3 高级话题-安卓应用安全指南(Android Application Secure Design/Secure Coding Guidebook)</title>
<meta content='4.1.3 高级话题,安卓应用安全指南,Android Application Secure Design/Secure Coding Guidebook' name='keywords'>
<meta content='4.1.3 高级话题,安卓应用安全指南,Android Application Secure Design/Secure Coding Guidebook' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../static/components/css/base.css">
<link rel="stylesheet" href="../../static/components/css/reader.css">
<link rel="stylesheet" href="../../static/components/css/markdown.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../book/26/4.1.2.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">4.1.2 规则书</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../book/26/4.2.html">
<span class="">4.2 接收/发送广播</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../book/26/index.html">安卓应用安全指南 (Android Application Secure Design/Secure Coding Guidebook)</a>
<a target="_blank" rel="nofollow" href="https://github.com/wizardforcel/android-app-sec-guidebook-zh" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  md-content-section  uk-margin-bottom">
<h3 id="413-高级话题">4.1.3 高级话题</h3>
<h4 id="4131-组合导出属性和意图过滤器对于活动">4.1.3.1 组合导出属性和意图过滤器（对于活动）</h4>
<p>我们已经解释了如何实现本指南中的四类活动：私有活动，公共活动，伙伴活动和内部活动。 下表中定义了每种类型的导出属性的允许的设置，和<code>intent-filter</code>元素的各种组合，它们在<code>AndroidManifest.xml</code>文件中定义。 请使用你尝试创建的活动，验证导出属性和<code>intent-filter</code>元素的兼容性。</p>
<table>
<thead>
<tr>
<th></th>
<th>导出属性的值</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>True</td>
<td>False</td>
<td>未指定</td>
</tr>
<tr>
<td>意图过滤器已定义</td>
<td>公开</td>
<td>（不使用）</td>
<td>（不使用）</td>
</tr>
<tr>
<td>意图过滤器未定义</td>
<td>公开、伙伴、内部</td>
<td><code>AndroidManifest.xml</code></td>
<td>（不使用）</td>
</tr>
</tbody>
</table>
<p>表 4.1-2</p>
<p>当未指定<code>Activity</code>的导出属性时，<code>Activity</code>是否为公开的，取决于<code>Activity</code>的意图过滤器的存在与否 [4]。 但是，在本手册中，禁止将导出属性设置为未指定。通常，如前所述，最好避免依赖任何给定 API 的默认行为的实现；此外，如果存在明确的方法（例如导出属性）来启用重要的安全相关设置，那么使用这些方法总是一个好主意。</p>
<blockquote>
<p>如果定义了任何意图过滤器，则该活动是公开的；否则它是私有的。更多信息请参阅 <a href="https://developer.android.com/guide/topics/manifest/activity-element.html#exported">https://developer.android.com/guide/topics/manifest/activity-element.html#exported</a>。</p>
</blockquote>
<p>不应该使用未定义的意图过滤器和导出属性<code>false</code>的原因，是 Android 的行为存在漏洞，并且由于意图过滤器的工作原理，其他应用的活动可能会意外调用它。下面的两个图展示了这个解释。图 4.1-4 是一个正常行为的例子，其中私有活动（应用 A）只能由同一个应用的隐式<code>Intent</code>调用。 意图过滤器（<code>action ="X"</code>）被定义为仅在应用 A 内部工作，所以这是预期的行为。</p>
<p><a href="https://img.cntofu.com/book/android-app-sec-guidebook-zh/img/4-1-4.jpg" data-uk-lightbox><img src="https://img.cntofu.com/book/android-app-sec-guidebook-zh/img/4-1-4.jpg" alt=""></a></p>
<p>下面的图 4.1-5 展示了一个场景，其中在应用 B 和应用 A 中定义了相同的意图过滤器（<code>action ="X"</code>）。应用 A 试图通过发送隐式意图，来调用同一应用中的私有活动 ，但是这次显示了对话框，询问用户选择哪个应用，以及应用 B 中的公共活动 B-1 ，由于用户的选择而错误调用。 由于这个漏洞，可能会将敏感信息发送到其他应用，或者应用可能会收到意外的返回值。</p>
<p><a href="https://img.cntofu.com/book/android-app-sec-guidebook-zh/img/4-1-5.jpg" data-uk-lightbox><img src="https://img.cntofu.com/book/android-app-sec-guidebook-zh/img/4-1-5.jpg" alt=""></a></p>
<p>如上所示，使用意图过滤器，将隐式意图发送到私有应用，可能会导致意外行为，因此最好避免此设置。 另外，我们已经验证了这种行为不依赖于应用 A 和应用 B 的安装顺序。</p>
<h4 id="4132-验证请求应用">4.1.3.2 验证请求应用</h4>
<p>我们在此解释一些技术信息，关于如何实现伙伴活动。 伙伴应用只允许白名单中注册的特定应用访问，并且所有其他应用都被拒绝。 由于除内部应用之外的其他应用也需要访问权限，因此我们无法使用签名权限进行访问控制。</p>
<p>简而言之，我们希望验证尝试使用伙伴活动的应用，通过检查它是否在预定义的白名单中注册，如果是，则允许访问，如果不是，则拒绝访问。 应用验证的方式是，从请求访问的应用获取证书，并将其与白名单中的散列进行比较。</p>
<p>一些开发人员可能会认为，仅仅比较软件包名称而不获取证书就足够了，但是，很容易伪装成合法应用的软件包名称，因此这不是检查真实性的好方法。 任意指定的值不应用于认证。 另一方面，由于只有应用开发人员拥有用于签署证书的开发人员密钥，因此这是识别的更好方法。 由于证书不容易被伪造，除非恶意第三方可以窃取开发人员密钥，否则恶意应用被信任的可能性很小。 虽然可以将整个证书存储在白名单中，但为了使文件大小最小，仅存储 SHA-256 散列值就足够了。</p>
<p>使用这个方法有两个限制：</p>
<ul>
<li>请求应用需要使用<code>startActivityForResult()</code>而不是<code>startActivity()</code>。</li>
<li>请求应用应该只从<code>Activity</code>调用。</li>
</ul>
<p>第二个限制是由于第一个限制而施加的限制，因此技术上只有一个限制。</p>
<p>由于<code>Activity.getCallingPackage()</code>的限制，它获取调用应用的包名称，所以会发生此限制。 <code>Activity.getCallingPackage()</code>仅在由<code>startActivityForResult()</code>调用时，才返回源（请求）应用的包名，但不幸的是，当它由<code>startActivity()</code>调用时，它仅返回<code>null</code>。 因此，使用此处解释的方法时，源（请求）应用需要使用<code>startActivityForResult()</code>，即使它不需要获取返回值。 另外，<code>startActivityForResult()</code>只能在<code>Activity</code>类中使用，所以源（请求者）仅限于活动。</p>
<p>PartnerActivity.java</p>
<pre><code class="language-java">package org.jssec.android.activity.partneractivity;

import org.jssec.android.shared.PkgCertWhitelists;
import org.jssec.android.shared.Utils;
import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class PartnerActivity extends Activity {

    // *** POINT 4 *** Verify the requesting application's certificate through a predefined whitelist.
    private static PkgCertWhitelists sWhitelists = null;

    private static void buildWhitelists(Context context) {
        boolean isdebug = Utils.isDebuggable(context);
        sWhitelists = new PkgCertWhitelists();
        // Register certificate hash value of partner application org.jssec.android.activity.partneruser
            .sWhitelists.add("org.jssec.android.activity.partneruser", isdebug ?
            // Certificate hash value of "androiddebugkey" in the debug.keystore.
            "0EFB7236 328348A9 89718BAD DF57F544 D5CCB4AE B9DB34BC 1E29DD26 F77C8255" :
            // Certificate hash value of "partner key" in the keystore.
            "1F039BB5 7861C27A 3916C778 8E78CE00 690B3974 3EB8259F E2627B8D 4C0EC35A");
            // Register the other partner applications in the same way.
    }
    
    private static boolean checkPartner(Context context, String pkgname) {
        if (sWhitelists == null) buildWhitelists(context);
        return sWhitelists.test(context, pkgname);
    }
    
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        // *** POINT 4 *** Verify the requesting application's certificate through a predefined whitelist.
        if (!checkPartner(this, getCallingActivity().getPackageName())) {
            Toast.makeText(this,
            "Requesting application is not a partner application.", Toast.LENGTH_LONG).show();
            finish();
            return;
        }
        // *** POINT 5 *** Handle the received intent carefully and securely, even though the intent was sent from a partner application.
        // Omitted, since this is a sample. Refer to "3.2 Handling Input Data Carefully and Securely."
        Toast.makeText(this, "Accessed by Partner App", Toast.LENGTH_LONG).show();
    }
    
    public void onReturnResultClick(View view) {
        // *** POINT 6 *** Only return Information that is granted to be disclosed to a partner application.
        Intent intent = new Intent();
        intent.putExtra("RESULT", "Information for partner applications");
        setResult(RESULT_OK, intent);
        finish();
    }
}
</code></pre>
<p>PkgCertWhitelists.java</p>
<pre><code class="language-java">package org.jssec.android.shared;

import java.util.HashMap;
import java.util.Map;
import android.content.Context;

public class PkgCertWhitelists {

    private Map&lt;String, String&gt; mWhitelists = new HashMap&lt;String, String&gt;();
    public boolean add(String pkgname, String sha256) {
        if (pkgname == null) return false;
        if (sha256 == null) return false;
        sha256 = sha256.replaceAll(" ", "");
        if (sha256.length() != 64) return false; // SHA-256 -&gt; 32 bytes -&gt; 64 chars
        sha256 = sha256.toUpperCase();
        if (sha256.replaceAll("[0-9A-F]+", "").length() != 0) return false; // found non hex char
        mWhitelists.put(pkgname, sha256);
        return true;
    }
    
    public boolean test(Context ctx, String pkgname) {
        // Get the correct hash value which corresponds to pkgname.
        String correctHash = mWhitelists.get(pkgname);
        // Compare the actual hash value of pkgname with the correct hash value.
        return PkgCert.test(ctx, pkgname, correctHash);
    }
}
</code></pre>
<p>PkgCert.java</p>
<pre><code class="language-java">
package org.jssec.android.shared;

import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import android.content.Context;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.pm.Signature;

public class PkgCert {

    public static boolean test(Context ctx, String pkgname, String correctHash) {
        if (correctHash == null) return false;
        correctHash = correctHash.replaceAll(" ", "");
        return correctHash.equals(hash(ctx, pkgname));
    }
    
    public static String hash(Context ctx, String pkgname) {
        if (pkgname == null) return null;
        try {
            PackageManager pm = ctx.getPackageManager();
            PackageInfo pkginfo = pm.getPackageInfo(pkgname, PackageManager.GET_SIGNATURES);
            if (pkginfo.signatures.length != 1) return null; // Will not handle multiple signatures.
            Signature sig = pkginfo.signatures[0];
            byte[] cert = sig.toByteArray();
            byte[] sha256 = computeSha256(cert);
            return byte2hex(sha256);
        } catch (NameNotFoundException e) {
            return null;
        }
    }
    
    private static byte[] computeSha256(byte[] data) {
        try {
            return MessageDigest.getInstance("SHA-256").digest(data);
        } catch (NoSuchAlgorithmException e) {
            return null;
        }
    }
    
    private static String byte2hex(byte[] data) {
        if (data == null) return null;
        final StringBuilder hexadecimal = new StringBuilder();
        for (final byte b : data) {
            hexadecimal.append(String.format("%02X", b));
        }
        return hexadecimal.toString();
    }
}
</code></pre>
<h4 id="4133-读取发送给活动的意图">4.1.3.3 读取发送给活动的意图</h4>
<p>在 Android 5.0（API Level 21）及更高版本中，使用<code>getRecentTasks()</code>得到的信息仅限于调用者自己的任务，并且可能还有一些其他任务，例如已知不敏感的其他任务。 但是支持 Android 5.0（API Level 21）版本的应用应该防止泄露敏感信息。 以下描述了问题内容，它出现在 Android 5.0 及更早版本中。</p>
<p>发送到任务的根<code>Activity</code>的意图，被添加到任务历史中。 根活动是在任务中启动的第一个活动。 任何应用都可以通过使用<code>ActivityManager</code>类，读取添加到任务历史的意图。</p>
<p>下面显示了从应用中读取任务历史的示例代码。 要浏览任务历史，请在<code>AndroidManifest.xml</code>文件中指定<code>GET_TASKS</code>权限。</p>
<p>AndroidManifest.xml</p>
<pre><code class="language-xml">&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="org.jssec.android.intent.maliciousactivity" &gt;
    
    &lt;!-- Use GET_TASKS Permission --&gt;
    &lt;uses-permission android:name="android.permission.GET_TASKS" /&gt;
    
    &lt;application
        android:allowBackup="false"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" &gt;
        &lt;activity
            android:name=".MaliciousActivity"
            android:label="@string/title_activity_main"
            android:exported="true" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;
                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>
<p>MaliciousActivity.java</p>
<pre><code class="language-java">package org.jssec.android.intent.maliciousactivity;

import java.util.List;
import java.util.Set;
import android.app.Activity;
import android.app.ActivityManager;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;

public class MaliciousActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.malicious_activity);
        // Get am ActivityManager instance.
        ActivityManager activityManager = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
        // Get 100 recent task info.
        List&lt;ActivityManager.RecentTaskInfo&gt; list = activityManager
            .getRecentTasks(100, ActivityManager.RECENT_WITH_EXCLUDED);
        for (ActivityManager.RecentTaskInfo r : list) {
            // Get Intent sent to root Activity and Log it.
            Intent intent = r.baseIntent;
            Log.v("baseIntent", intent.toString());
            Log.v(" action:", intent.getAction());
            Log.v(" data:", intent.getDataString());
            if (r.origActivity != null) {
                Log.v(" pkg:", r.origActivity.getPackageName() + r.origActivity.getClassName());
            }
            Bundle extras = intent.getExtras();
            if (extras != null) {
                Set&lt;String&gt; keys = extras.keySet();
                for(String key : keys) {
                    Log.v(" extras:", key + "=" + extras.get(key).toString());
                }
            }
        }
    }
}
</code></pre>
<p>你可以使用<code>AcitivityManager</code>类的<code>getRecentTasks()</code>函数，来获取任务历史的指定条目。 每个任务的信息存储在<code>ActivityManager.RecentTaskInfo</code>类的实例中，但发送到任务根<code>Activity</code>的意图存储在其成员变量<code>baseIntent</code>中。 由于根<code>Activity</code>是创建任务时启动的<code>Activity</code>，请务必在调用<code>Activity</code>时，不要满足以下两个条件。</p>
<ul>
<li>新的任务在活动被调用时创建</li>
<li>被调用的活动是任务的根活动，它已经在前台或者后台存在</li>
</ul>
<h4 id="4134-根活动">4.1.3.4 根活动</h4>
<p>根活动是作为任务起点的活动。 换句话说，这是创建任务时启动的活动。 例如，当默认活动由启动器启动时，此活动将是根活动。 根据 Android 规范，发送到根<code>Activity</code>的意图的内容可以从任意应用中读取。 因此，有必要采取对策，不要将敏感信息发送到根活动。 在本指南中，已经制定了以下三条规则来避免被调用的<code>Activity</code>成为根活动。</p>
<ul>
<li>不要指定<code>taskAffinity</code></li>
<li>不要指定<code>launchMode</code></li>
<li>发送给活动的意图中，不要设置<code>FLAG_ACTIVITY_NEW_TASK</code></li>
</ul>
<p>我们考虑一个情况，活动可以成为下面的根活动。 被调用的活动成为根活动，取决于以下内容。</p>
<ul>
<li>被调用活动的启动模式</li>
<li>被调用活动的任务及其启动模式</li>
</ul>
<p>首先，让我解释一下“被调用活动的启动模式”。 可以通过在<code>AndroidManifest.xml</code>中编写<code>android:launchMode</code>来设置<code>Activity</code>的启动模式。 当它没有编写时，它被认为是“标准”。 另外，启动模式也可以通过设置意图的标志来更改。 标志<code>FLAG_ACTIVITY_NEW_TASK</code>以<code>singleTask</code>模式启动活动。</p>
<p>启动模式可以指定为这些。我会解释它们和根活动的关系。</p>
<p>标准（<code>standard</code>）</p>
<p>此模式调用的活动不会是根，它属于调用者端的任务。 每次调用时，都会生成活动实例。</p>
<p><code>singleTop</code></p>
<p>这个启动模式和“标准”相同，除了启动一个活动，它显示在前台任务的最前面时，不会生成实例。</p>
<p><code>singleTask</code></p>
<p>这个启动模式根据 Affinity 值确定活动所属的任务。 当匹配<code>Activity</code>的 Affinity 的任务不存在于后台或前台时，新任务随<code>Activity</code>的实例一起生成。 当任务存在时，它们都不会被生成。 在前者中，已启动的<code>Activity</code>实例成为根。</p>
<p><code>singleInstance</code></p>
<p>与<code>singleTask</code>相同，但以下几点不同。 只有根活动可以属于新生成的任务。 因此，通过此模式启动的活动实例，始终是根活动。 现在，我们需要注意的是，虽然任务已经存在，并且名称和被调用<code>Activity</code>的 Affinity 相同，但是被调用<code>Activity</code>的类名和包含在任务中的<code>Activity</code>的类名是不同的。</p>
<p>从上面我们可以知道，由<code>singleTask</code>或<code>singleInstance</code>启动的<code>Activity</code>有可能成为根。 为了确保应用的安全性，它不应该由这些模式启动。</p>
<p>接下来，我将解释“被调用活动的任务及其启动模式”。 即使<code>Activity</code>以“标准”模式调用，它也会成为根<code>Activity</code>。在某些情况下，取决于<code>Activity</code>所属的任务状态。</p>
<p>例如，考虑被调用<code>Activity</code>的任务已经在后台运行的情况。 这里的问题是，任务的活动实例以<code>singleInstance</code>启动，当以“标准”调用的<code>Activity</code>的 Affinity 与任务相同时，新任务的生成受到现有的<code>singleInstance</code> 活动的限制。但是，当每个活动的类名称相同时，不会生成任务，并使用现有活动实例。在任何情况下，被调用活动都将成为根活动。</p>
<p>如上所述，调用根<code>Activity</code>的条件很复杂，例如取决于执行状态。 因此，在开发应用时，最好设法以“标准”来调用活动。</p>
<p>这是一个示例，其中发送给私有活动的意图，可以从其他应用中读取。示例代码表明，私有活动的调用方活动以<code>singleInstance</code>模式启动。 在这个示例代码中，私有活动以“标准”模式启动，但由于调用方<code>Activity</code>的<code>singleInstance</code>条件，这个私有活动成为新任务的根<code>Activity</code>。 此时，发送给私有活动的敏感信息，在任务历史中记录，因此可以从其他应用读取。 仅供参考，调用方活动和私有活动都具有相同的 Affinity。</p>
<p>AndroidManifest.xml（不推荐）</p>
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="org.jssec.android.activity.singleinstanceactivity" &gt;
    
    &lt;application
        android:allowBackup="false"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" &gt;
        
        &lt;!-- Set the launchMode of the root Activity to "singleInstance". --&gt;
        &lt;!-- Do not use taskAffinity --&gt;
        &lt;activity
            android:name="org.jssec.android.activity.singleinstanceactivity.PrivateUserActivity"
            android:label="@string/app_name"
            android:launchMode="singleInstance"
            android:exported="true" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;
                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        
        &lt;!-- Private activity --&gt;
        &lt;!-- Set the launchMode to "standard." --&gt;
        &lt;!-- Do not use taskAffinity --&gt;
        &lt;activity
        android:name="org.jssec.android.activity.singleinstanceactivity.PrivateActivity"
        android:label="@string/app_name"
        android:exported="false" /&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>
<p>私有活动仅仅将结果返回个收到的意图。</p>
<p>PrivateActivity.java</p>
<pre><code class="language-java">package org.jssec.android.activity.singleinstanceactivity;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class PrivateActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.private_activity);
        // Handle intent securely, even though the intent sent from the same application.
        // Omitted, since this is a sample. Please refer to "3.2 Handling Input Data Carefully and Securely."
        String param = getIntent().getStringExtra("PARAM");
        Toast.makeText(this, String.format("Received param: ¥"%s¥"", param), Toast.LENGTH_LONG).show();
    }
    
    public void onReturnResultClick(View view) {
        Intent intent = new Intent();
        intent.putExtra("RESULT", "Sensitive Info");
        setResult(RESULT_OK, intent);
        finish();
    }
}
</code></pre>
<p>在私有活动的调用方，私有活动以“标准”模式启动，意图不带有任何标志。</p>
<p>PrivateUserActivity.java</p>
<pre><code class="language-java">package org.jssec.android.activity.singleinstanceactivity;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class PrivateUserActivity extends Activity {

    private static final int REQUEST_CODE = 1;
    
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.user_activity);
    }
    
    public void onUseActivityClick(View view) {
        // Start the Private Activity with "standard" lanchMode.
        Intent intent = new Intent(this, PrivateActivity.class);
        intent.putExtra("PARAM", "Sensitive Info");
        startActivityForResult(intent, REQUEST_CODE);
    }
    
    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (resultCode != RESULT_OK) return;
        switch (requestCode) {
            case REQUEST_CODE:
                String result = data.getStringExtra("RESULT");
                // Handle received result data carefully and securely,
                // even though the data came from the Activity in the same application.
                // Omitted, since this is a sample. Please refer to "3.2 Handling Input Data Carefully and Securely."
                Toast.makeText(this, Str();
                break;
        }
    }
}
</code></pre>
<h4 id="4135-使用活动时的日志输出">4.1.3.5 使用活动时的日志输出</h4>
<p>当使用一个活动时，意图的内容通过<code>ActivityManager</code>输出到<code>LogCat</code>。 以下内容将被输出到<code>LogCat</code>，因此在这种情况下，敏感信息不应该包含在这里。</p>
<ul>
<li>目标包名称</li>
<li>目标类名称</li>
<li>由<code>Intent#setData()</code>设置的 URI</li>
</ul>
<p>例如，当应用发送邮件时，如果应用将邮件地址指定为 URI，则邮件地址不幸会输出到<code>LogCat</code>。 所以，最好通过设置<code>Extras</code>来发送。 如下所示发送邮件时，邮件地址会显示给<code>logCat</code>。</p>
<p>MainActivity.java</p>
<pre><code class="language-java">// URI is output to the LogCat.
Uri uri = Uri.parse("mailtoest@gmail.com");
Intent intent = new Intent(Intent.ACTION_SENDTO, uri);
startActivity(intent);
</code></pre>
<p>当使用<code>Extras</code>时，邮件地址不会再展示给<code>LogCat</code>了。</p>
<p>MainActivity.java</p>
<pre><code class="language-java">// Contents which was set to Extra, is not output to the LogCat.
Uri uri = Uri.parse("mailto:");
Intent intent = new Intent(Intent.ACTION_SENDTO, uri);
intent.putExtra(Intent.EXTRA_EMAIL, new String[] {"test@gmail.com"});
startActivity(intent);
</code></pre>
<p>但是，有些情况下，其他应用可以使用<code>ActivityManager#getRecentTasks()</code>读取意图的附加数据。 请参阅“4.1.2.2 不指定<code>taskAffinity</code>（必需）”，“4.1.2.3 不指定<code>launchMode</code>（必需）”和“4.1.2.4 不要为启动活动的<code>Intent</code>设置<code>FLAG_ACTIVITY_NEW_TASK</code>标志（必需）”。</p>
<h4 id="4136-防止preferenceactivity中的fragment注入">4.1.3.6 防止<code>PreferenceActivity</code>中的<code>Fragment</code>注入</h4>
<p>当从<code>PreferenceActivity</code>派生的类是公共活动时，可能会出现称为片段注入 [5] 的问题。 为了防止出现这个问题，有必要重写<code>PreferenceActivity</code>.IsValidFragment()<code>，并检查其参数的有效性，来确保</code>Activity<code>不会无意中处理任何</code>Fragment`。 （输入数据安全的更多信息，请参见第3.2节“小心和安全地处理输入数据”。）</p>
<blockquote>
<p>[5] <code>Fragement</code>注入的更多信息，请参考：<a href="https://securityintelligence.com/new-vulnerability-android-framework-fragment-injection/">https://securityintelligence.com/new-vulnerability-android-framework-fragment-injection/</a>。</p>
</blockquote>
<p>下面我们显示一个覆盖<code>IsValidFragment()</code>的示例。 请注意，如果源代码已被混淆，则类名称和参数值比较的结果可能会更改。 在这种情况下，有必要寻求替代对策。</p>
<p>覆盖的<code>isValidFragment()</code>方法的示例</p>
<pre><code class="language-java">protected boolean isValidFragment(String fragmentName) {
    // If the source code is obfuscated, we must pursue alternative strategies
    return PreferenceFragmentA.class.getName().equals(fragmentName)
        || PreferenceFragmentB.class.getName().equals(fragmentName)
        || PreferenceFragmentC.class.getName().equals(fragmentName)
        || PreferenceFragmentD.class.getName().equals(fragmentName);
}
</code></pre>
<p>请注意，如果应用的<code>targetSdkVersion</code>为 19 或更大，不覆盖<code>PreferenceActivity.isValidFragment()</code>将导致安全异常，并在插入<code>Fragment</code>时终止应用 [调用<code>isValidFragment()</code>时]，因此在这种情况下，覆盖 <code>PreferenceActivity.isValidFragment()</code>是强制性的。</p>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/32/index.html">
<img class="uk-book-cover" src="../../static/icons/48/android_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/32/index.html">浅入浅出 Android 安全</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/15.html">wizardforcel</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="android">android</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">9页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月3日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 59个">59</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/69/index.html">
<img class="uk-book-cover" src="../../static/icons/48/android_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/69/index.html">Android 资源大全中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/19.html">伯乐在线</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="android">android</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">1页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月6日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1046个">1046</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/41/index.html">
<img class="uk-book-cover" src="../../static/icons/48/android_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/41/index.html">Android官方培訓課程中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/22.html">jasonblog</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="android">android</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">294页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月29日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1个">1</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/42/index.html">
<img class="uk-book-cover" src="../../static/icons/48/docker_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/42/index.html">Docker-從入門到實踐</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/22.html">jasonblog</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="docker">docker</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">82页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年5月30日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1个">1</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/198/index.html">
<img class="uk-book-cover" src="../../static/icons/48/storm_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/198/index.html">大数据入门指南</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/113.html">heibaiying</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="storm">storm</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">98页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2021年10月24日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 个"></span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../book/59/index.html">
<img class="uk-book-cover" src="../../static/icons/48/tensorflow_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../book/59/index.html">TensorFlow 官方文档中文版</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../user/35.html">jikexueyuanwiki</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="tensorflow">tensorflow</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">33页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月5日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 8767个">8767</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../" title="返回首页"><img class="" src="../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../book/26/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../book/26/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../book/26/README.html" title="安卓应用安全指南 中文版" data-book-page-rel-url="README.html" data-book-page-id="1799">安卓应用安全指南 中文版</a>
</li>
<li>
<a class="pjax" href="../../book/26/1.html" title="一、简介" data-book-page-rel-url="1.html" data-book-page-id="1800">一、简介</a>
</li>
<li>
<a class="pjax" href="../../book/26/2.html" title="二、本书结构" data-book-page-rel-url="2.html" data-book-page-id="1801">二、本书结构</a>
</li>
<li>
<a class="pjax" href="../../book/26/3.html" title="三、安全设计和编程的基础知识" data-book-page-rel-url="3.html" data-book-page-id="1802">三、安全设计和编程的基础知识</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.html" title="四、以安全方式使用技术" data-book-page-rel-url="4.html" data-book-page-id="1803">四、以安全方式使用技术</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.1.html" title="4.1 创建或使用活动" data-book-page-rel-url="4.1.html" data-book-page-id="1804">4.1 创建或使用活动</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.1.1.html" title="4.1.1 示例代码" data-book-page-rel-url="4.1.1.html" data-book-page-id="1805">4.1.1 示例代码</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.1.1.1.html" title="4.1.1.1 创建/使用私有活动" data-book-page-rel-url="4.1.1.1.html" data-book-page-id="1806">4.1.1.1 创建/使用私有活动</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.1.1.2.html" title="4.1.1.2 创建/使用公共活动" data-book-page-rel-url="4.1.1.2.html" data-book-page-id="1807">4.1.1.2 创建/使用公共活动</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.1.1.3.html" title="4.1.1.3 创建/使用伙伴活动" data-book-page-rel-url="4.1.1.3.html" data-book-page-id="1808">4.1.1.3 创建/使用伙伴活动</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.1.1.4.html" title="4.1.1.4 创建/使用内部活动" data-book-page-rel-url="4.1.1.4.html" data-book-page-id="1809">4.1.1.4 创建/使用内部活动</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.1.2.html" title="4.1.2 规则书" data-book-page-rel-url="4.1.2.html" data-book-page-id="1810">4.1.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.1.3.html" title="4.1.3 高级话题" data-book-page-rel-url="4.1.3.html" data-book-page-id="1811">4.1.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.2.html" title="4.2 接收/发送广播" data-book-page-rel-url="4.2.html" data-book-page-id="1812">4.2 接收/发送广播</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.2.1.html" title="4.2.1 示例代码" data-book-page-rel-url="4.2.1.html" data-book-page-id="1813">4.2.1 示例代码</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.2.1.1.html" title="4.2.1.1 私有广播接收器" data-book-page-rel-url="4.2.1.1.html" data-book-page-id="1814">4.2.1.1 私有广播接收器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.2.1.2.html" title="4.2.1.2 公共广播接收器" data-book-page-rel-url="4.2.1.2.html" data-book-page-id="1815">4.2.1.2 公共广播接收器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.2.1.3.html" title="4.2.1.3 内部广播接收器" data-book-page-rel-url="4.2.1.3.html" data-book-page-id="1816">4.2.1.3 内部广播接收器</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.2.2.html" title="4.2.2 规则书" data-book-page-rel-url="4.2.2.html" data-book-page-id="1817">4.2.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.2.3.html" title="4.2.3 高级话题" data-book-page-rel-url="4.2.3.html" data-book-page-id="1818">4.2.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.html" title="4.3 创建/使用内容供应器" data-book-page-rel-url="4.3.html" data-book-page-id="1819">4.3 创建/使用内容供应器</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.3.1.html" title="4.3.1 示例代码" data-book-page-rel-url="4.3.1.html" data-book-page-id="1820">4.3.1 示例代码</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.3.1.1.html" title="4.3.1.1 创建/使用私有内容供应器" data-book-page-rel-url="4.3.1.1.html" data-book-page-id="1821">4.3.1.1 创建/使用私有内容供应器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.1.2.html" title="4.3.1.2 创建/使用公共内容供应器" data-book-page-rel-url="4.3.1.2.html" data-book-page-id="1822">4.3.1.2 创建/使用公共内容供应器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.1.3.html" title="4.3.1.3 创建/使用伙伴内容供应器" data-book-page-rel-url="4.3.1.3.html" data-book-page-id="1823">4.3.1.3 创建/使用伙伴内容供应器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.1.4.html" title="4.3.1.4 创建/使用内部内容供应器" data-book-page-rel-url="4.3.1.4.html" data-book-page-id="1824">4.3.1.4 创建/使用内部内容供应器</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.1.5.html" title="4.3.1.5 创建/使用临时内容供应器" data-book-page-rel-url="4.3.1.5.html" data-book-page-id="1825">4.3.1.5 创建/使用临时内容供应器</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.3.2.html" title="4.3.2 规则书" data-book-page-rel-url="4.3.2.html" data-book-page-id="1826">4.3.2 规则书</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.html" title="4.4 创建/使用服务" data-book-page-rel-url="4.4.html" data-book-page-id="1827">4.4 创建/使用服务</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.4.1.html" title="4.4.1 示例代码" data-book-page-rel-url="4.4.1.html" data-book-page-id="1828">4.4.1 示例代码</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.4.1.1.html" title="4.4.1.1 创建/使用私有服务" data-book-page-rel-url="4.4.1.1.html" data-book-page-id="1829">4.4.1.1 创建/使用私有服务</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.1.2.html" title="4.4.1.2 创建/使用公共服务" data-book-page-rel-url="4.4.1.2.html" data-book-page-id="1830">4.4.1.2 创建/使用公共服务</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.1.3.html" title="4.4.1.3 创建/使用伙伴服务" data-book-page-rel-url="4.4.1.3.html" data-book-page-id="1831">4.4.1.3 创建/使用伙伴服务</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.1.4.html" title="4.4.1.4 创建/使用内部服务" data-book-page-rel-url="4.4.1.4.html" data-book-page-id="1832">4.4.1.4 创建/使用内部服务</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.2.html" title="4.4.2 规则书" data-book-page-rel-url="4.4.2.html" data-book-page-id="1833">4.4.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.4.3.html" title="4.4.3 高级话题" data-book-page-rel-url="4.4.3.html" data-book-page-id="1834">4.4.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.5.html" title="4.5 使用 SQLite" data-book-page-rel-url="4.5.html" data-book-page-id="1835">4.5 使用 SQLite</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.5.1.html" title="4.5.1 示例代码" data-book-page-rel-url="4.5.1.html" data-book-page-id="1836">4.5.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.5.2.html" title="4.5.2 规则书" data-book-page-rel-url="4.5.2.html" data-book-page-id="1837">4.5.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.5.3.html" title="4.5.3 高级话题" data-book-page-rel-url="4.5.3.html" data-book-page-id="1838">4.5.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.html" title="4.6 处理文件" data-book-page-rel-url="4.6.html" data-book-page-id="1839">4.6 处理文件</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.6.1.html" title="4.6.1 示例代码" data-book-page-rel-url="4.6.1.html" data-book-page-id="1840">4.6.1 示例代码</a>
<ul>
<li>
<a class="pjax" href="../../book/26/4.6.1.1.html" title="4.6.1.1 使用私有文件" data-book-page-rel-url="4.6.1.1.html" data-book-page-id="1841">4.6.1.1 使用私有文件</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.1.2.html" title="4.6.1.2 使用公共只读文件" data-book-page-rel-url="4.6.1.2.html" data-book-page-id="1842">4.6.1.2 使用公共只读文件</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.1.3.html" title="4.6.1.3 创建公共读写文件" data-book-page-rel-url="4.6.1.3.html" data-book-page-id="1843">4.6.1.3 创建公共读写文件</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.1.4.html" title="4.6.1.4 使用外部存储器（公共读写）文件" data-book-page-rel-url="4.6.1.4.html" data-book-page-id="1844">4.6.1.4 使用外部存储器（公共读写）文件</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.2.html" title="4.6.2 规则书" data-book-page-rel-url="4.6.2.html" data-book-page-id="1845">4.6.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.6.3.html" title="4.6.3 高级话题" data-book-page-rel-url="4.6.3.html" data-book-page-id="1846">4.6.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/4.7.html" title="4.7 使用可浏览的意图" data-book-page-rel-url="4.7.html" data-book-page-id="1847">4.7 使用可浏览的意图</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.8.html" title="4.8 输出到 LogCat" data-book-page-rel-url="4.8.html" data-book-page-id="1848">4.8 输出到 LogCat</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.9.html" title="4.9 使用`WebView`" data-book-page-rel-url="4.9.html" data-book-page-id="1849">4.9 使用`WebView`</a>
</li>
<li>
<a class="pjax" href="../../book/26/4.10.html" title="4.10 使用通知" data-book-page-rel-url="4.10.html" data-book-page-id="1850">4.10 使用通知</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.html" title="五、如何使用安全功能" data-book-page-rel-url="5.html" data-book-page-id="1851">五、如何使用安全功能</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.1.html" title="5.1 创建密码输入界面" data-book-page-rel-url="5.1.html" data-book-page-id="1852">5.1 创建密码输入界面</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.2.html" title="5.2 权限和保护级别" data-book-page-rel-url="5.2.html" data-book-page-id="1853">5.2 权限和保护级别</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.2.1.html" title="5.2.1 示例代码" data-book-page-rel-url="5.2.1.html" data-book-page-id="1854">5.2.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.2.2.html" title="5.2.2 规则书" data-book-page-rel-url="5.2.2.html" data-book-page-id="1855">5.2.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.2.3.html" title="5.2.3 高级话题" data-book-page-rel-url="5.2.3.html" data-book-page-id="1856">5.2.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.3.html" title="5.3 将内部账户添加到账户管理器" data-book-page-rel-url="5.3.html" data-book-page-id="1857">5.3 将内部账户添加到账户管理器</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.3.1.html" title="5.3.1 示例代码" data-book-page-rel-url="5.3.1.html" data-book-page-id="1858">5.3.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.3.2.html" title="5.3.2 规则书" data-book-page-rel-url="5.3.2.html" data-book-page-id="1859">5.3.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.3.3.html" title="5.3.3 高级话题" data-book-page-rel-url="5.3.3.html" data-book-page-id="1860">5.3.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.4.html" title="5.4 通过 HTTPS 的通信" data-book-page-rel-url="5.4.html" data-book-page-id="1861">5.4 通过 HTTPS 的通信</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.4.1.html" title="5.4.1 示例代码" data-book-page-rel-url="5.4.1.html" data-book-page-id="1862">5.4.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.4.2.html" title="5.4.2 规则书" data-book-page-rel-url="5.4.2.html" data-book-page-id="1863">5.4.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.4.3.html" title="5.4.3 高级话题" data-book-page-rel-url="5.4.3.html" data-book-page-id="1864">5.4.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.5.html" title="5.5 处理隐私数据" data-book-page-rel-url="5.5.html" data-book-page-id="1865">5.5 处理隐私数据</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.5.1.html" title="5.5.1 示例代码" data-book-page-rel-url="5.5.1.html" data-book-page-id="1866">5.5.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.5.2.html" title="5.5.2 规则书" data-book-page-rel-url="5.5.2.html" data-book-page-id="1867">5.5.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.5.3.html" title="5.5.3 高级话题" data-book-page-rel-url="5.5.3.html" data-book-page-id="1868">5.5.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.6.html" title="5.6 密码学" data-book-page-rel-url="5.6.html" data-book-page-id="1869">5.6 密码学</a>
<ul>
<li>
<a class="pjax" href="../../book/26/5.6.1.html" title="5.6.1 示例代码" data-book-page-rel-url="5.6.1.html" data-book-page-id="1870">5.6.1 示例代码</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.6.2.html" title="5.6.2 规则书" data-book-page-rel-url="5.6.2.html" data-book-page-id="1871">5.6.2 规则书</a>
</li>
<li>
<a class="pjax" href="../../book/26/5.6.3.html" title="5.6.3 高级话题" data-book-page-rel-url="5.6.3.html" data-book-page-id="1872">5.6.3 高级话题</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/5.7.html" title="5.7 使用指纹认证功能" data-book-page-rel-url="5.7.html" data-book-page-id="1873">5.7 使用指纹认证功能</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="../../book/26/6.html" title="六、困难问题" data-book-page-rel-url="6.html" data-book-page-id="1874">六、困难问题</a>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =26;var bookPageId =1811;var bookPageRelUrl ='4.1.3.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>