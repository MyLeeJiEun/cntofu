
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<title>Flux Data Driven Topology Builder-Apache Storm 官方文档中文版</title>
<meta content='Flux Data Driven Topology Builder,Apache Storm 官方文档中文版' name='keywords'>
<meta content='Flux Data Driven Topology Builder,Apache Storm 官方文档中文版' name='description'>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="zh-CN" />
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"../../../../>
<meta name="applicable-device" content="pc,mobile">
<link rel="shortcut icon" href="../../../../favicon.ico" type="image/x-icon" />
<meta name="renderer" content="webkit">
<link rel="stylesheet" href="../../../../static/components/uikit-2.27.5/css/uikit.custom.css">
<link rel="stylesheet" href="../../../../static/components/social-share/social-share.min.css">
<link rel="stylesheet" href="../../../../static/components/highlight/styles/custom.css">
<link rel="stylesheet" href="../../../../static/components/css/base.css">
<link rel="stylesheet" href="../../../../static/components/css/reader.css">
<link rel="stylesheet" href="../../../../static/components/css/markdown.css">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5313208362165053" crossorigin="anonymous"></script>
</head>
<body>
<div class=" book-main-wrap uk-container uk-container-center uk-margin-top ">
<div class="uk-grid">
<div class="uk-width-1-1 reader-wrap ">
<div class=" bottom-nav uk-clearfix ">
<div class="uk-align-left ">
<a href="../../../../book/108/doc/zh/storm-sql-internal.html">
<i class="nav-icon-left uk-icon-small  uk-icon-caret-left"></i>
<span class="">Storm SQL 结构</span>
</a>
</div>
<div class="uk-align-right ">
<a href="../../../../book/108/doc/zh/Setting-up-a-Storm-cluster.html">
<span class="">安装一个 Storm ..</span>
<i class="nav-icon-right uk-icon-small  uk-icon-caret-right"></i>
</a>
</div>
</div>
<div class="uk-text-center">
<h2 class="book-page-title uk-container-center">
<a href="../../../../book/108/index.html">Apache Storm 官方文档中文版</a>
<a target="_blank" rel="nofollow" href="https://github.com/tzivanmoe/storm-doc-zh" class="uk-icon-button uk-icon-github" title="github项目地址"></a>
</h2>
</div>
<script type="text/javascript" src="../../../../static/components/js/app_intro.js"></script>
<ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-5313208362165053" data-ad-slot="1328047120"></ins>
<script>(adsbygoogle =window.adsbygoogle ||[]).push({});</script>
<hr class="uk-article-divider">
<div class="book-content-section  md-content-section  uk-margin-bottom">
<hr>
<h2 id="title-fluxlayout-documentationdocumentation-true">title: Flux layout: documentation documentation: true</h2>
<p>一个框架，为了让创建和部署Apache Storm“流”计算遇上更方便快捷</p>
<h2 id="定义">定义</h2>
<p><strong>flux</strong> |fləks| <em>名词</em></p>
<ol>
<li>流动或者流出的这个动作过程 这个动作或者流出的过程</li>
<li>持续不断的改变</li>
<li>在物理中，表明液体、辐射能或者颗粒在指定区域内的流速</li>
<li>一个混合了固体用来降低其熔点的物质</li>
</ol>
<h2 id="基本原理">基本原理</h2>
<p>当配置很难被编程的时候会发生糟糕的事情。没有人应因为需要修改配置而重新编译或者重新打包一个应用。</p>
<h2 id="相关">相关</h2>
<p>Flux是一个用来让规定和部署Apache Storm拓扑不那么费劲的框架和一系列工具。</p>
<p>你是否发现你总是重复这样的模式？:</p>
<pre><code class="language-java">
public static void main(String[] args) throws Exception {
    // 返回的逻辑值用来判断我们是否在本地上运行
    // 创建必要的配置选项...
    boolean runLocal = shouldRunLocal();
    if(runLocal){
        LocalCluster cluster = new LocalCluster();
        cluster.submitTopology(name, conf, topology);
    } else {
        StormSubmitter.submitTopology(name, conf, topology);
    }
}
</code></pre>
<p>像这样的操作会不会更容易一些呢:</p>
<pre><code class="language-bash">storm jar mytopology.jar org.apache.storm.flux.Flux --local config.yaml
</code></pre>
<p>或者:</p>
<pre><code class="language-bash">storm jar mytopology.jar org.apache.storm.flux.Flux --remote config.yaml
</code></pre>
<p>另一个比较经常提及的麻烦点在于由于写拓扑图常常是和Java代码紧密结合的，所以任何对它的修改都需要重新编译和重新打包拓扑的jar文件。Flux的目标是允许你将你所有的Storm组件打包在一个单独的jar文件中，然后使用另一个文本文件来规定你的拓扑的布局和配置。通过这样的方式，缓解这一个麻烦。</p>
<h2 id="特点">特点</h2>
<ul>
<li>安装和部署Storm拓扑（包括Storm core和Microbatch API）简单，而不是用内嵌的配置方法在你的拓扑代码中安装和部署。</li>
<li>支持已有的拓扑代码（如下可见）</li>
<li>通过使用灵活的YAML DSL定义Storm Core API（Spouts/Bolts）。</li>
<li>YAML DSL支持大多数的Storm组件 (storm-kafka, storm-hdfs, storm-hbase, 等等.)</li>
<li>对多语言的组件有便捷的支持</li>
<li>为了更简便地在配置/环境间转换，使用了外部属性的置换/过滤（类似于Maven风格的<code>${variable.name}</code>置换）。</li>
</ul>
<h2 id="用法">用法</h2>
<p>为了使用Flux，把它添加到依赖包中，然后把你所有的Storm组件打包成一个很大的jar文件，再然后创建一个YAML文件来定义你的拓扑（下面有YAML配置选项）。</p>
<h3 id="通过源码来构建">通过源码来构建</h3>
<p>使用Flux最简单的方法就是将它作为Maven依赖包添加到项目中，如下面描述的那样。</p>
<p>如果你要从源代码中创建Flux并进行单元/集成的测试，你需要在你的系统上按照如下操作来安装：</p>
<ul>
<li>Python 2.6.x or later</li>
<li>Node.js 0.10.x or later</li>
</ul>
<h4 id="创建能够使用单元测试的命令">创建能够使用单元测试的命令：</h4>
<pre><code>mvn clean install
</code></pre>
<h4 id="创建不能够使用单元测试的命令">创建不能够使用单元测试的命令：</h4>
<p>如果你希望在不安装Python和Node.js的情况下构建Flux，你可以跳过这个单元测试：</p>
<pre><code>mvn clean install -DskipTests=true
</code></pre>
<p>需要注意，如果你打算使用Flux来给远程的簇部署拓扑，你仍然需要安装Python，因为Apche Storm要求这么做。</p>
<h4 id="创建能够使用集成测试的命令">创建能够使用集成测试的命令：</h4>
<pre><code>mvn clean install -DskipIntegration=false
</code></pre>
<h3 id="和maven一起打包">和Maven一起打包</h3>
<p>为了保证Flux能对你的Storm组件有效，你需要把Flux当做依赖包添加，这样才能让它包含在Storm的拓扑jar文件中。这个可以通过Maven shade插件（推荐）或者Maven assembly插件（不推荐）来完成。</p>
<h4 id="flux-maven依赖包">Flux Maven依赖包</h4>
<p>Flux现在的版本可以在以下的合作方的Maven中心获得：</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
    &lt;artifactId&gt;flux-core&lt;/artifactId&gt;
    &lt;version&gt;${storm.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>使用shell的spouts和bolt要求附加的Flux Wrappers库：</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
    &lt;artifactId&gt;flux-wrappers&lt;/artifactId&gt;
    &lt;version&gt;${storm.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h4 id="创建一个允许使用flux的拓扑jar文件">创建一个允许使用Flux的拓扑JAR文件</h4>
<p>下述的例子阐述了如何配合Maven shade插件使用Flux：</p>
<pre><code class="language-xml">&lt;!-- 在shaded jar文件中包含FLux和用户依赖包 --&gt;
&lt;dependencies&gt;
   &lt;!-- Flux include --&gt;
   &lt;dependency&gt;
       &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
       &lt;artifactId&gt;flux-core&lt;/artifactId&gt;
       &lt;version&gt;${storm.version}&lt;/version&gt;
   &lt;/dependency&gt;
   &lt;!-- Flux Wrappers include --&gt;
   &lt;dependency&gt;
       &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
       &lt;artifactId&gt;flux-wrappers&lt;/artifactId&gt;
       &lt;version&gt;${storm.version}&lt;/version&gt;
   &lt;/dependency&gt;

   &lt;!-- 在这里添加用户依赖包... --&gt;

&lt;/dependencies&gt;
&lt;!-- 创建一个包括所有依赖包的大大的jar文件 --&gt;
&lt;build&gt;
   &lt;plugins&gt;
       &lt;plugin&gt;
           &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
           &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
           &lt;version&gt;1.4&lt;/version&gt;
           &lt;configuration&gt;
               &lt;createDependencyReducedPom&gt;true&lt;/createDependencyReducedPom&gt;
           &lt;/configuration&gt;
           &lt;executions&gt;
               &lt;execution&gt;
                   &lt;phase&gt;package&lt;/phase&gt;
                   &lt;goals&gt;
                       &lt;goal&gt;shade&lt;/goal&gt;
                   &lt;/goals&gt;
                   &lt;configuration&gt;
                       &lt;transformers&gt;
                           &lt;transformer
                                   implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer"../../../../&gt;
                           &lt;transformer
                                   implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                               &lt;mainClass&gt;org.apache.storm.flux.Flux&lt;/mainClass&gt;
                           &lt;/transformer&gt;
                       &lt;/transformers&gt;
                   &lt;/configuration&gt;
               &lt;/execution&gt;
           &lt;/executions&gt;
       &lt;/plugin&gt;
   &lt;/plugins&gt;
&lt;/build&gt;
</code></pre>
<h3 id="部署和运行flux拓扑">部署和运行Flux拓扑</h3>
<p>一旦你的拓扑组件和Flux的依赖包一起打包后，你就可以通过使用 <code>storm jar</code> 命令在本地或者远端运行不同的拓扑。比如说，如果你的大大的jar文件命名为 <code>myTopology-0.1.0-SNAPSHOT.jar</code> ，你可以使用以下的命令在本地运行它：</p>
<pre><code class="language-bash">storm jar myTopology-0.1.0-SNAPSHOT.jar org.apache.storm.flux.Flux --local my_config.yaml

</code></pre>
<h3 id="命令行的参数选项">命令行的参数选项</h3>
<pre><code>usage: storm jar &lt;my_topology_uber_jar.jar&gt; org.apache.storm.flux.Flux
             [options] &lt;topology-config.yaml&gt;
 -d,--dry-run                 不运行/部署这个拓扑，仅仅是构建、验证和打印这个拓扑的相关信息。
 -e,--env-filter              执行环境变量的替换。 以形式为 `${ENV-[NAME]}` 定义的替换关键字将会替换 `NAME` 对应的环境变量值。
 -f,--filter &lt;file&gt;           执行属性替换。使用一个指定的文件作为属性的源，然后形式为 {$[property name]} 的替换关键字将会替换在这个属性文件中的值。.
 -i,--inactive                部署但是不激活这个拓扑。
 -l,--local                   在local的模式下运行拓扑。
 -n,--no-splash               抑制版权页的输出。
 -q,--no-detail               抑制拓扑详情的输出。
 -r,--remote                  将拓扑部署到远端的簇。
 -R,--resource                使用提供的路径来作为classpath的源文件以代替文件。
 -s,--sleep &lt;ms&gt;              当在本地运行时，在killing一个拓扑和关闭本地簇之前需要sleep的时间（以ms为单位）
 -z,--zookeeper &lt;host:port&gt;   当以local模式运行时，使用ZooKeeper的特定&lt;host:port&gt;而不是同进程的的ZooKeeper。（要求在Storm的0.9.3或之后的版本）  
</code></pre>
<p><strong>注意：</strong> Flux为了避免在使用到 <code>storm</code> 命令时产生命令行开关冲突，所以允许任何其他的命令行开关来表达 <code>storm</code> 这一命令。</p>
<p>举例来说，你可以使用<code>storm</code>的命令开关<code>-c</code>来覆盖拓扑配置性能。下述举例的命令就可以运行Flux并且覆盖<code>nimbus.seeds</code>这一配置：</p>
<pre><code class="language-bash">storm jar myTopology-0.1.0-SNAPSHOT.jar org.apache.storm.flux.Flux --remote my_config.yaml -c 'nimbus.seeds=["localhost"]'
</code></pre>
<h3 id="输出例子">输出例子</h3>
<pre><code>███████╗██╗     ██╗   ██╗██╗  ██╗
██╔════╝██║     ██║   ██║╚██╗██╔╝
█████╗  ██║     ██║   ██║ ╚███╔╝
██╔══╝  ██║     ██║   ██║ ██╔██╗
██║     ███████╗╚██████╔╝██╔╝ ██╗
╚═╝     ╚══════╝ ╚═════╝ ╚═╝  ╚═╝
+-         Apache Storm        -+
+-  data FLow User eXperience  -+
Version: 0.3.0
Parsing file: /Users/hsimpson/Projects/donut_domination/storm/shell_test.yaml
---------- TOPOLOGY DETAILS ----------
Name: shell-topology
--------------- SPOUTS ---------------
sentence-spout[1](org.apache.storm.flux.wrappers.spouts.FluxShellSpout)
---------------- BOLTS ---------------
splitsentence[1](org.apache.storm.flux.wrappers.bolts.FluxShellBolt)
log[1](org.apache.storm.flux.wrappers.bolts.LogInfoBolt)
count[1](org.apache.storm.testing.TestWordCounter)
--------------- STREAMS ---------------
sentence-spout --SHUFFLE--&gt; splitsentence
splitsentence --FIELDS--&gt; count
count --SHUFFLE--&gt; log
--------------------------------------
Submitting topology: 'shell-topology' to remote cluster...
</code></pre>
<h2 id="yaml配置">YAML配置</h2>
<p>Flux拓扑在YAML文件中被顶迎来描述一个拓扑。一个Flux拓扑定义由以下几项组成：</p>
<ol>
<li>一个拓扑的名字</li>
<li>一个拓扑组件的列表（被命名为Java对象，用以可以在环境中可以调用）</li>
<li><strong>第三选项或者第四选项</strong> （一个DSL拓扑定义）:
<ul>
<li>一个spouts的列表，每一个项通过一个唯一的ID被识别</li>
<li>一个bolts的列表，每一个项通过一个唯一的ID被识别</li>
<li>一个“stream”对象的列表，用来表示spouts和bolts之间的流的元组。</li>
</ul> </li>
<li><strong>第三选项或者第四选项</strong> (一个可以创建 <code>org.apache.storm.generated.StormTopology</code> 实例的JVM类）：
<ul>
<li>一个 <code>topologySource</code> 定义。</li>
</ul> </li>
</ol>
<p>举个例子，这里有一个使用YAML DSL的简单wordcount拓扑：</p>
<pre><code class="language-yaml">name: "yaml-topology"
config:
  topology.workers: 1

# spout定义
spouts:
  - id: "spout-1"
    className: "org.apache.storm.testing.TestWordSpout"
    parallelism: 1

# bolt定义
bolts:
  - id: "bolt-1"
    className: "org.apache.storm.testing.TestWordCounter"
    parallelism: 1
  - id: "bolt-2"
    className: "org.apache.storm.flux.wrappers.bolts.LogInfoBolt"
    parallelism: 1

# stream定义
streams:
  - name: "spout-1 --&gt; bolt-1" #name暂时未用上（可以在logging,UI等中作为placeholder）
    from: "spout-1"
    to: "bolt-1"
    grouping:
      type: FIELDS
      args: ["word"]

  - name: "bolt-1 --&gt; bolt2"
    from: "bolt-1"
    to: "bolt-2"
    grouping:
      type: SHUFFLE


</code></pre>
<h2 id="属性替换过滤">属性替换/过滤</h2>
<p>对于开发者而言，想要简单地转换配置是常有的事，例如在开发环境和生产环境中转换部署。这可以通过使用分开的YAML配置文件来实现，但是这个方法会导致配置文件中多出一些多余的重复内容，尤其是在一些Storm拓扑没有改变但是配置设置例如主机名，端口和并行性参数改变了的情况。</p>
<p>对于这种情况，Flux提供了属性过滤（properties filtering）方法允许你个给一个 <code>.properties</code> 文件赋两个具体的值，并且让他们在 <code>.yaml</code> 文件被解析前被替代。</p>
<p>为了实现属性过滤功能，使用 <code>--filter</code> 命令行选项，并且具体制定一个 <code>.properties</code> 文件。举个例子，如果你像这样调用flux：</p>
<pre><code class="language-bash">storm jar myTopology-0.1.0-SNAPSHOT.jar org.apache.storm.flux.Flux --local my_config.yaml --filter dev.properties
</code></pre>
<p>并且 <code>dev.properties</code> 内容如下：</p>
<pre><code class="language-properties">kafka.zookeeper.hosts: localhost:2181
</code></pre>
<p>你在这之后就可以通过你 <code>.yaml</code> 文件中的属性关键字，使用 <code>${}</code> 语法来引用它：</p>
<pre><code class="language-yaml">  - id: "zkHosts"
    className: "org.apache.storm.kafka.ZkHosts"
    constructorArgs:
      - "${kafka.zookeeper.hosts}"
</code></pre>
<p>在这个例子中，Flux可以在YAML内容被解析前使用 <code>localhost:2181</code> 来替换 <code>${kafka.zookeeper.hosts}</code> 。</p>
<h3 id="环境变量替换过滤environment-variable-substitutionfiltering">环境变量替换/过滤Environment Variable Substitution/Filtering</h3>
<p>Flux同样也允许环境变量替换。举个例子，如果名为<code>ZK_HOSTS</code> 的环境变量名被定义了，你可以通过以下的语法在Flux的YAML文件中引用它：</p>
<pre><code>${ENV-ZK_HOSTS}
</code></pre>
<h2 id="组件">组件</h2>
<p>组件从本质来说是对象实例，用来在对spouts和bolts的配置选项中获取。如果你对Spring框架很熟悉，这里的组件大概就类比于Spring中的beans</p>
<p>每一个组件都是可被识别的，至少是可以通过一个唯一的标识符（字符串）和一个类名（字符串）。举个例子，以下的例子将会创建一个 <code>org.apache.storm.kafka.StringScheme</code> 类的实例作为关键字 <code>"stringScheme"</code> 的引用。这里我们假设这个类 <code>org.apache.storm.kafka.StringScheme</code> 有一个默认的构造函数。</p>
<pre><code class="language-yaml">components:
  - id: "stringScheme"
    className: "org.apache.storm.kafka.StringScheme"
</code></pre>
<h3 id="构造函数参数引用属性和配置方法">构造函数参数，引用，属性和配置方法</h3>
<p>####构造函数参数 为了给一个类的构造函数添加参数，我们添加 <code>contructorArgs</code> 这个元素给组件。 <code>contructorArgs</code> 是一个列表，其元素是对象。这个列表会被传递给类的构造函数们。以下的这个例子通过调用一个把单个字符串作为参数的构造函数来创建一个对象：</p>
<pre><code class="language-yaml">  - id: "zkHosts"
    className: "org.apache.storm.kafka.ZkHosts"
    constructorArgs:
      - "localhost:2181"
</code></pre>
<p>####引用 每一个组件实例都通过一个唯一的id可悲其他组件重复使用。为了引用一个已存在的组件，你需要在使用 <code>ref</code> 这个标签的时候指明这个组件的id。</p>
<p>在以下的例子中，一个名为的组件被创建，之后将被作为另一个组件的构造函数的参数被引用：</p>
<pre><code class="language-yaml">components:
  - id: "stringScheme"
    className: "org.apache.storm.kafka.StringScheme"

  - id: "stringMultiScheme"
    className: "org.apache.storm.spout.SchemeAsMultiScheme"
    constructorArgs:
      - ref: "stringScheme" # component with id "stringScheme" must be declared above.
</code></pre>
<p><strong>注意:</strong> 引用只能在对象被声明后使用。</p>
<p>####属性 除去允许在调用构造函数的时候传进不同的参数，Flux同样允许在配置组件的时候使用被声明为 <code>public</code> 的类似JavaBean的setter方法和域：</p>
<pre><code class="language-yaml">  - id: "spoutConfig"
    className: "org.apache.storm.kafka.SpoutConfig"
    constructorArgs:
      # brokerHosts
      - ref: "zkHosts"
      # topic
      - "myKafkaTopic"
      # zkRoot
      - "../../../../kafkaSpout"
      # id
      - "myId"
    properties:
      - name: "ignoreZkOffsets"
        value: true
      - name: "scheme"
        ref: "stringMultiScheme"
</code></pre>
<p>在上述的例子中，如果声明了 <code>properties</code> ，Flux将会在 <code>SpoutConfig</code> 中找一个名字为 <code>setIgnoreZkOffsets(boolean b)</code> 的函数并试图调用它。如果这样的一个setter函数没有找到，Flux就会找一个公有的叫 <code>ignoreZkOffsets</code> 的实例变量并且将它进行设置。</p>
<p>引用也可能被作为属性值来使用。</p>
<p>####配置方法 从概念上来说，配置方法可能类似于属性和构造函数的参数 —— 他们允许一个对象在创建后可以调用任意的方法。对于有一些类，它们没有暴露JavaBean的方法或者没有能够将整个对象都配置好的构造函数，配置方法对这种类就十分有用。一些常见的例子包括了哪些使用构造器模式来配置/整合的类。</p>
<p>接下来的YAML例子创建了一个bolt并且通过几个方法进行了配置：</p>
<pre><code class="language-yaml">bolts:
  - id: "bolt-1"
    className: "org.apache.storm.flux.test.TestBolt"
    parallelism: 1
    configMethods:
      - name: "withFoo"
        args:
          - "foo"
      - name: "withBar"
        args:
          - "bar"
      - name: "withFooBar"
        args:
          - "foo"
          - "bar"
</code></pre>
<p>对应方法的标识如下：</p>
<pre><code class="language-java">    public void withFoo(String foo);
    public void withBar(String bar);
    public void withFooBar(String foo, String bar);
</code></pre>
<p>传递给配置方法的参数和构造函数中的参数作用一样，并且也支持引用。</p>
<h3 id="在沟早期的参数引用属性和配制方法中使用java的-enums-in-contructor-arguments-references-properties-and-configuration-methods">在沟早期的参数，引用，属性和配制方法中使用Java的 <code>enum</code>s in Contructor Arguments, References, Properties and Configuration Methods</h3>
<p>你可以在Flux YAML文件中轻松通过引用 <code>enum</code> 的名字将其值作为参数。</p>
<p>比如， <a href="">Storm's HDFS 模块</a> 包含了以下 <code>enum</code> 的定义（为了简洁而简化过）：</p>
<pre><code class="language-java">public static enum Units {
    KB, MB, GB, TB
}
</code></pre>
<p><code>org.apache.storm.hdfs.bolt.rotation.FileSizeRotationPolicy</code> 这个类有如下的构造器：</p>
<pre><code class="language-java">public FileSizeRotationPolicy(float count, Units units)

</code></pre>
<p>以下的Flux <code>component</code> 定义可以被用来调用这个构造器：</p>
<pre><code class="language-yaml">  - id: "rotationPolicy"
    className: "org.apache.storm.hdfs.bolt.rotation.FileSizeRotationPolicy"
    constructorArgs:
      - 5.0
      - MB
</code></pre>
<p>上述的定义和下面的Java代码从功能上来说是一样的：</p>
<pre><code class="language-java">// rotate files when they reach 5MB
FileRotationPolicy rotationPolicy = new FileSizeRotationPolicy(5.0f, Units.MB);
</code></pre>
<h2 id="拓扑配置">拓扑配置</h2>
<p><code>config</code> 这个区段仅仅是Storm拓扑配置参数的一个图，将会作为 <code>org.apache.storm.Config</code> 类的实例传给 <code>org.apache.storm.StormSubmitter</code> ：</p>
<pre><code class="language-yaml">config:
  topology.workers: 4
  topology.max.spout.pending: 1000
  topology.message.timeout.secs: 30
</code></pre>
<h1 id="已经存在的拓扑">已经存在的拓扑</h1>
<p>如果你有已经存在的Storm拓扑，你仍然可以用Flux来部署/运行/测试它们。这个特点允许你按照已有的拓扑类来改变Flux构造参数，引用，属性和拓扑配置声明。</p>
<p>使用已有拓扑类最简单的方法就是通过下面的方法定义一个名为 <code>getTopology()</code> 的实例方法：</p>
<pre><code class="language-java">public StormTopology getTopology(Map&lt;String, Object&gt; config)
</code></pre>
<p>或者：</p>
<pre><code class="language-java">public StormTopology getTopology(Config config)
</code></pre>
<p>你接下来就可以使用YAML来部署你的拓扑：</p>
<pre><code class="language-yaml">name: "existing-topology"
topologySource:
  className: "org.apache.storm.flux.test.SimpleTopology"
</code></pre>
<p>如果你想用来作为拓扑源的类有一个不同的方法名（比如不叫），那么你可以把它重写：</p>
<pre><code class="language-yaml">name: "existing-topology"
topologySource:
  className: "org.apache.storm.flux.test.SimpleTopology"
  methodName: "getTopologyWithDifferentMethodName"
</code></pre>
<p><strong>注意：</strong> 这个指定的方法必须接受一个单一的类型是 <code>java.util.Map&lt;String, Object&gt;</code> 或者 <code>org.apache.storm.Config</code> 的类，然后返回一个 <code>org.apache.storm.generated.StormTopology</code> 对象。</p>
<h1 id="yaml-dsl">YAML DSL</h1>
<h2 id="spouts-和-bolts">Spouts 和 Bolts</h2>
<p>Spout和Bolts是在YAML配置中各自的区域中被配置。Spout和Bolt的定义是 <code>组件（component）</code> 定义的拓展。在组件的基础上添加了 <code>并行度（parallelism）</code>参数，用于当一个拓扑被部署的时候设置组件的并行度。</p>
<p>因为spout和bolt定义继承了 <code>组件（component）</code> ，所以它们也支持构造函数参数，引用，属性。Because spout and bolt definitions extendthey support constructor arguments, references, and properties as well.</p>
<p>Shell spout的例子：</p>
<pre><code class="language-yaml">spouts:
  - id: "sentence-spout"
    className: "org.apache.storm.flux.wrappers.spouts.FluxShellSpout"
    # shell spout constructor takes 2 arguments: String[], String[]
    constructorArgs:
      # command line
      - ["node", "randomsentence.js"]
      # output fields
      - ["word"]
    parallelism: 1
</code></pre>
<p>Kafka spout的例子：</p>
<pre><code class="language-yaml">components:
  - id: "stringScheme"
    className: "org.apache.storm.kafka.StringScheme"

  - id: "stringMultiScheme"
    className: "org.apache.storm.spout.SchemeAsMultiScheme"
    constructorArgs:
      - ref: "stringScheme"

  - id: "zkHosts"
    className: "org.apache.storm.kafka.ZkHosts"
    constructorArgs:
      - "localhost:2181"

# 可选的kafka配置
#  - id: "kafkaConfig"
#    className: "org.apache.storm.kafka.KafkaConfig"
#    constructorArgs:
#      # brokerHosts
#      - ref: "zkHosts"
#      # topic
#      - "myKafkaTopic"
#      # clientId (optional)
#      - "myKafkaClientId"

  - id: "spoutConfig"
    className: "org.apache.storm.kafka.SpoutConfig"
    constructorArgs:
      # brokerHosts
      - ref: "zkHosts"
      # topic
      - "myKafkaTopic"
      # zkRoot
      - "../../../../kafkaSpout"
      # id
      - "myId"
    properties:
      - name: "ignoreZkOffsets"
        value: true
      - name: "scheme"
        ref: "stringMultiScheme"

config:
  topology.workers: 1

# spout definitions
spouts:
  - id: "kafka-spout"
    className: "org.apache.storm.kafka.KafkaSpout"
    constructorArgs:
      - ref: "spoutConfig"

</code></pre>
<p>Bolt 例子：</p>
<pre><code class="language-yaml"># bolt definitions
bolts:
  - id: "splitsentence"
    className: "org.apache.storm.flux.wrappers.bolts.FluxShellBolt"
    constructorArgs:
      # command line
      - ["python", "splitsentence.py"]
      # output fields
      - ["word"]
    parallelism: 1
    # ...

  - id: "log"
    className: "org.apache.storm.flux.wrappers.bolts.LogInfoBolt"
    parallelism: 1
    # ...

  - id: "count"
    className: "org.apache.storm.testing.TestWordCounter"
    parallelism: 1
    # ...
</code></pre>
<h2 id="streams-and-stream-groupings">Streams and Stream Groupings</h2>
<p>Flux中的“流”被表示为一列在Spouts和Bolts之间的“连接”（如图的边，数据流等），在连接定义的同时有一个关联的“分组”定义。</p>
<p>一个“流”定义有如下的属性：</p>
<p><strong><code>name</code>:</strong> 一个“连接”的名字（可选的，当下不会马上使用）</p>
<p><strong><code>from</code>:</strong> 作为源头的Spout或者Bolt的 <code>id</code>（类似于出版商）</p>
<p><strong><code>to</code>:</strong> 作为目的地的Spout或者Bolt的 <code>id</code> （类似于订阅者）</p>
<p><strong><code>grouping</code>:</strong> 为了“流”而产生的“流分组”定义</p>
<p>一个“分组”定义有以下的属性：</p>
<p><strong><code>type</code>:</strong> 分组的类型。下列值中任选一个 <code>ALL</code>、<code>CUSTOM</code>、<code>DIRECT</code>、<code>SHUFFLE</code>、<code>LOCAL_OR_SHUFFLE</code>、<code>FIELDS</code>、<code>GLOBAL</code>、或者 <code>NONE</code>。</p>
<p><strong><code>streamId</code>:</strong> Storm “流”的ID（可选的，如果没有指定则会使用默认流）</p>
<p><strong><code>args</code>:</strong> 当 <code>type</code> 的值为 <code>FIELDS</code> 时，一系列域的名字。</p>
<p><strong><code>customClass</code></strong> 当 <code>type</code> 的值为 <code>CUSTOM</code> 时，自定义的“分组”类实例的定义</p>
<p>如下例的 <code>流（streams）</code> 的定义案例建立起了一个如下的线路拓扑：</p>
<pre><code>    kafka-spout --&gt; splitsentence --&gt; count --&gt; log
</code></pre>
<pre><code class="language-yaml"># 流（stream）定义
# “流”的定义定了在spouts和bolts之间的“连接”。
# 注意这样的“连接”可能是循环的
# 自定义的“流分组”也被支持

streams:
  - name: "kafka --&gt; split" # name isn't used (placeholder for logging, UI, etc.)
    from: "kafka-spout"
    to: "splitsentence"
    grouping:
      type: SHUFFLE

  - name: "split --&gt; count"
    from: "splitsentence"
    to: "count"
    grouping:
      type: FIELDS
      args: ["word"]

  - name: "count --&gt; log"
    from: "count"
    to: "log"
    grouping:
      type: SHUFFLE
</code></pre>
<h3 id="自定义流分组">自定义“流分组”</h3>
<p>自定义的流分组是通过设置分组的类型为 <code>CUSTOM</code> 并且定义一个 <code>customClass</code> 参数，该参数告诉Flux如何实例化一个自定义类。这个 <code>customClass</code> 定义继承自 <code>组件（component）</code>，所以它也支持构造函数参数，引用和属性。</p>
<p>如下的例子创建了一个”流“，并且使用了一个类型为 <code>org.apache.storm.testing.NGrouping</code> 的自定义“流分组”类。</p>
<pre><code class="language-yaml">  - name: "bolt-1 --&gt; bolt2"
    from: "bolt-1"
    to: "bolt-2"
    grouping:
      type: CUSTOM
      customClass:
        className: "org.apache.storm.testing.NGrouping"
        constructorArgs:
          - 1
</code></pre>
<h2 id="包含和重写">“包含”和“重写”</h2>
<p>FLux允许包含其他YAML文件的内容，并且把它们当做在一个文件中定义的一样。可以包含文件或者路径源文件。</p>
<p>“包含”是通过一系列的maps来指定的：</p>
<pre><code class="language-yaml">includes:
  - resource: false
    file: "src/test/resources/configs/shell_test.yaml"
    override: false
</code></pre>
<p>如果 <code>resource</code> 的值为 <code>true</code>，“包含”将会从 <code>file</code> 这个属性值中来加载路径源文件，否则它会被当做是普通的文件。</p>
<p><code>override</code> 属性控制着“包含”要如何影响定义在当前文件中的值。如果 <code>override</code> 的值是 <code>true</code>，那么file值将会替代现在的文件被解析。如果 <code>override</code> 的值是 <code>false</code>，那么当前文件正在解析的值会有优先权，并且解析器会拒绝将它们替换掉。</p>
<p><strong>注意：</strong> “包含”现今不是循环的，包含文件中的包含将会被忽视。</p>
<h2 id="基本的word-count例子">基本的Word Count例子</h2>
<p>这个例子使用了在JavaScript中实现的spout，Python中实现的bolt，和另一个在Java中实现的bolt。</p>
<p>拓扑 YAML 配置：</p>
<pre><code class="language-yaml">---
name: "shell-topology"
config:
  topology.workers: 1

# spout 定义
spouts:
  - id: "sentence-spout"
    className: "org.apache.storm.flux.wrappers.spouts.FluxShellSpout"
    # shell spout constructor takes 2 arguments: String[], String[]
    constructorArgs:
      # command line
      - ["node", "randomsentence.js"]
      # output fields
      - ["word"]
    parallelism: 1

# bolt 定义
bolts:
  - id: "splitsentence"
    className: "org.apache.storm.flux.wrappers.bolts.FluxShellBolt"
    constructorArgs:
      # command line
      - ["python", "splitsentence.py"]
      # output fields
      - ["word"]
    parallelism: 1

  - id: "log"
    className: "org.apache.storm.flux.wrappers.bolts.LogInfoBolt"
    parallelism: 1

  - id: "count"
    className: "org.apache.storm.testing.TestWordCounter"
    parallelism: 1

#stream 定义
# “流”定义定义了在spouts和bolts之间的连接
# 注意“连接”可能是循环的
# 自定义“流分组”也是被支持的

streams:
  - name: "spout --&gt; split" # name没有被使用（ 是logging，UI等中的占位符）
    from: "sentence-spout"
    to: "splitsentence"
    grouping:
      type: SHUFFLE

  - name: "split --&gt; count"
    from: "splitsentence"
    to: "count"
    grouping:
      type: FIELDS
      args: ["word"]

  - name: "count --&gt; log"
    from: "count"
    to: "log"
    grouping:
      type: SHUFFLE
</code></pre>
<h2 id="micro-batching-trident-api-支持">Micro-Batching (Trident) API 支持</h2>
<p>虽然目前Flux DSL只支持核心Storm API（the COre Storm API），但是对Storm的micro-batching API的支持正在计划中。</p>
<p>为了和Trident拓扑一起使用Flux，在你的YAML配置中定义一个拓扑的getter方法和引用：</p>
<pre><code class="language-yaml">name: "my-trident-topology"

config:
  topology.workers: 1

topologySource:
  className: "org.apache.storm.flux.test.TridentTopologySource"
  # FLux将会寻找 "getTopology"方法, 这个会用来重写之前那个
  methodName: "getTopologyWithDifferentMethodName"
</code></pre>
</div>
<hr class="uk-article-divider">
<div class="uk-block uk-block-muted uk-padding-top-remove uk-padding-bottom-remove uk-margin-large-top  book-recommend-wrap">
<div class="uk-margin-top uk-margin-bottom uk-margin-left uk-margin-right">
<div class="uk-margin uk-text-muted "><i class="uk-icon-outdent uk-icon-justify uk-margin-small-right"></i>书籍推荐</div>
<div class="books">
<ul class="uk-book-list">
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/198/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/storm_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/198/index.html">大数据入门指南</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/113.html">heibaiying</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="storm">storm</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">98页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2021年10月24日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 个"></span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/165/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/python_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/165/index.html">Python学习知识库</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/94.html">coco369</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">85页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 190个">190</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/125/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/html5_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/125/index.html">前端早读课</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/67.html">if2er</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="html5">html5</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">1页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年7月8日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 7个">7</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/191/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/linux_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/191/index.html">Linux秘传心法</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/107.html">trimstray</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="linux">linux</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">81页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 20277个">20277</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/187/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/code_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/187/index.html">软件开发的工程化</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/105.html">azl397985856</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="code">code</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2019年5月26日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 112个">112</span>
</div>
</div>
</div>
</li>
<hr>
<li>
<div class="uk-book-item">
<div class="uk-book-header uk-clearfix">
<a href="../../../../book/96/index.html">
<img class="uk-book-cover" src="../../../../static/icons/48/python_48.png" height="48px" alt="">
</a>
<h4 class="uk-book-title uk-margin-small-bottom"><a href="../../../../book/96/index.html">零基础学Python</a></h4>
<div class="uk-book-meta  uk-text-middle uk-float-left">
<a class="uk-margin-small-right  uk-text-middle user-name " href="../../../../user/59.html">qiwsir</a>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-badge uk-badge-notification  book-subject" title="python">python</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">80页</span>
<span class="uk-margin-small-right  uk-text-middle">•</span>
<span class="uk-margin-small-right  uk-text-middle">2018年6月29日</span>
</div>
<div class="uk-book-tip uk-float-right  uk-text-middle">
<span class="uk-badge uk-badge-notification" title="github star 1635个">1635</span>
</div>
</div>
</div>
</li>
<hr>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<nav class="tm-navbar uk-navbar uk-navbar-attached reader-nav">
<div class="uk-float-left uk-margin-small-top">
<a href="javascript:;" title="目录菜单" class="show-menu  uk-icon-hover  uk-icon-align-justify uk-margin-right"></a>
<div data-uk-dropdown="{mode:'click',pos:'bottom-left'}" class="font-setting-wrap">
<a class="uk-icon-hover uk-icon-font uk-margin-right" aria-label="字体设置" href="javascript:;"></a>
<div class="uk-dropdown dropdown-menu">
<div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-reduce">小字</button>
<button class="uk-button-link button size-2 font-enlarge">大字</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-2 font-1 ">宋体</button>
<button class="uk-button-link button size-2 font-2 ">黑体</button>
</div>
<hr>
<div class="buttons uk-clearfix">
<button class="uk-button-link button size-3 color-theme-sun "><i class="uk-icon-sun-o"></i>白天</button>
<button class="uk-button-link button size-3 color-theme-eye "><i class="uk-icon-eye"></i>护眼</button>
<button class="uk-button-link button size-3 color-theme-moon "><i class="uk-icon-moon-o"></i>夜晚</button></div>
</div>
</div>
<a class="logo uk-margin-right" href="../../../../" title="返回首页"><img class="" src="../../../../static/components/images/icon_32.png" /></a>
</div>
<div class="uk-navbar-flip  uk-hidden-small">
<div id="share-box"></div>
</div>
</nav>
<div id="menu-id" class="uk-offcanvas reader-offcanvas">
<div class="uk-offcanvas-bar">
<ul class="book-menu-bar uk-nav uk-nav-offcanvas" data-uk-nav>
<li>
<a href="../../../../book/108/index.html" data-book-page-rel-url="index.html" data-book-page-id="0" title="封面">封面</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/readme.html" data-book-page-rel-url="readme.html" data-book-page-id="0" title="简介">简介</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/README.html" title="Introduction" data-book-page-rel-url="README.html" data-book-page-id="7785">Introduction</a>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 基础" disabled data-book-page-rel-url="" data-book-page-id="7786">Storm 基础</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Javadoc.html" title="Javadoc" data-book-page-rel-url="doc/zh/Javadoc.html" data-book-page-id="7787">Javadoc</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Concepts.html" title="概念" data-book-page-rel-url="doc/zh/Concepts.html" data-book-page-id="7788">概念</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Storm-Scheduler.html" title="调度器" data-book-page-rel-url="doc/zh/Storm-Scheduler.html" data-book-page-id="7789">调度器</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Configuration.html" title="配置" data-book-page-rel-url="doc/zh/Configuration.html" data-book-page-id="7790">配置</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Guaranteeing-message-processing.html" title="保证消息处理" data-book-page-rel-url="doc/zh/Guaranteeing-message-processing.html" data-book-page-id="7791">保证消息处理</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Daemon-Fault-Tolerance.html" title="Daemon（守护进程）容错" data-book-page-rel-url="doc/zh/Daemon-Fault-Tolerance.html" data-book-page-id="7792">Daemon（守护进程）容错</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Command-line-client.html" title="命令行 client（客户端）" data-book-page-rel-url="doc/zh/Command-line-client.html" data-book-page-id="7793">命令行 client（客户端）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/STORM-UI-REST-API.html" title="REST API" data-book-page-rel-url="doc/zh/STORM-UI-REST-API.html" data-book-page-id="7794">REST API</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Understanding-the-parallelism-of-a-Storm-topology.html" title="理解 Storm topology 的 parallelism（并行度）" data-book-page-rel-url="doc/zh/Understanding-the-parallelism-of-a-Storm-topology.html" data-book-page-id="7795">理解 Storm topology 的 parallelism（并行度）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/FAQ.html" title="FAQ" data-book-page-rel-url="doc/zh/FAQ.html" data-book-page-id="7796">FAQ</a>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm Trident" disabled data-book-page-rel-url="" data-book-page-id="7797">Storm Trident</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Layers on Top of Storm" disabled data-book-page-rel-url="" data-book-page-id="7798">Layers on Top of Storm</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Trident-tutorial.html" title="Trident 教程" data-book-page-rel-url="doc/zh/Trident-tutorial.html" data-book-page-id="7799">Trident 教程</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Trident-API-Overview.html" title="Trident API 概述" data-book-page-rel-url="doc/zh/Trident-API-Overview.html" data-book-page-id="7800">Trident API 概述</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Trident-state.html" title="Trident State（状态）" data-book-page-rel-url="doc/zh/Trident-state.html" data-book-page-id="7801">Trident State（状态）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Trident-spouts.html" title="Trident spouts" data-book-page-rel-url="doc/zh/Trident-spouts.html" data-book-page-id="7802">Trident spouts</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Trident-RAS-API.html" title="Trident RAS API" data-book-page-rel-url="doc/zh/Trident-RAS-API.html" data-book-page-id="7803">Trident RAS API</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm SQL" disabled data-book-page-rel-url="" data-book-page-id="7804">Storm SQL</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-sql.html" title="Storm SQL 概述" data-book-page-rel-url="doc/zh/storm-sql.html" data-book-page-id="7805">Storm SQL 概述</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-sql-example.html" title="Storm SQL 示例" data-book-page-rel-url="doc/zh/storm-sql-example.html" data-book-page-id="7806">Storm SQL 示例</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-sql-reference.html" title="Storm SQL 文献" data-book-page-rel-url="doc/zh/storm-sql-reference.html" data-book-page-id="7807">Storm SQL 文献</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-sql-internal.html" title="Storm SQL 结构" data-book-page-rel-url="doc/zh/storm-sql-internal.html" data-book-page-id="7808">Storm SQL 结构</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Flux" disabled data-book-page-rel-url="" data-book-page-id="7809">Flux</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/flux.html" title="Flux Data Driven Topology Builder" data-book-page-rel-url="doc/zh/flux.html" data-book-page-id="7810">Flux Data Driven Topology Builder</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 安装和部署" disabled data-book-page-rel-url="" data-book-page-id="7811">Storm 安装和部署</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Setting-up-a-Storm-cluster.html" title="安装一个 Storm 集群" data-book-page-rel-url="doc/zh/Setting-up-a-Storm-cluster.html" data-book-page-id="7812">安装一个 Storm 集群</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Local-mode.html" title="Local mode（本地模式）" data-book-page-rel-url="doc/zh/Local-mode.html" data-book-page-id="7813">Local mode（本地模式）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Troubleshooting.html" title="问题排查" data-book-page-rel-url="doc/zh/Troubleshooting.html" data-book-page-id="7814">问题排查</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Running-topologies-on-a-production-cluster.html" title="在生产 cluster（集群）上运行 topologies（拓扑）" data-book-page-rel-url="doc/zh/Running-topologies-on-a-production-cluster.html" data-book-page-id="7815">在生产 cluster（集群）上运行 topologies（拓扑）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Maven.html" title="构建 Storm with Maven" data-book-page-rel-url="doc/zh/Maven.html" data-book-page-id="7816">构建 Storm with Maven</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/SECURITY.html" title="安装 Secure（安全的）Cluster（集群）" data-book-page-rel-url="doc/zh/SECURITY.html" data-book-page-id="7817">安装 Secure（安全的）Cluster（集群）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/cgroups_in_storm.html" title="CGroup 的实施" data-book-page-rel-url="doc/zh/cgroups_in_storm.html" data-book-page-id="7818">CGroup 的实施</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Pacemaker.html" title="Pacemaker 针对大集群减低在 zookeeper 上的负载" data-book-page-rel-url="doc/zh/Pacemaker.html" data-book-page-id="7819">Pacemaker 针对大集群减低在 zookeeper 上的负载</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Resource_Aware_Scheduler_overview.html" title="Resource Aware Scheduler（资源意识调度器）" data-book-page-rel-url="doc/zh/Resource_Aware_Scheduler_overview.html" data-book-page-id="7820">Resource Aware Scheduler（资源意识调度器）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-metrics-profiling-internal-actions.html" title="Daemon Metrics/Monitoring（守护进程的度量/监控）" data-book-page-rel-url="doc/zh/storm-metrics-profiling-internal-actions.html" data-book-page-id="7821">Daemon Metrics/Monitoring（守护进程的度量/监控）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/windows-users-guide.html" title="Windows 平台的用户指南" data-book-page-rel-url="doc/zh/windows-users-guide.html" data-book-page-id="7822">Windows 平台的用户指南</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 中级" disabled data-book-page-rel-url="" data-book-page-id="7823">Storm 中级</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Serialization.html" title="Serialization（序列化）" data-book-page-rel-url="doc/zh/Serialization.html" data-book-page-id="7824">Serialization（序列化）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Common-patterns.html" title="Common patterns（常见模式）" data-book-page-rel-url="doc/zh/Common-patterns.html" data-book-page-id="7825">Common patterns（常见模式）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Clojure-DSL.html" title="Clojure DSL" data-book-page-rel-url="doc/zh/Clojure-DSL.html" data-book-page-id="7826">Clojure DSL</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Using-non-JVM-languages-with-Storm.html" title="与 Storm 一起使用非 JVM 的语言" data-book-page-rel-url="doc/zh/Using-non-JVM-languages-with-Storm.html" data-book-page-id="7827">与 Storm 一起使用非 JVM 的语言</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Distributed-RPC.html" title="分布式的 RPC" data-book-page-rel-url="doc/zh/Distributed-RPC.html" data-book-page-id="7828">分布式的 RPC</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Transactional-topologies.html" title="Transactional topologies（事务性的拓扑）" data-book-page-rel-url="doc/zh/Transactional-topologies.html" data-book-page-id="7829">Transactional topologies（事务性的拓扑）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Hooks.html" title="Hooks（钩子）" data-book-page-rel-url="doc/zh/Hooks.html" data-book-page-id="7830">Hooks（钩子）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Metrics.html" title="Metrics（度量）" data-book-page-rel-url="doc/zh/Metrics.html" data-book-page-id="7831">Metrics（度量）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/State-checkpointing.html" title="State Checkpointing" data-book-page-rel-url="doc/zh/State-checkpointing.html" data-book-page-id="7832">State Checkpointing</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Windowing.html" title="Windowing（窗口操作）" data-book-page-rel-url="doc/zh/Windowing.html" data-book-page-id="7833">Windowing（窗口操作）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Joins.html" title="Joining Streams" data-book-page-rel-url="doc/zh/Joins.html" data-book-page-id="7834">Joining Streams</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/distcache-blobstore.html" title="Blobstore(Distcahce)" data-book-page-rel-url="doc/zh/distcache-blobstore.html" data-book-page-id="7835">Blobstore(Distcahce)</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 调试" disabled data-book-page-rel-url="" data-book-page-id="7836">Storm 调试</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/dynamic-log-level-settings.html" title="Dynamic Log Level Settings" data-book-page-rel-url="doc/zh/dynamic-log-level-settings.html" data-book-page-id="7837">Dynamic Log Level Settings</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Logs.html" title="Searching Worker Logs" data-book-page-rel-url="doc/zh/Logs.html" data-book-page-id="7838">Searching Worker Logs</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/dynamic-worker-profiling.html" title="Worker Profiling" data-book-page-rel-url="doc/zh/dynamic-worker-profiling.html" data-book-page-id="7839">Worker Profiling</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Eventlogging.html" title="Event Logging" data-book-page-rel-url="doc/zh/Eventlogging.html" data-book-page-id="7840">Event Logging</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 与外部系统, 以及其它库的集成" disabled data-book-page-rel-url="" data-book-page-id="7841">Storm 与外部系统, 以及其它库的集成</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-kafka.html" title="Apache Kafka 集成" data-book-page-rel-url="doc/zh/storm-kafka.html" data-book-page-id="7842">Apache Kafka 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-kafka-client.html" title="新的 Kafka Consumer（消费者）集成" data-book-page-rel-url="doc/zh/storm-kafka-client.html" data-book-page-id="7843">新的 Kafka Consumer（消费者）集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-hbase.html" title="Apache HBase 集成" data-book-page-rel-url="doc/zh/storm-hbase.html" data-book-page-id="7844">Apache HBase 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-hdfs.html" title="Apache HDFS 集成" data-book-page-rel-url="doc/zh/storm-hdfs.html" data-book-page-id="7845">Apache HDFS 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-hive.html" title="Apache Hive 集成" data-book-page-rel-url="doc/zh/storm-hive.html" data-book-page-id="7846">Apache Hive 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-solr.html" title="Apache Solr 集成" data-book-page-rel-url="doc/zh/storm-solr.html" data-book-page-id="7847">Apache Solr 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-cassandra.html" title="Apache Cassandra 集成" data-book-page-rel-url="doc/zh/storm-cassandra.html" data-book-page-id="7848">Apache Cassandra 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-jdbc.html" title="JDBC 集成" data-book-page-rel-url="doc/zh/storm-jdbc.html" data-book-page-id="7849">JDBC 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-jms.html" title="JMS 集成" data-book-page-rel-url="doc/zh/storm-jms.html" data-book-page-id="7850">JMS 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-redis.html" title="Redis 集成" data-book-page-rel-url="doc/zh/storm-redis.html" data-book-page-id="7851">Redis 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-eventhubs.html" title="Event Hubs 集成" data-book-page-rel-url="doc/zh/storm-eventhubs.html" data-book-page-id="7852">Event Hubs 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-elasticsearch.html" title="Elasticsearch 集成" data-book-page-rel-url="doc/zh/storm-elasticsearch.html" data-book-page-id="7853">Elasticsearch 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-mqtt.html" title="MQTT 集成" data-book-page-rel-url="doc/zh/storm-mqtt.html" data-book-page-id="7854">MQTT 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-mongodb.html" title="Mongodb 集成" data-book-page-rel-url="doc/zh/storm-mongodb.html" data-book-page-id="7855">Mongodb 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-opentsdb.html" title="OpenTSDB 集成" data-book-page-rel-url="doc/zh/storm-opentsdb.html" data-book-page-id="7856">OpenTSDB 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-kinesis.html" title="Kinesis 集成" data-book-page-rel-url="doc/zh/storm-kinesis.html" data-book-page-id="7857">Kinesis 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-druid.html" title="Druid 集成" data-book-page-rel-url="doc/zh/storm-druid.html" data-book-page-id="7858">Druid 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Kestrel-and-Storm.html" title="Kestrel 集成" data-book-page-rel-url="doc/zh/Kestrel-and-Storm.html" data-book-page-id="7859">Kestrel 集成</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Container, Resource Management System Integration" disabled data-book-page-rel-url="" data-book-page-id="7860">Container, Resource Management System Integration</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/storm-yarn.html" title="YARN 集成" data-book-page-rel-url="doc/zh/storm-yarn.html" data-book-page-id="7861">YARN 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/mesos-storm.html" title="Mesos 集成" data-book-page-rel-url="doc/zh/mesos-storm.html" data-book-page-id="7862">Mesos 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/docker-storm.html" title="Docker 集成" data-book-page-rel-url="doc/zh/docker-storm.html" data-book-page-id="7863">Docker 集成</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/kubernetes-storm.html" title="Kubernetes 集成" data-book-page-rel-url="doc/zh/kubernetes-storm.html" data-book-page-id="7864">Kubernetes 集成</a>
</li>
</ul>
</li>
<li>
<a class="pjax" href="javascript:;" class="uk-link-muted uk-text-muted" title="Storm 高级" disabled data-book-page-rel-url="" data-book-page-id="7865">Storm 高级</a>
<ul>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Defining-a-non-jvm-language-dsl-for-storm.html" title="为 Storm 定义非 JVM 语言的 DSL" data-book-page-rel-url="doc/zh/Defining-a-non-jvm-language-dsl-for-storm.html" data-book-page-id="7866">为 Storm 定义非 JVM 语言的 DSL</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Multilang-protocol.html" title="多语言协议（如何为其它语言提供支持）" data-book-page-rel-url="doc/zh/Multilang-protocol.html" data-book-page-id="7867">多语言协议（如何为其它语言提供支持）</a>
</li>
<li>
<a class="pjax" href="../../../../book/108/doc/zh/Implementation-docs.html" title="实现文档" data-book-page-rel-url="doc/zh/Implementation-docs.html" data-book-page-id="7868">实现文档</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script src="https://cdn.staticfile.net/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../../../static/components/uikit-2.27.5/js/uikit.reader.js"></script>
<script type="text/javascript" src="../../../../static/components/social-share/social-share.min.js"></script>
<script>(function(){var bp =document.createElement('script');var curProtocol =window.location.protocol.split(':')[0];if (curProtocol ==='https') {bp.src ='https://zz.bdstatic.com/linksubmit/push.js';}
else {bp.src ='http://push.zhanzhang.baidu.com/push.js';}
var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
<script src="https://cdn.staticfile.net/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.net/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.staticfile.net/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.staticfile.net/uikit/2.27.5/js/components/lightbox.min.js"></script>
<link rel="dns-prefetch" href="../../../..//cdn.mathjax.org" />
<script type="text/x-mathjax-config">
 function initMathJax() {
    var mathId = $("book-content-section")[0];
    MathJax.Hub.Config({
        tex2jax: {skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a']},
        showProcessingMessages: false,
        messageStyle: "none"
    });
    MathJax.Hub.Queue(["Typeset",MathJax.Hub,mathId]);
 };
initMathJax();
</script>
<script src='https://cdn.staticfile.net/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
<style>
	.MathJax_Display{display:inline!important;}
</style>
<script type="text/javascript" src="../../../../static/components/js/reader.js"></script>
<script type="text/javascript">var bookId =108;var bookPageId =7810;var bookPageRelUrl ='doc/zh/flux.html';</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38429407-1"></script>
<script>window.dataLayer =window.dataLayer ||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-38429407-1');</script>
<script>var _hmt =_hmt ||[];(function() {var hm =document.createElement("script");hm.src ="https://hm.baidu.com/hm.js?f28e71bd2b5dee3439448dca9f534107";var s =document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script>
</body>
</html>